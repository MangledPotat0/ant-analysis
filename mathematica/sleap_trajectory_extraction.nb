(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     76471,       1835]
NotebookOptionsPosition[     70972,       1741]
NotebookOutlinePosition[     71350,       1757]
CellTagsIndexPosition[     71307,       1754]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Directory setup", "Subsection",
 CellChangeTimes->{{3.8423660748800054`*^9, 
  3.842366076399544*^9}},ExpressionUUID->"46a17531-5b19-4860-9496-\
e39ec32aacc0"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<C:/Users/user/Desktop/Coding/ant/data/sleap\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.842694579046344*^9, 
  3.842694579586748*^9}},ExpressionUUID->"25ce2295-9b5f-4d54-8802-\
4cbc1ea62308"],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<testset.hdf5\>\"", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0ba2456c-30c4-4aae-9952-15dc3327f819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"src", "=", 
   RowBox[{
   "file", "\[LeftDoubleBracket]", "\"\</trajectory_0\>\"", 
    "\[RightDoubleBracket]"}]}], ";"}]], "Input",ExpressionUUID->"d729cc21-\
48c1-46a2-a5b0-c10f73cfbbf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imgsize", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"{", 
     RowBox[{"xmax", ",", "ymax"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"scalefactor", "=", 
  FractionBox["imgsize", "17.5"], 
  RowBox[{"(*", 
   RowBox[{"pixels", " ", "per", " ", "cm"}], "*)"}]}]}], "Input",ExpressionUU\
ID->"1e238cbe-e63c-464e-8c4b-a74e3d7ac8b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize", "Subsection",
 CellChangeTimes->{{3.842366082135882*^9, 
  3.842366083223463*^9}},ExpressionUUID->"7a207016-1ca6-4326-8b49-\
ee747017ce4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"src", "=", 
     RowBox[{"file", "\[LeftDoubleBracket]", 
      RowBox[{"n", "+", 
       RowBox[{
        RowBox[{"Length", "[", "file", "]"}], "/", "2"}]}], 
      "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"frames", "=", 
     RowBox[{"file", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"head", "=", 
     RowBox[{"src", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"thorax", "=", 
     RowBox[{"src", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"abdomen", "=", 
     RowBox[{"src", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"head", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"head", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", 
            RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "head", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"thorax", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"thorax", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", 
            RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "thorax", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"abdomen", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"abdomen", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "n"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", 
            RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "abdomen", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"avg", "=", 
     FractionBox[
      RowBox[{"head", "+", "thorax", "+", "abdomen"}], "3."]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"avg", "=", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"avg", ",", "frames"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"list", ",", 
      RowBox[{"avg", "\[Transpose]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "file", "]"}], " ", "is", " ", "always", " ", 
      "an", " ", "even", " ", "number"}], ",", " ", 
     RowBox[{
     "because", " ", "the", " ", "converter", " ", "creates", " ", "one", " ",
       "table", " ", "for", " ", "trajectory", " ", "and", " ", "one", " ", 
      "table", " ", "for", " ", "frame", " ", "numbers", " ", "for", " ", 
      "every", " ", "SLEAP", " ", "trajectory", " ", "in", " ", "the", " ", 
      "input", " ", 
      RowBox[{"file", "."}]}]}], "*)"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", "file", "]"}], "/", "2"}]}], "}"}]}], 
  "]"}]}], "Input",ExpressionUUID->"643413ed-515f-4fd1-b03c-7f1887f0cc41"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"list", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", ";;", ",", 
     RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",ExpressionUUID->\
"ca5e7bc8-ee0f-4528-bcb9-fae0a576133f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Jump counts/disconnect trajectories", "Section",ExpressionUUID->"dd4200ec-6dce-4877-9599-98286e8fc3c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"jump", ",", 
      RowBox[{"\[Theta]", "=", "15.1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pruned", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"jump", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sc", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j", ",", 
                  RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "-", "1"}], ",", 
                  RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], 
               "]"}], ">", "\[Theta]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"pruned", ",", 
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"jump", ";;", 
                   RowBox[{"j", "-", "1"}]}]}], "\[RightDoubleBracket]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"jump", "=", "j"}], ";", "\[IndentingNewLine]", 
              RowBox[{"sc", "+=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"ct", "+=", "1"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
             "list", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sc", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"pruned", ",", 
             RowBox[{
             "list", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ct", "+=", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUUID->"9ae078ee-\
425a-4d33-9bd4-18eef41ec0b3"],

Cell[BoxData[
 RowBox[{"tr", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"pruned", "\[LeftDoubleBracket]", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Full"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}]], "Input",ExpressionUUI\
D->"61017c8c-1cda-4bec-9018-6c178c5cf962"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute predicted position", "Section",ExpressionUUID->"dad20c7c-aa6c-402f-a9dc-31914b06dee4"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\[Omega]", ",", "speed", ",", "vec", ",", "dir", ",", "arg", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"refrange", "=", "5"}]}], 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "frames", " ", "to", " ", "refer", " ", "to", 
      " ", "for", " ", "finding", " ", "potential", " ", "next", " ", 
      "position"}], "*)"}], "\[IndentingNewLine]", "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prediction", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "pruned", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
           "]"}], ">", "refrange"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Sufficiently", " ", "long", " ", "trajectories"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Omega]", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"speed", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"vec", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"refrange", "+", "1", "-", "i"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"vec", "=", 
              RowBox[{
               RowBox[{"pruned", "\[LeftDoubleBracket]", 
                RowBox[{"n", ",", 
                 RowBox[{"-", "j"}]}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{"pruned", "\[LeftDoubleBracket]", 
                RowBox[{"n", ",", 
                 RowBox[{
                  RowBox[{"-", "j"}], "-", "1"}]}], 
                "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"speed", "+=", 
              RowBox[{"Abs", "[", "vec", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dir", "=", 
              FractionBox["vec", 
               RowBox[{
                RowBox[{"Abs", "[", "vec", "]"}], "+", "0.000000000001"}]]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"arg", "=", 
              FractionBox[
               RowBox[{
               "dir", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               RowBox[{
               "dir", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "dir", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"\[Omega]", "+=", 
                RowBox[{"ArcTan", "[", "arg", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\[Omega]", "+=", 
                 RowBox[{
                  RowBox[{"1.", "\[Pi]"}], "+", 
                  RowBox[{"ArcTan", "[", "arg", "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "refrange"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"speed", "=", 
           FractionBox["speed", "refrange"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", "=", 
           FractionBox["\[Omega]", "refrange"]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Too", " ", "short", " ", "to", " ", "establish", " ", "good", " ", 
           "prediction"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"speed", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"prediction", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pruned", "\[LeftDoubleBracket]", 
            RowBox[{"n", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"pruned", "\[LeftDoubleBracket]", 
             RowBox[{"n", ",", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "+", 
            RowBox[{"speed", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Omega]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Omega]", "]"}]}], "}"}]}]}]}], "}"}]}], 
        "]"}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "pruned", "]"}]}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"1daa90fc-f2a8-4156-\
ae17-fa780477ac2d"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
     "pruned", "\[LeftDoubleBracket]", ";;", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Full"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
     "prediction", "\[LeftDoubleBracket]", ";;", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}]}], "]"}]], "Input",Exp\
ressionUUID->"4eea3e14-0ba3-462d-bf6d-983fcec4f316"]
}, Closed]],

Cell[CellGroupData[{

Cell["Probability-based prediction visualized", "Section",ExpressionUUID->"7e063f8e-7a02-4260-8e7b-ea039b870b3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"position", "=", 
   RowBox[{"pruned", "\[LeftDoubleBracket]", 
    RowBox[{"37", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pposition", "=", 
   RowBox[{"pruned", "\[LeftDoubleBracket]", 
    RowBox[{"37", ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xval", "=", 
   RowBox[{
   "position", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
  RowBox[{"yval", "=", 
   RowBox[{
   "position", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1val", "=", 
   RowBox[{"pposition", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"y1val", "=", 
   RowBox[{"pposition", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initangle", "=", 
   RowBox[{"OriAnt", "[", 
    RowBox[{"position", ",", "pposition"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8423664520908327`*^9, 3.8423664530735846`*^9}, {
  3.8423666311193905`*^9, 
  3.842366701409075*^9}},ExpressionUUID->"77b2e93c-23de-434b-b36f-\
9352d3f89987"],

Cell[BoxData[
 RowBox[{"ArcCos2", "[", 
  RowBox[{
   RowBox[{"300", "-", "xval"}], ",", 
   RowBox[{"300", "-", "yval"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.842365276231176*^9, 
  3.8423653131819973`*^9}},ExpressionUUID->"2c882d4b-33ad-4f6b-bfab-\
e97640f173b3"],

Cell[CellGroupData[{

Cell["Single step", "Subsection",ExpressionUUID->"f4cfefdf-6e7e-4629-a591-dae21429f7e8"],

Cell[CellGroupData[{

Cell["Angle-only probability view", "Subsubsection",ExpressionUUID->"cf2dd87e-6d88-4c0a-822b-5fcff3d74ccc"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{"avdist", ",", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ArcCos2", "[", 
          RowBox[{
           RowBox[{"x", "-", "xval"}], ",", 
           RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
         "\[Pi]"}], ",", 
        RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", 
   RowBox[{"MaxRecursion", "\[Rule]", "5"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of next step angle for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"2c50db9d-1a7c-4e31-952c-0378bf3f4170"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{"avdist", ",", "\[Theta]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",ExpressionUUID->\
"f43755d5-1505-4c63-98bb-855731c25f75"]
}, Closed]],

Cell[CellGroupData[{

Cell["Stepsize-only probability view", "Subsubsection",ExpressionUUID->"f34402f9-4172-4da4-8108-b78b2289e719"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{"speeddist", ",", 
     FractionBox[
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], "scalefactor"]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of distance to next step for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"936b29b6-0597-4d76-af83-0c32f59f6a20"]
}, Closed]],

Cell[CellGroupData[{

Cell["Combined probability view", "Subsubsection",ExpressionUUID->"e02f78f6-888c-4f8b-bcb1-3be74d9ea194"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{"speeddist", ",", 
      FractionBox[
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], "scalefactor"]}],
      "]"}], 
    RowBox[{"PDF", "[", 
     RowBox[{"avdist", ",", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcCos2", "[", 
           RowBox[{
            RowBox[{"x", "-", "xval"}], ",", 
            RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
          "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of distance to next step for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"e8e69c2f-4d51-4d07-98aa-2e9326576d9b"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{"speeddist", ",", 
      FractionBox[
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], "scalefactor"]}],
      "]"}], 
    RowBox[{"PDF", "[", 
     RowBox[{"avdist", ",", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcCos2", "[", 
           RowBox[{
            RowBox[{"x", "-", "xval"}], ",", 
            RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
          "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"xval", "-", "100"}], ",", 
     RowBox[{"xval", "+", "100"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"yval", "-", "100"}], ",", 
     RowBox[{"yval", "+", "100"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
   RowBox[{"MaxRecursion", "\[Rule]", "15"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of distance to next step for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"b38025c1-228d-4793-8b47-1240a1e57bcb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-steps", "Subsection",ExpressionUUID->"9a338930-21e7-4c72-9a81-d5f4b1559234"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"probrepeat", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dp", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"PDF", "[", 
       RowBox[{"speeddist", ",", 
        FractionBox[
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], 
         RowBox[{"10", "probrepeat", " "}]]}], "]"}], "probrepeat"], 
     SuperscriptBox[
      RowBox[{"PDF", "[", 
       RowBox[{"avdist", ",", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ArcCos2", "[", 
               RowBox[{
                RowBox[{"x", "-", "xval"}], ",", 
                RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
              "\[Pi]"}], ",", 
             RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], ")"}], 
         "probrepeat"]}], "]"}], "probrepeat"]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "300"}], ",", 
    RowBox[{"MaxRecursion", "\[Rule]", "15"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{
    "PlotLabel", "\[Rule]", 
     "\"\<Probability of distance to next step for sample position\>\""}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.842366499058439*^9, 
  3.8423664991626496`*^9}},ExpressionUUID->"5d861475-4c5f-45c0-ad94-\
43bf1acf8ad0"],

Cell[CellGroupData[{

Cell["Overlay", "Subsubsection",ExpressionUUID->"4298bb1a-8a08-4c8d-bb91-07bc5c9c39f6"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"dp", ",", "part1", ",", "part2"}], "]"}]], "Input",
 CellChangeTimes->{{3.8423665453766737`*^9, 3.8423665459042635`*^9}, {
  3.8423667777087145`*^9, 
  3.842366780164673*^9}},ExpressionUUID->"efad8eef-9572-44fc-9e94-\
e6a2986a1180"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Probability-based prediction compute", "Section",ExpressionUUID->"a1bb2d26-eaac-4961-b307-7d6f857dcf0c"],

Cell[CellGroupData[{

Cell["Helper function", "Subsection",ExpressionUUID->"d2ca4549-765b-46dd-bd72-f64b1f72cdc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcCos2", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ans", ",", "temp", ",", "norm"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"norm", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "<", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ans", "=", 
        RowBox[{"ArcCos", "[", 
         FractionBox["x", "norm"], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ans", "=", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           FractionBox["x", "norm"], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ans", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.842346866849598*^9, 3.842346876097384*^9}, {
  3.84236518396154*^9, 3.8423651875829053`*^9}, {3.8423652309033084`*^9, 
  3.8423652347182007`*^9}, {3.8423653283010783`*^9, 3.8423654268685365`*^9}, {
  3.8423665558254576`*^9, 3.8423665566730022`*^9}, {3.8423666212731056`*^9, 
  3.8423666220649323`*^9}},ExpressionUUID->"e3c6ac16-425d-4a57-a8d6-\
65a6383f4a04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OriAnt", "[", 
   RowBox[{"ultim_", ",", "penultim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "y1", ",", "x2", ",", "y2", ",", "dx", ",", "dy", ",", "norm",
       ",", "angle"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x1", "=", 
      RowBox[{
      "penultim", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"x2", "=", 
      RowBox[{
      "ultim", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{
      "penultim", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{
      "ultim", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dx", "=", 
      RowBox[{"x2", "-", "x1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dy", "=", 
      RowBox[{"y2", "-", "y1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"norm", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["dx", "2"], "+", 
         SuperscriptBox["dy", "2"]}], "]"}], "+", "0.0001"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcCos2", "[", 
       RowBox[{
        FractionBox["dx", "norm"], ",", 
        FractionBox["dy", "norm"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "angle", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8423471139494376`*^9, 3.8423471486279364`*^9}, {
   3.8423472273970437`*^9, 3.842347281285342*^9}, 
   3.842348259137493*^9},ExpressionUUID->"579f54c2-c2f2-40ca-a66a-\
4e4c393d2d2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hungarian", "[", 
   RowBox[{
   "sources_", ",", "targets_", ",", "frags_", ",", "probs_", ",", 
    "targetlist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sourcepositions", ",", "targetpositions", ",", "size", ",", 
      "costmatrix", ",", "invprob", ",", "boolmat", ",", "zerocount", ",", 
      "zeros", ",", "minrow", ",", "markedzeros", ",", "markedrows", ",", 
      "markedcolumns", ",", "unmarkedrows", ",", "unmarkedzeros", ",", 
      "markedtotal", ",", 
      RowBox[{"solved", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sourcepositions", "=", 
      RowBox[{"frags", "\[LeftDoubleBracket]", 
       RowBox[{"sources", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"targetpositions", "=", 
      RowBox[{"frags", "\[LeftDoubleBracket]", 
       RowBox[{"targets", ",", "1", ",", 
        RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"size", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sources", "]"}], ",", 
         RowBox[{"Length", "[", "targets", "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"We", " ", "want", " ", "to", " ", "maximize", " ", "prob"}], 
       ",", " ", 
       RowBox[{
       "so", " ", "we", " ", "find", " ", "a", " ", "quantity", " ", "that", 
        " ", "can", " ", "be", " ", "minimized", " ", "instead"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"invprob", "=", 
      RowBox[{
       RowBox[{"Max", "[", "probs", "]"}], "-", "probs"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "It", " ", "is", " ", "necessary", " ", "to", " ", "define", " ", 
       "costmatrix", " ", "as", " ", "square", " ", "matrix", " ", "first", 
       " ", "because", " ", "we", " ", "need", " ", "a", " ", "bijective", 
       " ", "mapping", " ", "for", " ", "linear", " ", "sum", " ", 
       "assignment", " ", "algorithms", " ", "to", " ", "work"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"costmatrix", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"size", ",", "size"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"costmatrix", "=", 
        RowBox[{
         RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{"invprob", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
           "sources", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "targets", "\[LeftDoubleBracket]", "j", 
            "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "sources", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "targets", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Subtract", " ", "minima", " ", "from", " ", "each", " ", "row"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "costmatrix", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{
         RowBox[{
         "costmatrix", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
          "-", 
         RowBox[{"Min", "[", 
          RowBox[{
          "costmatrix", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Subtract", " ", "minima", " ", "from", " ", "each", " ", "column"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{
         RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
          RowBox[{";;", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"Min", "[", 
          RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", "solved"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "an", " ", "N", " ", "by", " ", "N", " ", "boolean", " ",
          "matrix", " ", "where", " ", "the", " ", "zeros", " ", "are", " ", 
         "marked", " ", "with", " ", "True", " ", "and", " ", "others", " ", 
         "by", " ", "False"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"boolmat", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"False", ",", 
           RowBox[{"{", 
            RowBox[{"size", ",", "size"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "\[Equal]", 
             "0"}], ",", 
            RowBox[{
             RowBox[{"boolmat", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
             "True"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"markedrows", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Pick", " ", "the", " ", "row", " ", "with", " ", "fewest", " ", 
           "nonzero", " ", "Trues"}], ",", " ", 
          RowBox[{
          "mark", " ", "the", " ", "first", " ", "one", " ", "and", " ", 
           "eliminate", " ", "marked", " ", "zero"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "boolmat"}], ",", "True"}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"zerocount", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{
                "boolmat", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", "True"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"minrow", "=", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Range", "[", "size", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "zerocount", "\[LeftDoubleBracket]", "#", 
                  "\[RightDoubleBracket]"}], "\[NotEqual]", "0"}], "&"}]}], 
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"zeros", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Range", "[", "size", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
                 RowBox[{"minrow", ",", "#"}], "\[RightDoubleBracket]"}], 
                "\[Equal]", "0"}], "&"}], ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"boolmat", "\[LeftDoubleBracket]", 
               RowBox[{"minrow", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
              "False"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "zeros", "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"iwanttoeatchicken", "=", "True"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Remove", " ", "the", " ", "zeroes", " ", "selected", " ", "in", 
             " ", "the", " ", "previous", " ", "step"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"boolmat", "\[LeftDoubleBracket]", 
             RowBox[{"minrow", ",", ";;"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"False", ",", 
              RowBox[{"{", "size", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"boolmat", "\[LeftDoubleBracket]", 
                RowBox[{";;", ",", 
                 RowBox[{
                 "zeros", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{"Array", "[", 
                RowBox[{"False", ",", 
                 RowBox[{"{", "size", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"markedzeros", "=", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"markedrows", ",", 
                 RowBox[{"{", 
                  RowBox[{"minrow", ",", 
                   RowBox[{
                   "zeros", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}]}], "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"markedrows", "=", 
         RowBox[{"markedzeros", "\[LeftDoubleBracket]", 
          RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"unmarkedrows", "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Range", "[", "size", "]"}], ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"markedrows", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"markedcolumns", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Range", "[", "size", "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"costmatrix", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "#"}], "\[RightDoubleBracket]"}], "&"}], 
              "\[Equal]", "0"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "unmarkedrows", "]"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Check", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
          "marked", " ", "rows", " ", "and", " ", "columns"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"markedtotal", "=", 
         RowBox[{
          RowBox[{"Length", "[", "markedrows", "]"}], "+", 
          RowBox[{"Length", "[", "markedcolumns", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"markedtotal", "\[Equal]", "size"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "If", " ", "it", " ", "matches", " ", "the", " ", "size", " ", 
             "of", " ", "the", " ", "matrix"}], ",", " ", 
            RowBox[{"proceed", " ", "with", " ", "assignment"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"output", "=", "markedzeros"}], ";", "\[IndentingNewLine]", 
           RowBox[{"solved", "=", "True"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "If", " ", "it", " ", "does", " ", "not", " ", "match", " ", 
             "the", " ", "size", " ", "of", " ", "matrix"}], ",", " ", 
            RowBox[{
            "modify", " ", "matrix", " ", "until", " ", "it", " ", "does"}]}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"costmatrix", "=", 
            RowBox[{"AdjustMatrix", "[", 
             RowBox[{
             "costmatrix", ",", "markedrows", ",", "markedcolumns", ",", 
              "size"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "output", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8423799767491903`*^9, 3.8423799879208946`*^9}, {
   3.842380052081381*^9, 3.842380069120224*^9}, {3.8423801641980886`*^9, 
   3.8423802447425227`*^9}, {3.8423802779243965`*^9, 
   3.8423802828928094`*^9}, {3.8424396388495693`*^9, 
   3.8424398644536033`*^9}, {3.8424402089169292`*^9, 
   3.8424402834491873`*^9}, {3.8424403511445513`*^9, 3.842440369616119*^9}, {
   3.842440410078659*^9, 3.8424406512767487`*^9}, {3.8424473523061676`*^9, 
   3.842447352385768*^9}, {3.842447408248661*^9, 3.8424474297286177`*^9}, {
   3.8424476159989557`*^9, 3.8424476193335943`*^9}, {3.842448140543302*^9, 
   3.842448483507962*^9}, {3.8424486863206186`*^9, 3.842448735640299*^9}, {
   3.8424487671404037`*^9, 3.842448769856806*^9}, {3.842454589432428*^9, 
   3.84245462698254*^9}, {3.84245523267966*^9, 3.842455405222046*^9}, {
   3.842455892008404*^9, 3.8424559969022646`*^9}, {3.8424561109323845`*^9, 
   3.842456193780012*^9}, {3.84245623710714*^9, 3.8424562766195116`*^9}, {
   3.8424563262427707`*^9, 3.842456341521786*^9}, {3.8424564152816935`*^9, 
   3.8424564184018106`*^9}, {3.8424564829762945`*^9, 3.842456490177888*^9}, {
   3.8424626708672805`*^9, 3.8424626774687243`*^9}, {3.8424627351378965`*^9, 
   3.842462778371677*^9}, {3.842462994860051*^9, 3.8424629967402954`*^9}, {
   3.8424635277302074`*^9, 3.8424635979904575`*^9}, {3.842463673985657*^9, 
   3.8424636743942723`*^9}, {3.8424638135121565`*^9, 3.842463826914259*^9}, {
   3.842463863992174*^9, 3.842463929906114*^9}, {3.842464067471225*^9, 
   3.84246407906524*^9}, {3.8424641709277573`*^9, 3.842464173064046*^9}, {
   3.842464983462772*^9, 3.8424650049298124`*^9}, {3.84246528452767*^9, 
   3.842465366064603*^9}, {3.842531106312228*^9, 3.842531111904215*^9}, {
   3.842531170806563*^9, 3.8425312175441875`*^9}, {3.8425353192187033`*^9, 
   3.8425353873925514`*^9}, {3.842535873329647*^9, 3.8425358816892242`*^9}, {
   3.842537908955903*^9, 3.842537943370816*^9}, {3.842537983204636*^9, 
   3.842538030986149*^9}, {3.8425381000166016`*^9, 3.8425381196338596`*^9}, {
   3.8425387635999627`*^9, 3.8425388418266783`*^9}, {3.842539331175338*^9, 
   3.842539331542472*^9}, {3.842539374112077*^9, 3.8425394383095756`*^9}, {
   3.8425394696561885`*^9, 3.842539482662818*^9}, {3.842539998028343*^9, 
   3.8425402913687487`*^9}, {3.842540697323415*^9, 3.8425406976828594`*^9}, 
   3.8425601491194553`*^9, 3.842562770613078*^9, {3.8425646451260686`*^9, 
   3.842564673045337*^9}, {3.84256485911615*^9, 3.8425648668756633`*^9}, {
   3.8425649210426974`*^9, 3.8425649308676214`*^9}, {3.842565989944866*^9, 
   3.8425660155361404`*^9}, {3.842695886791564*^9, 3.8426959136561546`*^9}, {
   3.8426961254762163`*^9, 3.842696131182605*^9}, {3.8426961909791813`*^9, 
   3.842696236947603*^9}, {3.842696283979556*^9, 3.842696300388404*^9}, {
   3.8426963785896215`*^9, 3.842696383677041*^9}, {3.8426964452322226`*^9, 
   3.8426964990194435`*^9}, {3.8426966283725557`*^9, 
   3.8426966292315702`*^9}, {3.8426966756273303`*^9, 
   3.8426967052551794`*^9}, {3.842696993979254*^9, 3.8426970033330307`*^9}, {
   3.8426971282289476`*^9, 3.8426971314525805`*^9}, {3.8426971674030952`*^9, 
   3.842697203561361*^9}, {3.842697264410886*^9, 3.8426972737376623`*^9}, {
   3.842697443728713*^9, 3.8426974447699614`*^9}, {3.8426974811966743`*^9, 
   3.8426974965010757`*^9}, 3.842697624078966*^9, {3.8426976650619555`*^9, 
   3.8426977078732157`*^9}, {3.842697738245496*^9, 3.8426977456902514`*^9}, {
   3.8426977951246166`*^9, 3.842697796400037*^9}, {3.8426978283807898`*^9, 
   3.842697854681916*^9}, {3.8426978991167045`*^9, 3.842697899960123*^9}, {
   3.8426979421269264`*^9, 3.84269798782723*^9}, {3.8427084457616663`*^9, 
   3.8427084468744125`*^9}, {3.84270935068367*^9, 3.8427093868961368`*^9}, {
   3.8427094707818637`*^9, 3.842709472416069*^9}, {3.84270969227848*^9, 
   3.8427097252942357`*^9}, {3.842709758961383*^9, 3.842709762921996*^9}, {
   3.8427103078059597`*^9, 3.842710341376128*^9}, {3.842710423729542*^9, 
   3.842710435419557*^9}, 3.8427104672517815`*^9, {3.842710540160819*^9, 
   3.8427105490569615`*^9}, {3.842710654364008*^9, 3.8427106753452106`*^9}, {
   3.842710706471156*^9, 3.8427107125838366`*^9}, {3.8427107748783045`*^9, 
   3.842710809819256*^9}, {3.84271096999607*^9, 3.8427110252543993`*^9}, {
   3.8427111108652487`*^9, 3.8427111772674465`*^9}, {3.84271124260981*^9, 
   3.842711319643758*^9}, {3.8427137435578213`*^9, 
   3.842713755339307*^9}},ExpressionUUID->"e41b2265-b8b1-4d68-b2b7-\
ff160635cae3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdjustMatrix", "[", 
   RowBox[{
   "matrix_", ",", "markedrows_", ",", "markedcolumns_", ",", "size_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nonmarked", ",", "minval", ",", "modmatrix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nonmarked", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"markedrows", ",", "i"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"markedcolumns", ",", "j"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nonmarked", "=", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"nonmarked", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"minval", "=", 
      RowBox[{"Min", "[", "nonmarked", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"modmatrix", "=", "matrix"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Check", " ", "each", " ", "matrix", " ", "position"}], ";", 
        " ", 
        RowBox[{
        "if", " ", "position", " ", "is", " ", "not", " ", "a", " ", "marked",
          " ", "position"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"subtract", " ", "minimum", " ", "non"}], "-", 
         RowBox[{"marked", " ", "value"}]}], ";", "\[IndentingNewLine]", " ", 
        RowBox[{
        "if", " ", "position", " ", "falls", " ", "in", " ", "both", " ", "a",
          " ", "marked", " ", "row", " ", "and", " ", "a", " ", "marked", " ",
          "column"}]}], ",", " ", 
       RowBox[{
        RowBox[{"add", " ", "minimumn", " ", "non"}], "-", 
        RowBox[{"marked", " ", 
         RowBox[{"value", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"nonmarked", "\[LeftDoubleBracket]", 
              RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], ",", "i"}],
             "]"}], "\[And]", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"nonmarked", "\[LeftDoubleBracket]", 
              RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}], ",", "j"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"modmatrix", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "-=", 
           "minval"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"markedrows", ",", "i"}], "]"}], "\[And]", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"markedcolumns", ",", "j"}], "]"}]}], ",", 
            "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"modmatrix", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "+=", 
             "minval"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "modmatrix", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.842564933885182*^9, 3.842565312982204*^9}, {
   3.8425653523335004`*^9, 3.842565362860721*^9}, {3.842565416668044*^9, 
   3.8425654452201185`*^9}, {3.842565799809883*^9, 3.8425658283698845`*^9}, {
   3.8425658985924373`*^9, 3.8425659413035326`*^9}, {3.8426892858877764`*^9, 
   3.8426894122764435`*^9}, {3.8426896011494102`*^9, 3.8426897664699173`*^9}, 
   3.842709235482005*^9},ExpressionUUID->"52bc2e94-520e-4382-96be-\
84fd161aa85c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Obtain probabilities", "Subsection",ExpressionUUID->"2b0fb744-630f-41b5-ab52-256a79065ade"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "selected", ",", "selecteds", ",", "ultim", ",", "penultim", ",", 
     "orientation", ",", "prob", ",", "probs", ",", "nsteps"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"probs", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"selecteds", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"probs", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"probs", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"selecteds", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"selecteds", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "pruned", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
           "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"penultim", "=", 
           RowBox[{"pruned", "\[LeftDoubleBracket]", 
            RowBox[{"n", ",", 
             RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ultim", "=", 
           RowBox[{"pruned", "\[LeftDoubleBracket]", 
            RowBox[{"n", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"orientation", "=", 
           RowBox[{"OriAnt", "[", 
            RowBox[{"ultim", ",", "penultim"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"prob", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"selected", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"pruned", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
                  "\[Equal]", "t"}], "&"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nsteps", "=", 
                 RowBox[{"t", "-", 
                  RowBox[{"Max", "[", 
                   RowBox[{"pruned", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}],
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"prob", "=", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"prob", ",", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"PDF", "[", 
                    RowBox[{"speeddist", ",", 
                    FractionBox[
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}], "]"}], 
                    RowBox[{"10", "nsteps"}]]}], "]"}], "nsteps"], 
                    "\[IndentingNewLine]", 
                    SuperscriptBox[
                    RowBox[{"PDF", "[", 
                    RowBox[{"avdist", ",", 
                    RowBox[{
                    FractionBox["1", "nsteps"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ArcCos2", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "100"], ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ultim", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "100"]}], "]"}], "-", 
                    "orientation", "+", "\[Pi]"}], ",", 
                    RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], 
                    ")"}]}]}], "]"}], "nsteps"]}]}], " ", "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "1", ",", 
                 RowBox[{"Length", "[", "selected", "]"}]}], "}"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"probs", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"probs", "\[LeftDoubleBracket]", 
                 RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "prob"}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"selecteds", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"selecteds", "\[LeftDoubleBracket]", 
                 RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
                "selected"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"pruned", "\[LeftDoubleBracket]", 
                 RowBox[{"n", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
                "]"}], "+", "1"}], ",", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"pruned", "\[LeftDoubleBracket]", 
                 RowBox[{"n", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
                "]"}], "+", "11"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "pruned", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"probsout", "=", "probs"}], ";", "\[IndentingNewLine]", 
    RowBox[{"selectedout", "=", "selecteds"}], ";"}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.8423417262392144`*^9, 3.8423417329433413`*^9}, {
  3.8423470383110495`*^9, 3.8423470806452622`*^9}, {3.8423594286889777`*^9, 
  3.8423594719105873`*^9}, {3.842365823151083*^9, 3.842365909766336*^9}, {
  3.842365988214493*^9, 
  3.8423660093649244`*^9}},ExpressionUUID->"4743675b-509d-4645-a8b1-\
0df358f87def"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Join trajectories", "Subsection",
 CellChangeTimes->{{3.842366961281951*^9, 
  3.842366967457004*^9}},ExpressionUUID->"a22f65c3-d485-4bde-a2ce-\
7ebfa7873fee"],

Cell[CellGroupData[{

Cell["Pick maximum", "Subsubsection",
 CellChangeTimes->{{3.8423669708334723`*^9, 3.8423669784811907`*^9}, {
  3.8423670350398693`*^9, 3.8423670650397577`*^9}, {3.842377639195448*^9, 
  3.842377641235421*^9}},ExpressionUUID->"f578d3d2-95d1-42a7-a690-\
dd518177b5b5"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"source", ",", "target", ",", "linklabel", ",", "linked"}], "}"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"algorithm", ":", "\[IndentingNewLine]", " ", 
      RowBox[{
      "1.", " ", "Iterate", " ", "through", " ", "each", " ", "frame", 
       "\[IndentingNewLine]", "2.", " ", "At", " ", "the", " ", "given", " ", 
       "frame"}]}], ",", " ", 
     RowBox[{
     "look", " ", "for", " ", "all", " ", "trajectories", " ", "that", " ", 
      "end", " ", "at", " ", "that", " ", 
      RowBox[{"time", ".", "\[IndentingNewLine]", "3."}], " ", "At", " ", 
      "the", " ", "subsequent", " ", "frame"}], ",", " ", 
     RowBox[{
     "look", " ", "for", " ", "all", " ", "trajectories", " ", "that", " ", 
      "begin", " ", "at", " ", "that", " ", 
      RowBox[{"time", ".", "\[IndentingNewLine]", "4."}], " ", "For", " ", 
      "each", " ", "target"}], ",", " ", 
     RowBox[{
     "find", " ", "the", " ", "source", " ", "that", " ", "has", " ", "best", 
      " ", "likelihood", " ", "for", " ", "the", " ", 
      RowBox[{"target", ".", "\[IndentingNewLine]", "5."}], " ", "Repeat", 
      " ", "until", " ", "all", " ", "targets", " ", "are", " ", 
      RowBox[{"assigned", ".", "\[IndentingNewLine]", "6."}], " ", "Proceed", 
      " ", "to", " ", "the", " ", "next", " ", "frame"}], ",", " ", 
     RowBox[{
     "carrying", " ", "over", " ", "any", " ", "unmatched", " ", "trajectory",
       " ", "from", " ", "previous", " ", 
      RowBox[{"frame", ".", "\[IndentingNewLine]", "7."}], " ", "If", " ", 
      "a", " ", "trajectory", " ", "termination", " ", "point", " ", "goes", 
      " ", "unmatched", " ", "for", " ", "longer", " ", "than", " ", "5", " ",
       "frames"}], ",", " ", 
     RowBox[{"remove", " ", "it", " ", "from", " ", "the", " ", 
      RowBox[{"trajectories", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"source", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"target", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pruned", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", "t"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"source", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pruned", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", "t"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"target", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "pruned", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "source", "]"}], "+", 
           RowBox[{"Length", "[", "target", "]"}]}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"assign", "=", 
          RowBox[{"Hungarian", "[", 
           RowBox[{
           "source", ",", "target", ",", "pruned", ",", "probsout", ",", 
            "selectedout"}], "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", "4"}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.842367075233349*^9, 3.84236709176763*^9}, {
   3.8423671439428406`*^9, 3.842367164982051*^9}, {3.842377631340774*^9, 
   3.842377649396534*^9}, {3.8423776871810546`*^9, 3.842377707885271*^9}, {
   3.842377739094367*^9, 3.842377741190792*^9}, {3.8423778257369723`*^9, 
   3.8423779314839735`*^9}, {3.842377989828365*^9, 3.8423780196537*^9}, {
   3.8423785905711565`*^9, 3.84237863477236*^9}, {3.842379263579195*^9, 
   3.842379338717471*^9}, {3.842379371526156*^9, 3.8423794119908104`*^9}, {
   3.842379462656977*^9, 3.8423796499989758`*^9}, {3.8423796806859536`*^9, 
   3.842379748317932*^9}, {3.8423798654358177`*^9, 3.842379905523914*^9}, {
   3.8423799491478987`*^9, 3.8423799502905054`*^9}, {3.8423800898898616`*^9, 
   3.842380105367362*^9}, {3.8423801493913803`*^9, 3.8423801548395557`*^9}, {
   3.8426958552505455`*^9, 3.842695868144969*^9}, {3.8426967428125105`*^9, 
   3.842696772660661*^9}, {3.842696965939597*^9, 3.8426969692654886`*^9}, 
   3.8427082681530046`*^9, {3.8427092064202003`*^9, 3.8427092068361845`*^9}, {
   3.842710831845423*^9, 3.842710834864534*^9}, {3.8427109492736645`*^9, 
   3.84271095914083*^9}, {3.8427110501092157`*^9, 3.842711075774621*^9}, {
   3.8427113469645443`*^9, 
   3.8427114223928967`*^9}},ExpressionUUID->"3fb5be7c-0935-4534-a35d-\
ab28e8897786"],

Cell[BoxData["assign"], "Input",
 CellChangeTimes->{{3.8427102286041045`*^9, 3.8427102302333612`*^9}, {
  3.8427113353377686`*^9, 
  3.842711335893051*^9}},ExpressionUUID->"16277c94-f5b6-4e3a-a915-\
59c184e39e70"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.8427082535988135`*^9},ExpressionUUID->"fa682ea9-02eb-4efd-8a2b-\
e129a457e8c2"],

Cell[BoxData[
 RowBox[{"Length", "[", "selectedout", "]"}]], "Input",
 CellChangeTimes->{{3.8423784914282603`*^9, 
  3.8423785107561674`*^9}},ExpressionUUID->"23b8a43d-0d12-4efa-8669-\
3e22f7961292"],

Cell[BoxData[
 RowBox[{"Length", "[", "pruned", "]"}]], "Input",
 CellChangeTimes->{{3.8423785136209064`*^9, 
  3.8423785176809187`*^9}},ExpressionUUID->"1b220e5c-8c8b-4913-957a-\
3f0028461977"],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.842708485348177*^9, 
  3.8427084965413923`*^9}},ExpressionUUID->"dd12b6b9-f9e1-4e96-a886-\
8adf80b909e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rn", "=", 
   RowBox[{"Range", "[", "6", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8427086335753126`*^9, 
  3.8427086371928115`*^9}},ExpressionUUID->"d4c6d328-1d18-44f4-943e-\
109ef8b64d11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{"test", ",", 
    RowBox[{
     RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
  "1", "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.8427084980812535`*^9, 3.842708534527971*^9}, {
  3.842708587353405*^9, 3.8427086632237034`*^9}, {3.842708946228183*^9, 
  3.8427091019122605`*^9}, {3.8427097313012004`*^9, 3.842709732731737*^9}, {
  3.842710395896594*^9, 
  3.842710403634534*^9}},ExpressionUUID->"f7722285-b4b0-470d-8aa8-\
90014df99df5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rn", "[", "#", "]"}], "&"}]], "Input",
 CellChangeTimes->{{3.8427086719641623`*^9, 
  3.842708674883432*^9}},ExpressionUUID->"5545296f-b1fb-4525-a915-\
1322df4bf2ac"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 988},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 65, "Subsection",ExpressionUUID->"46a17531-5b19-4860-9496-e39ec32aacc0"],
Cell[748, 27, 244, 5, 35, "Input",ExpressionUUID->"25ce2295-9b5f-4d54-8802-4cbc1ea62308"],
Cell[995, 34, 217, 5, 35, "Input",ExpressionUUID->"0ba2456c-30c4-4aae-9952-15dc3327f819"],
Cell[1215, 41, 226, 6, 35, "Input",ExpressionUUID->"d729cc21-48c1-46a2-a5b0-c10f73cfbbf3"],
Cell[1444, 49, 385, 11, 84, "Input",ExpressionUUID->"1e238cbe-e63c-464e-8c4b-a74e3d7ac8b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1866, 65, 158, 3, 65, "Subsection",ExpressionUUID->"7a207016-1ca6-4326-8b49-ee747017ce4e"],
Cell[2027, 70, 7286, 169, 1312, "Input",ExpressionUUID->"643413ed-515f-4fd1-b03c-7f1887f0cc41"],
Cell[9316, 241, 465, 10, 39, "Input",ExpressionUUID->"ca5e7bc8-ee0f-4528-bcb9-fae0a576133f"]
}, Closed]],
Cell[CellGroupData[{
Cell[9818, 256, 109, 0, 62, "Section",ExpressionUUID->"dd4200ec-6dce-4877-9599-98286e8fc3c2"],
Cell[9930, 258, 2812, 64, 534, "Input",ExpressionUUID->"9ae078ee-425a-4d33-9bd4-18eef41ec0b3"],
Cell[12745, 324, 494, 11, 39, "Input",ExpressionUUID->"61017c8c-1cda-4bec-9018-6c178c5cf962"]
}, Closed]],
Cell[CellGroupData[{
Cell[13276, 340, 100, 0, 62, "Section",ExpressionUUID->"dad20c7c-aa6c-402f-a9dc-31914b06dee4"],
Cell[13379, 342, 5069, 116, 1174, "Input",ExpressionUUID->"1daa90fc-f2a8-4156-ae17-fa780477ac2d"],
Cell[18451, 460, 719, 18, 68, "Input",ExpressionUUID->"4eea3e14-0ba3-462d-bf6d-983fcec4f316"]
}, Closed]],
Cell[CellGroupData[{
Cell[19207, 483, 113, 0, 62, "Section",ExpressionUUID->"7e063f8e-7a02-4260-8e7b-ea039b870b3b"],
Cell[19323, 485, 1304, 37, 151, "Input",ExpressionUUID->"77b2e93c-23de-434b-b36f-9352d3f89987"],
Cell[20630, 524, 269, 7, 39, "Input",ExpressionUUID->"2c882d4b-33ad-4f6b-bfab-e97640f173b3"],
Cell[CellGroupData[{
Cell[20924, 535, 88, 0, 75, "Subsection",ExpressionUUID->"f4cfefdf-6e7e-4629-a591-dae21429f7e8"],
Cell[CellGroupData[{
Cell[21037, 539, 107, 0, 62, "Subsubsection",ExpressionUUID->"cf2dd87e-6d88-4c0a-822b-5fcff3d74ccc"],
Cell[21147, 541, 986, 26, 96, "Input",ExpressionUUID->"2c50db9d-1a7c-4e31-952c-0378bf3f4170"],
Cell[22136, 569, 350, 9, 39, "Input",ExpressionUUID->"f43755d5-1505-4c63-98bb-855731c25f75"]
}, Closed]],
Cell[CellGroupData[{
Cell[22523, 583, 110, 0, 51, "Subsubsection",ExpressionUUID->"f34402f9-4172-4da4-8108-b78b2289e719"],
Cell[22636, 585, 852, 24, 76, "Input",ExpressionUUID->"936b29b6-0597-4d76-af83-0c32f59f6a20"]
}, Closed]],
Cell[CellGroupData[{
Cell[23525, 614, 105, 0, 51, "Subsubsection",ExpressionUUID->"e02f78f6-888c-4f8b-bcb1-3be74d9ea194"],
Cell[23633, 616, 1279, 37, 123, "Input",ExpressionUUID->"e8e69c2f-4d51-4d07-98aa-2e9326576d9b"],
Cell[24915, 655, 1450, 42, 123, "Input",ExpressionUUID->"b38025c1-228d-4793-8b47-1240a1e57bcb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26414, 703, 86, 0, 75, "Subsection",ExpressionUUID->"9a338930-21e7-4c72-9a81-d5f4b1559234"],
Cell[26503, 705, 1870, 51, 160, "Input",ExpressionUUID->"5d861475-4c5f-45c0-ad94-43bf1acf8ad0"],
Cell[CellGroupData[{
Cell[28398, 760, 87, 0, 62, "Subsubsection",ExpressionUUID->"4298bb1a-8a08-4c8d-bb91-07bc5c9c39f6"],
Cell[28488, 762, 280, 6, 39, "Input",ExpressionUUID->"efad8eef-9572-44fc-9e94-e6a2986a1180"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[28829, 775, 110, 0, 62, "Section",ExpressionUUID->"a1bb2d26-eaac-4961-b307-7d6f857dcf0c"],
Cell[CellGroupData[{
Cell[28964, 779, 92, 0, 65, "Subsection",ExpressionUUID->"d2ca4549-765b-46dd-bd72-f64b1f72cdc4"],
Cell[29059, 781, 1393, 34, 316, "Input",ExpressionUUID->"e3c6ac16-425d-4a57-a8d6-65a6383f4a04"],
Cell[30455, 817, 1825, 48, 326, "Input",ExpressionUUID->"579f54c2-c2f2-40ca-a66a-4e4c393d2d2d"],
Cell[32283, 867, 18180, 385, 1365, "Input",ExpressionUUID->"e41b2265-b8b1-4d68-b2b7-ff160635cae3"],
Cell[50466, 1254, 4496, 107, 444, "Input",ExpressionUUID->"52bc2e94-520e-4382-96be-84fd161aa85c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54999, 1366, 97, 0, 65, "Subsection",ExpressionUUID->"2b0fb744-630f-41b5-ab52-256a79065ade"],
Cell[55099, 1368, 7976, 180, 770, "Input",ExpressionUUID->"4743675b-509d-4645-a8b1-0df358f87def"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63112, 1553, 165, 3, 65, "Subsection",ExpressionUUID->"a22f65c3-d485-4bde-a2ce-7ebfa7873fee"],
Cell[CellGroupData[{
Cell[63302, 1560, 266, 4, 53, "Subsubsection",ExpressionUUID->"f578d3d2-95d1-42a7-a690-dd518177b5b5"],
Cell[63571, 1566, 5324, 108, 612, "Input",ExpressionUUID->"3fb5be7c-0935-4534-a35d-ab28e8897786"],
Cell[68898, 1676, 213, 4, 35, "Input",ExpressionUUID->"16277c94-f5b6-4e3a-a915-59c184e39e70"],
Cell[69114, 1682, 149, 3, 60, "Input",ExpressionUUID->"fa682ea9-02eb-4efd-8a2b-e129a457e8c2"],
Cell[69266, 1687, 199, 4, 35, "Input",ExpressionUUID->"23b8a43d-0d12-4efa-8669-3e22f7961292"],
Cell[69468, 1693, 194, 4, 35, "Input",ExpressionUUID->"1b220e5c-8c8b-4913-957a-3f0028461977"],
Cell[69665, 1699, 290, 8, 35, "Input",ExpressionUUID->"dd12b6b9-f9e1-4e96-a886-8adf80b909e9"],
Cell[69958, 1709, 231, 6, 35, "Input",ExpressionUUID->"d4c6d328-1d18-44f4-943e-109ef8b64d11"],
Cell[70192, 1717, 536, 12, 35, "Input",ExpressionUUID->"f7722285-b4b0-470d-8aa8-90014df99df5"],
Cell[70731, 1731, 201, 5, 35, "Input",ExpressionUUID->"5545296f-b1fb-4525-a915-1322df4bf2ac"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

