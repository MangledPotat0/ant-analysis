(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40489,       1025]
NotebookOptionsPosition[     36713,        956]
NotebookOutlinePosition[     37059,        971]
CellTagsIndexPosition[     37016,        968]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<C:/Users/MaeLSTRoM/Desktop/Coding/ant/data/sleap\>\"", "]"}]], "Input",\
ExpressionUUID->"25ce2295-9b5f-4d54-8802-4cbc1ea62308"],

Cell[BoxData[
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<testset.hdf5\>\"", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"0ba2456c-30c4-4aae-9952-15dc3327f819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"src", "=", 
   RowBox[{
   "file", "\[LeftDoubleBracket]", "\"\</trajectory_0\>\"", 
    "\[RightDoubleBracket]"}]}], ";"}]], "Input",ExpressionUUID->"d729cc21-\
48c1-46a2-a5b0-c10f73cfbbf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imgsize", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"{", 
     RowBox[{"xmax", ",", "ymax"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"scalefactor", "=", 
  FractionBox["imgsize", "17.5"], 
  RowBox[{"(*", 
   RowBox[{"pixels", " ", "per", " ", "cm"}], "*)"}]}]}], "Input",ExpressionUU\
ID->"1e238cbe-e63c-464e-8c4b-a74e3d7ac8b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"src", "=", 
     RowBox[{"file", "\[LeftDoubleBracket]", 
      RowBox[{"n", "+", 
       RowBox[{
        RowBox[{"Length", "[", "file", "]"}], "/", "2"}]}], 
      "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"frames", "=", 
     RowBox[{"file", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"head", "=", 
     RowBox[{"src", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"thorax", "=", 
     RowBox[{"src", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"abdomen", "=", 
     RowBox[{"src", "\[LeftDoubleBracket]", 
      RowBox[{";;", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"head", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"head", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"head", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", 
            RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "head", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"thorax", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"thorax", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"thorax", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", 
            RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "thorax", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"abdomen", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"abdomen", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "n"}], "\[RightDoubleBracket]"}], ">", "1"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "skip", "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "m"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"abdomen", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", 
            RowBox[{"m", "-", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{
         "abdomen", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"avg", "=", 
     FractionBox[
      RowBox[{"head", "+", "thorax", "+", "abdomen"}], "3."]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"avg", "=", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"avg", ",", "frames"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"list", ",", 
      RowBox[{"avg", "\[Transpose]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "file", "]"}], " ", "is", " ", "always", " ", 
      "an", " ", "even", " ", "number"}], ",", " ", 
     RowBox[{
     "because", " ", "the", " ", "converter", " ", "creates", " ", "one", " ",
       "table", " ", "for", " ", "trajectory", " ", "and", " ", "one", " ", 
      "table", " ", "for", " ", "frame", " ", "numbers", " ", "for", " ", 
      "every", " ", "SLEAP", " ", "trajectory", " ", "in", " ", "the", " ", 
      "input", " ", 
      RowBox[{"file", "."}]}]}], "*)"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", "file", "]"}], "/", "2"}]}], "}"}]}], 
  "]"}]}], "Input",ExpressionUUID->"643413ed-515f-4fd1-b03c-7f1887f0cc41"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"list", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", ";;", ",", 
     RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",ExpressionUUID->\
"ca5e7bc8-ee0f-4528-bcb9-fae0a576133f"],

Cell[CellGroupData[{

Cell["Jump counts/disconnect trajectories", "Section",ExpressionUUID->"dd4200ec-6dce-4877-9599-98286e8fc3c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"jump", ",", 
      RowBox[{"\[Theta]", "=", "15.1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pruned", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"jump", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sc", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j", ",", 
                  RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "-", "1"}], ",", 
                  RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], 
               "]"}], ">", "\[Theta]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"pruned", ",", 
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"jump", ";;", 
                   RowBox[{"j", "-", "1"}]}]}], "\[RightDoubleBracket]"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"jump", "=", "j"}], ";", "\[IndentingNewLine]", 
              RowBox[{"sc", "+=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"ct", "+=", "1"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
             "list", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sc", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"pruned", ",", 
             RowBox[{
             "list", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ct", "+=", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",ExpressionUUID->"9ae078ee-\
425a-4d33-9bd4-18eef41ec0b3"],

Cell[BoxData[
 RowBox[{"tr", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"pruned", "\[LeftDoubleBracket]", 
     RowBox[{";;", ",", ";;", ",", 
      RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Full"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}]], "Input",ExpressionUUI\
D->"61017c8c-1cda-4bec-9018-6c178c5cf962"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute predicted position", "Section",ExpressionUUID->"dad20c7c-aa6c-402f-a9dc-31914b06dee4"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\[Omega]", ",", "speed", ",", "vec", ",", "dir", ",", "arg", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"refrange", "=", "5"}]}], 
    RowBox[{"(*", 
     RowBox[{
     "Number", " ", "of", " ", "frames", " ", "to", " ", "refer", " ", "to", 
      " ", "for", " ", "finding", " ", "potential", " ", "next", " ", 
      "position"}], "*)"}], "\[IndentingNewLine]", "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prediction", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "pruned", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], 
           "]"}], ">", "refrange"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Sufficiently", " ", "long", " ", "trajectories"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Omega]", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"speed", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"vec", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"refrange", "+", "1", "-", "i"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"vec", "=", 
              RowBox[{
               RowBox[{"pruned", "\[LeftDoubleBracket]", 
                RowBox[{"n", ",", 
                 RowBox[{"-", "j"}]}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{"pruned", "\[LeftDoubleBracket]", 
                RowBox[{"n", ",", 
                 RowBox[{
                  RowBox[{"-", "j"}], "-", "1"}]}], 
                "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"speed", "+=", 
              RowBox[{"Abs", "[", "vec", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dir", "=", 
              FractionBox["vec", 
               RowBox[{
                RowBox[{"Abs", "[", "vec", "]"}], "+", "0.000000000001"}]]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"arg", "=", 
              FractionBox[
               RowBox[{
               "dir", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               RowBox[{
               "dir", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "dir", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "\[GreaterEqual]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"\[Omega]", "+=", 
                RowBox[{"ArcTan", "[", "arg", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\[Omega]", "+=", 
                 RowBox[{
                  RowBox[{"1.", "\[Pi]"}], "+", 
                  RowBox[{"ArcTan", "[", "arg", "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "refrange"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"speed", "=", 
           FractionBox["speed", "refrange"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", "=", 
           FractionBox["\[Omega]", "refrange"]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Too", " ", "short", " ", "to", " ", "establish", " ", "good", " ", 
           "prediction"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"speed", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"prediction", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pruned", "\[LeftDoubleBracket]", 
            RowBox[{"n", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"pruned", "\[LeftDoubleBracket]", 
             RowBox[{"n", ",", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "+", 
            RowBox[{"speed", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Omega]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Omega]", "]"}]}], "}"}]}]}]}], "}"}]}], 
        "]"}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "pruned", "]"}]}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"1daa90fc-f2a8-4156-\
ae17-fa780477ac2d"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
     "pruned", "\[LeftDoubleBracket]", ";;", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Full"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
     "prediction", "\[LeftDoubleBracket]", ";;", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}]}], "]"}]], "Input",Exp\
ressionUUID->"4eea3e14-0ba3-462d-bf6d-983fcec4f316"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probability-based prediction visualized", "Section",ExpressionUUID->"7e063f8e-7a02-4260-8e7b-ea039b870b3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"position", "=", 
   RowBox[{"pruned", "\[LeftDoubleBracket]", 
    RowBox[{"163", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xval", "=", 
   RowBox[{
   "position", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
  RowBox[{"yval", "=", 
   RowBox[{
   "position", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
  RowBox[{"initangle", "=", 
   FractionBox[
    RowBox[{"4", "\[Pi]"}], "16"]}], ";"}]}], "Input",ExpressionUUID->\
"77b2e93c-23de-434b-b36f-9352d3f89987"],

Cell[CellGroupData[{

Cell["Single step", "Subsection",ExpressionUUID->"f4cfefdf-6e7e-4629-a591-dae21429f7e8"],

Cell[CellGroupData[{

Cell["Angle-only probability view", "Subsubsection",ExpressionUUID->"cf2dd87e-6d88-4c0a-822b-5fcff3d74ccc"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{"avdist", ",", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ArcCos2", "[", 
          RowBox[{
           RowBox[{"x", "-", "xval"}], ",", 
           RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
         "\[Pi]"}], ",", 
        RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", 
   RowBox[{"MaxRecursion", "\[Rule]", "5"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of next step angle for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"2c50db9d-1a7c-4e31-952c-0378bf3f4170"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{"avdist", ",", "\[Theta]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",ExpressionUUID->\
"f43755d5-1505-4c63-98bb-855731c25f75"]
}, Closed]],

Cell[CellGroupData[{

Cell["Stepsize-only probability view", "Subsubsection",ExpressionUUID->"f34402f9-4172-4da4-8108-b78b2289e719"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"PDF", "[", 
    RowBox[{"speeddist", ",", 
     FractionBox[
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], "scalefactor"]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of distance to next step for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"936b29b6-0597-4d76-af83-0c32f59f6a20"]
}, Closed]],

Cell[CellGroupData[{

Cell["Combined probability view", "Subsubsection",ExpressionUUID->"e02f78f6-888c-4f8b-bcb1-3be74d9ea194"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{"speeddist", ",", 
      FractionBox[
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], "scalefactor"]}],
      "]"}], 
    RowBox[{"PDF", "[", 
     RowBox[{"avdist", ",", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcCos2", "[", 
           RowBox[{
            RowBox[{"x", "-", "xval"}], ",", 
            RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
          "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of distance to next step for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"e8e69c2f-4d51-4d07-98aa-2e9326576d9b"],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{"speeddist", ",", 
      FractionBox[
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], "scalefactor"]}],
      "]"}], 
    RowBox[{"PDF", "[", 
     RowBox[{"avdist", ",", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcCos2", "[", 
           RowBox[{
            RowBox[{"x", "-", "xval"}], ",", 
            RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
          "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"xval", "-", "100"}], ",", 
     RowBox[{"xval", "+", "100"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"yval", "-", "100"}], ",", 
     RowBox[{"yval", "+", "100"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
   RowBox[{"MaxRecursion", "\[Rule]", "15"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Probability of distance to next step for sample position\>\""}]}], 
  "]"}]], "Input",ExpressionUUID->"b38025c1-228d-4793-8b47-1240a1e57bcb"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-steps", "Subsection",ExpressionUUID->"9a338930-21e7-4c72-9a81-d5f4b1559234"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"probrepeat", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dp", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"PDF", "[", 
       RowBox[{"speeddist", ",", 
        FractionBox[
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "xval"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", "yval"}], ")"}], "2"]}], "]"}], 
         RowBox[{"10", "probrepeat", " "}]]}], "]"}], "probrepeat"], 
     SuperscriptBox[
      RowBox[{"PDF", "[", 
       RowBox[{"avdist", ",", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ArcCos2", "[", 
               RowBox[{
                RowBox[{"x", "-", "xval"}], ",", 
                RowBox[{"y", "-", "yval"}]}], "]"}], "-", "initangle", "+", 
              "\[Pi]"}], ",", 
             RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], ")"}], 
         "probrepeat"]}], "]"}], "probrepeat"]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "700"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", "700"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "300"}], ",", 
    RowBox[{"MaxRecursion", "\[Rule]", "15"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{
    "PlotLabel", "\[Rule]", 
     "\"\<Probability of distance to next step for sample position\>\""}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]}]}], "Input",ExpressionU\
UID->"5d861475-4c5f-45c0-ad94-43bf1acf8ad0"],

Cell[CellGroupData[{

Cell["Overlay", "Subsubsection",ExpressionUUID->"4298bb1a-8a08-4c8d-bb91-07bc5c9c39f6"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"dp", ",", "ft"}], "]"}]], "Input",ExpressionUUID->"efad8eef-9572-\
44fc-9e94-e6a2986a1180"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probability-based prediction compute", "Section",ExpressionUUID->"a1bb2d26-eaac-4961-b307-7d6f857dcf0c"],

Cell[CellGroupData[{

Cell["Helper function", "Subsection",ExpressionUUID->"d2ca4549-765b-46dd-bd72-f64b1f72cdc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcCos2", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "ans", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "<", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ans", "=", 
        RowBox[{"ArcCos", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ans", "=", 
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ans", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"ans", "+", "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "ans", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"e3c6ac16-425d-4a57-a8d6-65a6383f4a04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OriAnt", "[", 
   RowBox[{"ultim_", ",", "penultim_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "y1", ",", "x2", ",", "y2", ",", "dx", ",", "dy", ",", "norm",
       ",", "angle"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dx", "=", 
      RowBox[{"x2", "-", "x1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dy", "=", 
      RowBox[{"y2", "-", "y1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"norm", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["dx", "2"], "+", 
         SuperscriptBox["dy", "2"]}], "]"}], "+", "0.0001"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcCos2", "[", 
       RowBox[{
        FractionBox["dx", "norm"], ",", 
        FractionBox["dy", "norm"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "angle", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"579f54c2-c2f2-40ca-a66a-4e4c393d2d2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Obtain probabilities", "Subsection",ExpressionUUID->"2b0fb744-630f-41b5-ab52-256a79065ade"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "selected", ",", "selecteds", ",", "ultim", ",", "penultim", ",", 
     "orientation", ",", "prob", ",", "probs", ",", "nsteps"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"probs", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"selecteds", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"probs", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"probs", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"selecteds", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"selecteds", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ultim", "=", 
           RowBox[{"pruned", "\[LeftDoubleBracket]", 
            RowBox[{"n", ",", 
             RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "pruned", "\[LeftDoubleBracket]", "n", 
               "\[RightDoubleBracket]"}], "]"}], ">", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"penultim", "=", 
              RowBox[{"pruned", "\[LeftDoubleBracket]", 
               RowBox[{"n", ",", 
                RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"orientation", "=", 
              RowBox[{"OriAnt", "[", 
               RowBox[{"ultim", ",", "penultim"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"selected", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"pruned", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
                  "\[Equal]", "t"}], "&"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nsteps", "=", 
                 RowBox[{"t", "-", 
                  RowBox[{"Max", "[", 
                   RowBox[{"pruned", "\[LeftDoubleBracket]", 
                    RowBox[{"n", ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}],
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"prob", "=", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"PDF", "[", 
                    RowBox[{"speeddist", ",", 
                    FractionBox[
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-", "xval"}], ")"}], "2"], 
                    "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "-", "yval"}], ")"}], "2"]}], 
                    "]"}], 
                    RowBox[{"10", "nsteps"}]]}], "]"}], "nsteps"], 
                  "\[IndentingNewLine]", 
                  SuperscriptBox[
                   RowBox[{"PDF", "[", 
                    RowBox[{"avdist", ",", 
                    RowBox[{
                    FractionBox["1", "nsteps"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ArcCos2", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-", "xval"}], ",", 
                    RowBox[{
                    RowBox[{"selected", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "-", "yval"}]}], "]"}], "-", 
                    "initangle", "+", "\[Pi]"}], ",", 
                    RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], 
                    ")"}]}]}], "]"}], "nsteps"]}]}], " ", ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"probs", "\[LeftDoubleBracket]", 
                  RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"probs", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
                   "prob"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"selecteds", "\[LeftDoubleBracket]", 
                  RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"selecteds", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
                   "selected"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "1", ",", 
                 RowBox[{"Length", "[", "selected", "]"}]}], "}"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"pruned", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
             "]"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"pruned", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], 
             "]"}], "+", "11"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"Length", "[", "pruned", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"probsout", "=", "probs"}], ";", "\[IndentingNewLine]", 
    RowBox[{"selectedout", "=", "selecteds"}], ";"}]}], "\[IndentingNewLine]",
   "]"}]], "Input",ExpressionUUID->"4743675b-509d-4645-a8b1-0df358f87def"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{838, 958},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 180, 3, 28, "Input",ExpressionUUID->"25ce2295-9b5f-4d54-8802-4cbc1ea62308"],
Cell[741, 25, 217, 5, 28, "Input",ExpressionUUID->"0ba2456c-30c4-4aae-9952-15dc3327f819"],
Cell[961, 32, 226, 6, 28, "Input",ExpressionUUID->"d729cc21-48c1-46a2-a5b0-c10f73cfbbf3"],
Cell[1190, 40, 385, 11, 74, "Input",ExpressionUUID->"1e238cbe-e63c-464e-8c4b-a74e3d7ac8b8"],
Cell[1578, 53, 7286, 169, 912, "Input",ExpressionUUID->"643413ed-515f-4fd1-b03c-7f1887f0cc41"],
Cell[8867, 224, 465, 10, 28, "Input",ExpressionUUID->"ca5e7bc8-ee0f-4528-bcb9-fae0a576133f"],
Cell[CellGroupData[{
Cell[9357, 238, 109, 0, 67, "Section",ExpressionUUID->"dd4200ec-6dce-4877-9599-98286e8fc3c2"],
Cell[9469, 240, 2812, 64, 371, "Input",ExpressionUUID->"9ae078ee-425a-4d33-9bd4-18eef41ec0b3"],
Cell[12284, 306, 494, 11, 28, "Input",ExpressionUUID->"61017c8c-1cda-4bec-9018-6c178c5cf962"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12815, 322, 100, 0, 67, "Section",ExpressionUUID->"dad20c7c-aa6c-402f-a9dc-31914b06dee4"],
Cell[12918, 324, 5069, 116, 816, "Input",ExpressionUUID->"1daa90fc-f2a8-4156-ae17-fa780477ac2d"],
Cell[17990, 442, 719, 18, 48, "Input",ExpressionUUID->"4eea3e14-0ba3-462d-bf6d-983fcec4f316"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18746, 465, 113, 0, 67, "Section",ExpressionUUID->"7e063f8e-7a02-4260-8e7b-ea039b870b3b"],
Cell[18862, 467, 647, 18, 72, "Input",ExpressionUUID->"77b2e93c-23de-434b-b36f-9352d3f89987"],
Cell[CellGroupData[{
Cell[19534, 489, 88, 0, 53, "Subsection",ExpressionUUID->"f4cfefdf-6e7e-4629-a591-dae21429f7e8"],
Cell[CellGroupData[{
Cell[19647, 493, 107, 0, 44, "Subsubsection",ExpressionUUID->"cf2dd87e-6d88-4c0a-822b-5fcff3d74ccc"],
Cell[19757, 495, 986, 26, 67, "Input",ExpressionUUID->"2c50db9d-1a7c-4e31-952c-0378bf3f4170"],
Cell[20746, 523, 350, 9, 28, "Input",ExpressionUUID->"f43755d5-1505-4c63-98bb-855731c25f75"]
}, Closed]],
Cell[CellGroupData[{
Cell[21133, 537, 110, 0, 36, "Subsubsection",ExpressionUUID->"f34402f9-4172-4da4-8108-b78b2289e719"],
Cell[21246, 539, 852, 24, 54, "Input",ExpressionUUID->"936b29b6-0597-4d76-af83-0c32f59f6a20"]
}, Closed]],
Cell[CellGroupData[{
Cell[22135, 568, 105, 0, 36, "Subsubsection",ExpressionUUID->"e02f78f6-888c-4f8b-bcb1-3be74d9ea194"],
Cell[22243, 570, 1279, 37, 86, "Input",ExpressionUUID->"e8e69c2f-4d51-4d07-98aa-2e9326576d9b"],
Cell[23525, 609, 1450, 42, 86, "Input",ExpressionUUID->"b38025c1-228d-4793-8b47-1240a1e57bcb"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25024, 657, 86, 0, 53, "Subsection",ExpressionUUID->"9a338930-21e7-4c72-9a81-d5f4b1559234"],
Cell[25113, 659, 1799, 49, 182, "Input",ExpressionUUID->"5d861475-4c5f-45c0-ad94-43bf1acf8ad0"],
Cell[CellGroupData[{
Cell[26937, 712, 87, 0, 44, "Subsubsection",ExpressionUUID->"4298bb1a-8a08-4c8d-bb91-07bc5c9c39f6"],
Cell[27027, 714, 139, 3, 28, "Input",ExpressionUUID->"efad8eef-9572-44fc-9e94-e6a2986a1180"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27227, 724, 110, 0, 67, "Section",ExpressionUUID->"a1bb2d26-eaac-4961-b307-7d6f857dcf0c"],
Cell[CellGroupData[{
Cell[27362, 728, 92, 0, 53, "Subsection",ExpressionUUID->"d2ca4549-765b-46dd-bd72-f64b1f72cdc4"],
Cell[27457, 730, 971, 25, 181, "Input",ExpressionUUID->"e3c6ac16-425d-4a57-a8d6-65a6383f4a04"],
Cell[28431, 757, 1077, 28, 194, "Input",ExpressionUUID->"579f54c2-c2f2-40ca-a66a-4e4c393d2d2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29545, 790, 97, 0, 53, "Subsection",ExpressionUUID->"2b0fb744-630f-41b5-ab52-256a79065ade"],
Cell[29645, 792, 7040, 160, 718, "Input",ExpressionUUID->"4743675b-509d-4645-a8b1-0df358f87def"]
}, Open  ]]
}, Open  ]]
}
]
*)

