(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    172840,       4138]
NotebookOptionsPosition[    159898,       3940]
NotebookOutlinePosition[    160275,       3956]
CellTagsIndexPosition[    160232,       3953]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Density data plotting code", "Title",
 CellChangeTimes->{{3.8171740510507956`*^9, 
  3.8171740574407177`*^9}},ExpressionUUID->"0b501704-bc82-43fb-b47b-\
6e1154367685"],

Cell[CellGroupData[{

Cell["Version: 1.3.2", "Chapter",
 CellChangeTimes->{{3.8171740654009686`*^9, 3.8171740690302696`*^9}, {
  3.8371766306844764`*^9, 3.8371766314441633`*^9}, {3.837176704315341*^9, 
  3.837176709587756*^9}, {3.8376934844000835`*^9, 
  3.837693484663065*^9}},ExpressionUUID->"c998a13c-5904-496e-bae0-\
883713f176c8"],

Cell[CellGroupData[{

Cell["Common", "Subchapter",
 CellChangeTimes->{{3.837176642832296*^9, 
  3.837176648732191*^9}},ExpressionUUID->"5097a9c0-dd25-483f-a589-\
41caf672929b"],

Cell[CellGroupData[{

Cell["Directory setting", "Section",
 CellChangeTimes->{{3.817174072771306*^9, 
  3.8171740747211075`*^9}},ExpressionUUID->"a27551c3-da23-42eb-b19a-\
9dd9288c8c9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"currentDir", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "currentDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expdir", "=", "\"\<../../data/density/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simdir", "=", "\"\<../simulation/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matdir", "=", "\"\<../../DFT code copy/DFFT-master/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.8171738675367455`*^9, 3.8171738788983765`*^9}, {
   3.817173976833377*^9, 3.817173986622721*^9}, {3.8225755277352285`*^9, 
   3.8225755311131935`*^9}, {3.8296408727539897`*^9, 3.829640929854041*^9}, {
   3.8360579556923018`*^9, 3.8360579570360947`*^9}, {3.836296664199073*^9, 
   3.836296665862073*^9}, {3.836394564214578*^9, 3.8363945650865097`*^9}, {
   3.836402182863206*^9, 3.8364021849660015`*^9}, {3.836549954086923*^9, 
   3.836549957189354*^9}, {3.8365521473729343`*^9, 3.8365521490749025`*^9}, {
   3.8369967023437643`*^9, 3.8369967642480197`*^9}, {3.8369968016902733`*^9, 
   3.836996818422324*^9}, {3.8369976570577602`*^9, 3.8369976624742575`*^9}, 
   3.8369977081296954`*^9, {3.837156805714721*^9, 
   3.837156805935343*^9}},ExpressionUUID->"ae5fceec-7453-4a36-860b-\
b7f050e73d91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["File import", "Section",
 CellChangeTimes->{{3.817174137493004*^9, 
  3.8171741393320866`*^9}},ExpressionUUID->"f980ed48-3752-4e40-a237-\
f88ead2916b1"],

Cell[CellGroupData[{

Cell["Experiment data", "Subsection",
 CellChangeTimes->{{3.8369966197610245`*^9, 
  3.8369966223934402`*^9}},ExpressionUUID->"64c11c14-d401-463f-9793-\
f84ac0042148"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filename", "=", "\"\<a2021-07-28-02/data\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importdir", "=", "expdir"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hdf5File", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"ToString", "@", 
      RowBox[{"Row", "@", 
       RowBox[{"{", 
        RowBox[{"importdir", ",", "filename", ",", "\"\<.hdf5\>\""}], 
        "}"}]}]}], ",", "\"\<Data\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8171741441661634`*^9, 3.8171741683824377`*^9}, {
   3.8171741993829412`*^9, 3.8171741995544825`*^9}, {3.817174241762678*^9, 
   3.817174275592573*^9}, 3.817174625438364*^9, 3.8171746669179363`*^9, 
   3.8172089947629557`*^9, {3.817303692287525*^9, 3.817303714718393*^9}, {
   3.817919109782592*^9, 3.817919135448383*^9}, {3.817919231449888*^9, 
   3.8179192471303267`*^9}, {3.8179196594345093`*^9, 
   3.8179196609844303`*^9}, {3.8179196969360332`*^9, 3.817919701464215*^9}, {
   3.8225754253476753`*^9, 3.8225754323448176`*^9}, {3.822575477378647*^9, 
   3.8225754843635416`*^9}, {3.82257551553889*^9, 3.822575515683503*^9}, {
   3.822576256053524*^9, 3.822576287371793*^9}, {3.8225763221429157`*^9, 
   3.8225763322919407`*^9}, {3.823362039523451*^9, 3.8233620400584354`*^9}, {
   3.8233620787208023`*^9, 3.8233620796152034`*^9}, {3.823362141005108*^9, 
   3.8233621503430657`*^9}, {3.8233621936224165`*^9, 
   3.8233621991612043`*^9}, {3.829183671805688*^9, 3.829183687011736*^9}, {
   3.8291837365794115`*^9, 3.8291837402504845`*^9}, {3.8291837717789917`*^9, 
   3.829183774242652*^9}, {3.82918385075388*^9, 3.8291839257442474`*^9}, {
   3.8291840667270145`*^9, 3.8291841849077625`*^9}, {3.8291842614114604`*^9, 
   3.8291842673551397`*^9}, {3.82918432949916*^9, 3.8291843323702264`*^9}, {
   3.829184363851536*^9, 3.8291843650417643`*^9}, {3.8291843966580567`*^9, 
   3.8291844657756777`*^9}, {3.8291846880298777`*^9, 3.829184780187344*^9}, {
   3.8291848179307723`*^9, 3.8291848329385805`*^9}, {3.8291852897735395`*^9, 
   3.8291853438825097`*^9}, {3.829187148640394*^9, 3.829187178006218*^9}, {
   3.829222608607519*^9, 3.829222697902523*^9}, {3.829227767466792*^9, 
   3.829227786713784*^9}, {3.8297514820278177`*^9, 3.829751526024816*^9}, 
   3.8297617397742443`*^9, {3.8360553831388807`*^9, 3.8360553896356087`*^9}, {
   3.836057991631734*^9, 3.8360580005491676`*^9}, {3.8362966476230726`*^9, 
   3.8362966557580595`*^9}, {3.83639183887438*^9, 3.836391839465582*^9}, {
   3.836392989740159*^9, 3.8363929898431597`*^9}, {3.836393424277528*^9, 
   3.8363934263087783`*^9}, {3.836394520551773*^9, 3.836394534358651*^9}, {
   3.836402192222983*^9, 3.83640219299055*^9}, {3.836472682068631*^9, 
   3.8364726906068068`*^9}, {3.8365499688299756`*^9, 3.836549975868363*^9}, {
   3.836550007172789*^9, 3.8365500399799337`*^9}, {3.836552155462021*^9, 
   3.836552164844639*^9}, {3.836642552871852*^9, 3.8366425556786633`*^9}, {
   3.836996814014762*^9, 
   3.836996822795268*^9}},ExpressionUUID->"d992478e-1c3f-48e4-bc2a-\
1f285f42d693"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imstack", "=", 
   RowBox[{"hdf5File", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"9000", ";;", "18000"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "@", 
  RowBox[{"imstack", "\[LeftDoubleBracket]", 
   RowBox[{";;", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "Input",
 CellChangeTimes->{{3.829751558861811*^9, 3.829751638791335*^9}, {
  3.829751693878615*^9, 3.82975169843862*^9}, {3.8360580093901424`*^9, 
  3.8360580095089045`*^9}, {3.836394583222535*^9, 
  3.8363945841902833`*^9}},ExpressionUUID->"e0713fa5-aa51-402a-b538-\
9b5d9b5ca3a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imstack", " ", "+=", 
   RowBox[{"hdf5File", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"1", ";;", "18000"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "@", 
  RowBox[{"imstack", "\[LeftDoubleBracket]", 
   RowBox[{";;", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "Input",
 CellChangeTimes->{{3.829184413855755*^9, 3.829184414434106*^9}, {
  3.8291846979333744`*^9, 3.829184716987373*^9}, {3.829185285115717*^9, 
  3.829185286019437*^9}, {3.8364682653284407`*^9, 
  3.8364682671988587`*^9}},ExpressionUUID->"e07de534-dd0f-44ec-b0ab-\
019d9c1912cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simulation data", "Subsection",
 CellChangeTimes->{{3.836996637880414*^9, 
  3.8369966407204237`*^9}},ExpressionUUID->"3081652f-efb1-4eb3-9f44-\
c77a82303748"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filename", "=", "\"\<meh\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importdir", "=", "simdir"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hdf5File", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"ToString", "@", 
      RowBox[{"Row", "@", 
       RowBox[{"{", 
        RowBox[{"importdir", ",", "filename", ",", "\"\<.hdf5\>\""}], 
        "}"}]}]}], ",", "\"\<Data\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.836996679577129*^9, 3.8369966847680445`*^9}, {
  3.8369968061979885`*^9, 
  3.83699680859877*^9}},ExpressionUUID->"50635cf1-5eed-4db2-a6e9-\
dcd43bcd5403"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"simstack", "=", 
   RowBox[{"hdf5File", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"40000", ";;", "79999", ";;", "150"}], ",", "1", ",", ";;", ",", 
     ";;"}], "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imstack", "=", "simstack"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "@", 
  RowBox[{"imstack", "\[LeftDoubleBracket]", 
   RowBox[{";;", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "Input",
 CellChangeTimes->{{3.829751558861811*^9, 3.829751638791335*^9}, {
  3.829751693878615*^9, 3.829751751868944*^9}, {3.8297518604999585`*^9, 
  3.8297518606519475`*^9}, {3.829751976643738*^9, 3.829751982330028*^9}, {
  3.829752013137397*^9, 3.829752013378395*^9}, {3.829752261767838*^9, 
  3.829752266781842*^9}, {3.8360565793410997`*^9, 3.8360565848929405`*^9}, {
  3.8363924474341564`*^9, 3.8363924494899855`*^9}, {3.836393647139309*^9, 
  3.836393647553294*^9}, {3.8363937461940928`*^9, 3.836393759664956*^9}, {
  3.836393811488391*^9, 3.836393812953034*^9}, {3.8363939503269186`*^9, 
  3.8363939513418365`*^9}, {3.836402199663215*^9, 3.836402203446248*^9}, {
  3.8364023389171715`*^9, 3.8364023398924875`*^9}, {3.836468254423823*^9, 
  3.8364683144863367`*^9}, {3.8365521809015627`*^9, 
  3.8365521848679895`*^9}},ExpressionUUID->"524d4316-b055-4ea1-9bfb-\
3e446c1cf16d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matlab data", "Subsection",
 CellChangeTimes->{{3.8369966471602983`*^9, 
  3.836996649432296*^9}},ExpressionUUID->"ac2a5e42-29f3-4fda-a6dc-\
0d845d643d59"],

Cell[BoxData[
 RowBox[{"\"\<Trial_Data/occ_exp\>\"", ";"}]], "Input",
 CellChangeTimes->{{3.8369989124145503`*^9, 3.8369989147913218`*^9}, 
   3.8370023668129873`*^9},ExpressionUUID->"e177e86e-cffb-4e0a-8a46-\
aa9696cfb496"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "filename", "=", 
   "\"\<osfstorage-archive/Figure 2/occ_rectangle_96flies\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importdir", "=", "matdir"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matFile", "=", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"ToString", "@", 
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{"importdir", ",", "filename", ",", "\"\<.mat\>\""}], 
         "}"}]}]}], ",", "\"\<Data\>\""}], "]"}], "\[LeftDoubleBracket]", "1",
     "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.836996679577129*^9, 3.8369966847680445`*^9}, {
   3.836996770238567*^9, 3.8369967836306753`*^9}, {3.836996836127885*^9, 
   3.8369968395889997`*^9}, {3.836996903501641*^9, 3.8369969164209456`*^9}, 
   3.8369970366553507`*^9, {3.836997067979185*^9, 3.8369970710108957`*^9}, {
   3.8369976689059763`*^9, 3.8369976756992025`*^9}, {3.836998505537879*^9, 
   3.83699852506882*^9}, {3.83699884299855*^9, 3.8369988593833895`*^9}, {
   3.836998909227454*^9, 
   3.836998916608309*^9}},ExpressionUUID->"6e9c2c40-c3ea-43e9-9d43-\
a51067dfeb27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim1", "=", "24"}], ";", 
  "\"\<Sqrt@Length@matFile\[LeftDoubleBracket]1\[RightDoubleBracket]\>\"", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim2", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imstack", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"#", ",", "dim1"}], "]"}], "&"}], "/@", "matFile"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "@", 
  RowBox[{"imstack", "\[LeftDoubleBracket]", 
   RowBox[{";;", ",", 
    RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/XXy7QerO944zgu6+QpEz5Xd8xFEp5z7/QNEr/zf
z7YGSB+8MwVMN8wUEQXR0/tPgem+1CWSIPqC9BowrThphwWIvsUSaQmivV5l
NWya8sbxxySZRhA958nb+rCpbxy/rdVvANEWpU9Ew4H0tC0fwTSTmZsSiA5y
/6oMop8tyNcC0Y7188C0XNkpaxAd/OEVmOa3/OoUDaRXuec5g+iKyNgQEO3U
XwOmv/afba4G0kIT/LtB9Kybc+qWAOlJx6TrQbT9a79dtdPeOJ6Tu3kARJvf
aTkFopky1S+D6DKp5FV1QNpt4Zx1IPq0Y+QBEM0klg6m3a5sOgqiN4XuA9Nv
5B3Pg+iStOZLIFp/YfN1EM2gbngDRMfoiP4F0UciX/0D8022vVs8/Y3jsuTN
n0E0AGDX2OY=
  "],ExpressionUUID->"64a1a5e9-752f-49f2-be56-36f50a4404c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timesteps", "=", 
   RowBox[{"Length", "[", "imstack", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8375996495154657`*^9, 3.837599657021648*^9}, {
  3.838375298056241*^9, 
  3.8383753017684712`*^9}},ExpressionUUID->"466d3477-5b10-4269-9bf8-\
dbe8d772aed4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Parameters", "Section",
 CellChangeTimes->{{3.817174950836508*^9, 3.817174955175918*^9}, {
  3.837523285377036*^9, 
  3.8375232862724967`*^9}},ExpressionUUID->"b61ff97e-a339-49e3-a1bf-\
8f4a9f59064c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Normfactor", " ", "is", " ", "1", " ", "if", " ", "data", " ", "is", " ",
      "in", " ", "counts"}], ";", " ", 
    RowBox[{"normfactor", " ", "is", " ", 
     RowBox[{"Max", "[", 
      RowBox[{"Total", "@", "Total"}], "]"}], " ", "if", " ", "data", " ", 
     "is", " ", "in", " ", "density"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"normfactor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antcount", "=", 
     RowBox[{"Round", "[", 
      RowBox[{"normfactor", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "@", 
           RowBox[{"Total", "@", "#"}]}], "&"}], "/@", "imstack"}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxcount", "=", 
     RowBox[{"Round", "[", 
      RowBox[{"normfactor", " ", 
       RowBox[{"Max", "[", "imstack", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8171749579814467`*^9, 3.8171749619867415`*^9}, {
   3.817175621885062*^9, 3.817175624705823*^9}, {3.8225755395430403`*^9, 
   3.822575539903654*^9}, {3.822576290712491*^9, 3.8225762911417985`*^9}, {
   3.8225763348522053`*^9, 3.8225763349140377`*^9}, {3.8233620842522388`*^9, 
   3.823362084956029*^9}, {3.8291839569917912`*^9, 3.8291839581119747`*^9}, {
   3.829184476137171*^9, 3.82918448583939*^9}, {3.8291876264810247`*^9, 
   3.8291876272478333`*^9}, {3.8292227609585133`*^9, 
   3.8292227615345125`*^9}, {3.8292249993330417`*^9, 3.8292249994830523`*^9}, 
   3.8292250311260386`*^9, {3.8292277952687807`*^9, 3.8292277957277803`*^9}, {
   3.8297520584003887`*^9, 3.829752065856395*^9}, {3.82975302185703*^9, 
   3.8297530349540353`*^9}, {3.8360555516508365`*^9, 3.836055554251333*^9}, {
   3.8360580136539555`*^9, 3.836058014124524*^9}, {3.836058242266331*^9, 
   3.8360582423946548`*^9}, {3.8362966880620594`*^9, 3.836296691230059*^9}, {
   3.8363946683735394`*^9, 3.8363946701415334`*^9}, {3.8364022198377867`*^9, 
   3.836402220006163*^9}, {3.836486355933919*^9, 3.836486356710018*^9}, {
   3.836550052483516*^9, 3.836550052931768*^9}, {3.8365501125467663`*^9, 
   3.836550112651351*^9}, {3.8365521908921394`*^9, 3.8365521934125376`*^9}, {
   3.836997774727496*^9, 3.8369977803353868`*^9}, {3.836997984276635*^9, 
   3.8369979844691086`*^9}, {3.8369989299825373`*^9, 3.836998930966632*^9}, {
   3.8369991841395283`*^9, 3.8369991850588355`*^9}, {3.836999369632415*^9, 
   3.8369993699052258`*^9}, {3.8375232881613436`*^9, 3.837523395783909*^9}, 
   3.837523437553342*^9, {3.8375245140240693`*^9, 3.837524545558648*^9}, {
   3.8375246164380665`*^9, 3.837524643469251*^9}, {3.8383752694999313`*^9, 
   3.838375271794344*^9}, {3.838470359467944*^9, 
   3.838470361042142*^9}},ExpressionUUID->"66d54f96-ac88-4159-843e-\
4f556d07d83e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decorrelation time", "Section",
 CellChangeTimes->{{3.837599727939604*^9, 
  3.8375997313228292`*^9}},ExpressionUUID->"800166f9-05e9-40c8-b297-\
70a7b0f05a21"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "flattened", ",", "fouriertrans", ",", "unfourier", ",", "c", ",", 
     "sample", ",", "polyfit", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"flattened", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "imstack"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fouriertrans", "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "timesteps", "]"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Fourier", "[", 
          RowBox[{"flattened", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "#"}], "\[RightDoubleBracket]"}], "]"}], "&"}], 
        "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"dim1", " ", "dim2"}], "]"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fouriertrans", "=", 
     SuperscriptBox[
      RowBox[{"Abs", "[", "fouriertrans", "]"}], "2"]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"unfourier", "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"InverseFourier", "[", "#", "]"}], 
        RowBox[{"Sqrt", "[", "timesteps", "]"}]], "&"}], "/@", 
      "fouriertrans"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"asdf", "=", 
     FractionBox[
      RowBox[{"Abs", "[", "unfourier", "]"}], "timesteps"]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"unfourier", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"Abs", "[", "unfourier", "]"}], "timesteps"], "-", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", "timesteps", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Mean", "[", 
             RowBox[{"flattened", "\[LeftDoubleBracket]", 
              RowBox[{";;", ",", "#"}], "\[RightDoubleBracket]"}], "]"}], 
            "2"], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"dim1", " ", "dim2"}], "]"}]}]}], "]"}], 
       "\[Transpose]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"c", "=", 
     RowBox[{"Mean", "[", "unfourier", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"cc", "=", "c"}], ";", "\[IndentingNewLine]", 
    RowBox[{"sample", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"polyfit", "=", 
     RowBox[{"NonlinearModelFit", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sample", ",", 
          RowBox[{"Log", "[", 
           RowBox[{
           "c", "\[LeftDoubleBracket]", "sample", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}], "\[Transpose]"}], ",", 
       RowBox[{
        RowBox[{"b", " ", "x"}], "+", "a"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", "x"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{
      RowBox[{"polyfit", "[", "1", "]"}], "-", 
      RowBox[{"polyfit", "[", "0", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tau", "=", 
     FractionBox[
      RowBox[{"-", "1"}], "p"]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzltI02EABfA1XOUSjJFONnBlKjgXLmY1WQ9NNxi2LVkSy24yTcxNnBd0
WJYaxFBRo9hc5oVFTWK6tEFgYogxFoWtUJNyLqzGRv9kgZsP0mjnezj83s45
R3QNmut0Go1WmAh8pTbHn1gpqV/sIh42FfCiQ5Q0LU9MNPxc5KpslJQ+zc2E
nbmpOdBbMyiEj+23TsPSqZEyGDTqL0DWwqwWbvhndHCb76uCqSJnPXzkzGiA
7wVaE6wt/NUNS4rmesnO9Eg/jBjpFjjHukss92idMNZuJ1YGLs+TXWrSC/ND
xUtQd0JOvKb6EYOmFdkO/Hx764A6objvWQpcDp/hwNKn+kxo6us4Dqt7l0XQ
VzB8Cma86ymCK+OrMhi/EpXDupf3lFA1zFGTXlHXDagQLRFLLXmt8HdaeRts
sbo7YM0/cz+MPNQ/gFdnTMSZ5J0heLNJY4NLPfUOWLwbnYC5gxddsLukgahg
SdyQybARd1y8eTjepl6AnP3b63C00eeHgagnCM38xhA8yTdG4PPvb4n3nY4Y
/JAVIYYU1C70tjBp5xLO9lBJcEK+S1QOuFIhu7OKBV1fJWwoSE/mwlq+IBs2
X7Lnw61j5yvgYB1NB+mGrlYoy/7SDjVC1R2YdDTLDKdWmX0wI2eMmCI9NAYt
5dUOuKlkv4BeYeUbuC5hfIROt84H115/WoOtw2e/QU8zdxPG94TDsGJUvAV7
LYt/ya/gJKMsod06sBduGAIp0KBqPAj/7JOnw9WKJh78D1nCqMk=
  "],ExpressionUUID->"dc10e58b-e363-4cb7-bfd6-da6eb1e741a8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simple average method", "Subchapter",
 CellChangeTimes->{{3.837176679259634*^9, 
  3.8371766927481494`*^9}},ExpressionUUID->"9188639b-24dd-49cc-9d83-\
b6a6070e5c7e"],

Cell[CellGroupData[{

Cell["Time integration", "Section",
 CellChangeTimes->{{3.8171741415730963`*^9, 3.8171741420328703`*^9}, {
  3.8171746733158035`*^9, 
  3.817174688426669*^9}},ExpressionUUID->"a68ad916-9391-410d-89fb-\
e823d54a28af"],

Cell[CellGroupData[{

Cell["Plot", "Subsection",
 CellChangeTimes->{{3.8171746897271643`*^9, 3.817174695536958*^9}, {
  3.836058040789781*^9, 
  3.836058042621038*^9}},ExpressionUUID->"981e618d-ff48-488c-af54-\
3a0c1f240aea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"imstack", "=", 
     RowBox[{"imstack", "-", 
      RowBox[{"Min", "[", "imstack", "]"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"squish", "=", 
     RowBox[{
     "imstack", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"squish", "+=", 
       RowBox[{
       "imstack", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
      ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "[", "imstack", "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"squish", "/=", 
     RowBox[{"Length", "[", "imstack", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalantness", "=", 
     RowBox[{"antcount", " ", 
      RowBox[{"Length", "[", "imstack", "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.817174737752763*^9, 3.8171748321265383`*^9}, {
  3.8171749696961*^9, 3.8171749950969763`*^9}, {3.8171752457027965`*^9, 
  3.8171752552913446`*^9}, {3.8171753058684874`*^9, 3.8171753071777935`*^9}, {
  3.817175477357509*^9, 3.817175549188342*^9}, {3.8171756150962095`*^9, 
  3.8171756553861895`*^9}, {3.8291810319804573`*^9, 3.829181033611994*^9}, {
  3.829186341677311*^9, 3.8291863539152317`*^9}, {3.8369990864377847`*^9, 
  3.8369990924047985`*^9}},ExpressionUUID->"307675f2-b028-4929-8194-\
274494a6fd59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"squished", "=", 
   FractionBox[
    RowBox[{"antcount", " ", "squish"}], 
    RowBox[{"Total", "@", 
     RowBox[{"Total", "@", "squish"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.817312343326089*^9, 3.8173123556724405`*^9}, {
   3.8173124977329693`*^9, 3.817312537391991*^9}, {3.822575583353858*^9, 
   3.8225755835434046`*^9}, {3.822576293952917*^9, 3.8225762944223614`*^9}, 
   3.829180720721547*^9, {3.829180776458068*^9, 3.8291807766725464`*^9}, {
   3.8291876225467815`*^9, 3.829187624352458*^9}, {3.8363918637372894`*^9, 
   3.836391867736675*^9}},ExpressionUUID->"e5559b00-3578-4181-a88c-\
4d447bdcca24"],

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{"squished", ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<Matrix plot for time integrated density\>\""}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8171748460714436`*^9, 3.8171748602659855`*^9}, {
  3.817174930801343*^9, 3.8171749331062217`*^9}, {3.817175390166092*^9, 
  3.8171753957805166`*^9}, {3.8171760898275585`*^9, 3.8171761450263085`*^9}, {
  3.817177549332816*^9, 3.8171776254166117`*^9}, {3.829224664435047*^9, 
  3.8292246711130505`*^9}, {3.829224762380042*^9, 3.8292247625370436`*^9}, {
  3.829225039177044*^9, 
  3.8292250464820433`*^9}},ExpressionUUID->"26bbf6eb-4f1a-4a23-8f35-\
6e2c3ca1fc43"]
}, Closed]],

Cell[CellGroupData[{

Cell["Figure export", "Subsection",
 CellChangeTimes->{{3.8360580323972487`*^9, 
  3.836058036557108*^9}},ExpressionUUID->"ff50c7a6-03eb-4585-a309-\
e5b21ae11fa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"ToString", "@", 
     RowBox[{"Row", "@", 
      RowBox[{"{", 
       RowBox[{"filename", ",", "\"\<out.png\>\""}], "}"}]}]}], ",", "a"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.817177627908886*^9, 3.8171776585062847`*^9}, {
  3.817177762168928*^9, 3.817177762877995*^9}, {3.8173128988511086`*^9, 
  3.8173129256908846`*^9}, {3.8179191720192275`*^9, 
  3.8179191835495605`*^9}},ExpressionUUID->"0a93fde2-cb3e-44a8-b95c-\
b840af4ead51"],

Cell[BoxData[
 RowBox[{"(*", 
  FractionBox[
   RowBox[{"antcount", " "}], 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
     "imstack", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "*)"}]], "Input",
 CellChangeTimes->{{3.8171756808012176`*^9, 
  3.8171756854952626`*^9}},ExpressionUUID->"b3ac04cd-2e39-450f-8756-\
92730083c65d"],

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8171776630401173`*^9, 
  3.8171776658057313`*^9}},ExpressionUUID->"9784e289-bb2e-4e84-b2fb-\
502f2ec92d96"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vexation", "Section",
 CellChangeTimes->{{3.8291871183796635`*^9, 
  3.8291871236700835`*^9}},ExpressionUUID->"e32d35da-2a60-4a57-8745-\
09bf1c28a55e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stackedimstack", "=", "imstack"}], ";"}]], "Input",
 CellChangeTimes->{{3.8292276968957787`*^9, 
  3.8292277041457815`*^9}},ExpressionUUID->"430a5860-49db-44ff-8d6c-\
5a04a6aebbca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"dim2", ",", "dim1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829182308290024*^9, 3.8291823416174927`*^9}, {
  3.8291823770978756`*^9, 3.829182418823389*^9}, {3.829752455026309*^9, 
  3.829752459669314*^9}, {3.8369993793198404`*^9, 3.836999383161077*^9}, {
  3.836999593830694*^9, 
  3.8369995954052353`*^9}},ExpressionUUID->"d5868928-748c-402a-891a-\
81935bc26740"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"norm", "\[LeftDoubleBracket]", 
       RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"imstack", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], 
         "antcount"], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "imstack", "]"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "dim2"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", "dim1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8291821973992014`*^9, 3.8291823027525682`*^9}, {
  3.8292239550440397`*^9, 3.8292239553320384`*^9}, {3.8292242532900443`*^9, 
  3.829224253704043*^9}, {3.8292244883830423`*^9, 3.82922449057204*^9}, {
  3.8297524625333147`*^9, 3.829752466338313*^9}, {3.8369993934983444`*^9, 
  3.8369993979061575`*^9}, {3.8369994349799767`*^9, 3.836999454713304*^9}, {
  3.836999524280653*^9, 3.8369995663270407`*^9}, {3.836999603159822*^9, 
  3.8369996121033683`*^9}},ExpressionUUID->"540e7faf-403a-424b-b24c-\
d992375f8876"],

Cell[BoxData["norm"], "Input",
 CellChangeTimes->{{3.836999527303795*^9, 
  3.836999527693309*^9}},ExpressionUUID->"a4662d84-82e4-43fd-ab40-\
b1fc7329c1bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vexation", "=", 
   RowBox[{"-", 
    RowBox[{"Log", "[", 
     RowBox[{"squished", " ", "norm"}], " ", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829182503754235*^9, 3.829182547964833*^9}, {
   3.829182814161871*^9, 3.829182814649568*^9}, {3.8291830606135798`*^9, 
   3.8291830727497115`*^9}, {3.8291832961502657`*^9, 
   3.8291832978510637`*^9}, {3.8291833296664543`*^9, 3.829183330208927*^9}, 
   3.8291845422871466`*^9},ExpressionUUID->"cb108089-54c0-4211-b629-\
1bfbd14338b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prob", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"dim2", ",", "dim1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8291829366328187`*^9, 3.8291829472070403`*^9}, {
   3.829183013222578*^9, 3.8291830144779253`*^9}, {3.8291832088914638`*^9, 
   3.8291832193474936`*^9}, {3.8291836079491596`*^9, 
   3.8291836081886997`*^9}, {3.8291845830151196`*^9, 3.829184595453209*^9}, {
   3.8292243217030544`*^9, 3.8292243611430464`*^9}, 3.829224544510041*^9, {
   3.8292249341310525`*^9, 3.829224934205043*^9}, {3.8292249846320457`*^9, 
   3.829224984755042*^9}, {3.8292250629800425`*^9, 3.8292250630650473`*^9}, {
   3.8297524854984145`*^9, 3.82975248785331*^9}, {3.8369996910681653`*^9, 
   3.8369997453463564`*^9}, 
   3.836999920088682*^9},ExpressionUUID->"d7141dc0-1684-48bf-8496-\
649835580620"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"prob", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "n"}], " ", 
          RowBox[{"vexation", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "]"}], 
        RowBox[{
         RowBox[{"norm", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"Factorial", "[", "n", "]"}]}]]}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "dim2"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "dim1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8291828319173155`*^9, 3.829182863569049*^9}, {
  3.8291828968555574`*^9, 3.8291830369503098`*^9}, {3.8291831341099973`*^9, 
  3.829183139966422*^9}, {3.829183592303367*^9, 3.8291835927184114`*^9}, {
  3.829752490908309*^9, 3.829752495659316*^9}, {3.836999702589115*^9, 
  3.8369997641013174`*^9}, {3.8369998078290176`*^9, 
  3.8369998115812116`*^9}},ExpressionUUID->"7076475d-2577-427b-b680-\
6bbc1325b7ec"],

Cell[BoxData[{
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"vexation", ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Vexation function\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"prob", ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Ant Density\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8291830201225195`*^9, 3.8291830235341253`*^9}, {
  3.8291833527144566`*^9, 3.8291833611852937`*^9}, {3.8292242017230415`*^9, 
  3.8292242068950415`*^9}, {3.8292246252960467`*^9, 3.829224643610043*^9}, {
  3.8292251059870443`*^9, 
  3.8292251064980416`*^9}},ExpressionUUID->"db9ba457-1d77-4302-8910-\
c1b61abad8e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symmetrify", "Section",
 CellChangeTimes->{{3.8292245582800426`*^9, 
  3.8292245627860417`*^9}},ExpressionUUID->"5c33b0da-c168-41ef-9b9f-\
6fadbd222df2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfa", "=", 
   RowBox[{"vexation", "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291854125257006`*^9, 
  3.8291854824893208`*^9}},ExpressionUUID->"94bba4a2-78a6-48db-be29-\
2ed1c6dbaa78"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfb", "=", 
   RowBox[{"vexation", "\[LeftDoubleBracket]", 
    RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291854289821177`*^9, 
  3.8291854863197083`*^9}},ExpressionUUID->"0e50b9f5-ebf0-41eb-bb49-\
2f52756b9fbb"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "@", 
  RowBox[{"Reverse", "[", "halfa", "]"}]}]], "Input",
 CellChangeTimes->{{3.829185495213185*^9, 
  3.829185507199355*^9}},ExpressionUUID->"fe4d8ebc-200a-4a36-ac3f-\
d371686d4569"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfsum", "=", 
   RowBox[{"halfa", "+", 
    RowBox[{"Reverse", "[", "halfb", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291855243726387`*^9, 
  3.829185567645976*^9}},ExpressionUUID->"93ae262f-9380-431b-a641-\
21e26e2de961"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"quartera", "=", 
   RowBox[{"halfsum", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", 
     RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quarterb", "=", 
   RowBox[{"halfsum", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", 
     RowBox[{"5", ";;", "8"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.829185537844808*^9, 
  3.8291856185344305`*^9}},ExpressionUUID->"76ef5e78-3b0c-4f99-b762-\
594251ca1cac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quartersum", "=", 
   RowBox[{"quartera", "+", 
    RowBox[{"Reverse", "[", 
     RowBox[{"quarterb", ",", "2"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291856071483507`*^9, 
  3.829185700068929*^9}},ExpressionUUID->"3b146a70-6f55-4fc9-a431-\
bfd9c847de35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unfold", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "8"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829185730033498*^9, 
  3.829185770827197*^9}},ExpressionUUID->"9c765b69-c9be-4c64-a812-\
a68f73fcbd36"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], 
             RowBox[{"Quotient", "[", 
              RowBox[{"i", ",", "5"}], "]"}]}], ")"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "5"}], "]"}]}], "]"}], ",", "5"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], 
             RowBox[{"Quotient", "[", 
              RowBox[{"j", ",", "5"}], "]"}]}], ")"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"j", ",", "5"}], "]"}]}], "]"}], ",", "5"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unfold", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
       FractionBox[
        RowBox[{"quartersum", "\[LeftDoubleBracket]", 
         RowBox[{"a", ",", "b"}], "\[RightDoubleBracket]"}], "4."]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.829185777928186*^9, 3.829185821747057*^9}, {
  3.829185863522828*^9, 3.829185917666819*^9}, {3.8291859928339434`*^9, 
  3.829186027400282*^9}, {3.829186249531172*^9, 3.8291862640206614`*^9}, {
  3.829186491564148*^9, 
  3.8291864927688723`*^9}},ExpressionUUID->"ca0a9703-89ca-47bd-9a0c-\
e0676a4f01d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfa1", "=", 
   RowBox[{"norm", "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291854125257006`*^9, 3.8291854824893208`*^9}, {
  3.8292274007656612`*^9, 
  3.8292274060306683`*^9}},ExpressionUUID->"f03672bf-518f-4350-88f6-\
949a9297df72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfb1", "=", 
   RowBox[{"norm", "\[LeftDoubleBracket]", 
    RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291854289821177`*^9, 3.8291854863197083`*^9}, {
  3.829227401398666*^9, 
  3.8292274114142513`*^9}},ExpressionUUID->"9f4dc3fe-95e7-424f-b885-\
2cd38a100c3b"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "@", 
  RowBox[{"Reverse", "[", "norm", "]"}]}]], "Input",
 CellChangeTimes->{{3.829185495213185*^9, 3.829185507199355*^9}, {
  3.829227414646244*^9, 
  3.8292274150142536`*^9}},ExpressionUUID->"51a5b656-849d-4cf1-9ea2-\
8eb9dc361642"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfsum1", "=", 
   RowBox[{"halfa1", "+", 
    RowBox[{"Reverse", "[", "halfb1", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291855243726387`*^9, 3.829185567645976*^9}, {
  3.829227417854258*^9, 
  3.8292274202702446`*^9}},ExpressionUUID->"d0315421-3054-4266-a90f-\
f8e1aff82d15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"quartera1", "=", 
   RowBox[{"halfsum1", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", 
     RowBox[{"1", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quarterb1", "=", 
   RowBox[{"halfsum1", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", 
     RowBox[{"5", ";;", "8"}]}], "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.829185537844808*^9, 3.8291856185344305`*^9}, {
  3.8292274216072454`*^9, 
  3.8292274238452435`*^9}},ExpressionUUID->"4a0d0a79-a25a-4f48-bf04-\
52fa7f5da334"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quartersum1", "=", 
   RowBox[{"quartera1", "+", 
    RowBox[{"Reverse", "[", 
     RowBox[{"quarterb1", ",", "2"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8291856071483507`*^9, 3.829185700068929*^9}, {
  3.8292274248152475`*^9, 
  3.8292274273182526`*^9}},ExpressionUUID->"d175312b-7058-4313-abc0-\
bb4bee2dbfa6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"unfoldnorm", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "8"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.829185730033498*^9, 3.829185770827197*^9}, {
  3.829227430966264*^9, 
  3.829227431357255*^9}},ExpressionUUID->"0b264721-bb42-458a-806e-\
a5d3ba6f99af"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], 
             RowBox[{"Quotient", "[", 
              RowBox[{"i", ",", "5"}], "]"}]}], ")"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "5"}], "]"}]}], "]"}], ",", "5"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "9"}], 
             RowBox[{"Quotient", "[", 
              RowBox[{"j", ",", "5"}], "]"}]}], ")"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"j", ",", "5"}], "]"}]}], "]"}], ",", "5"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unfoldnorm", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
       FractionBox[
        RowBox[{"quartersum1", "\[LeftDoubleBracket]", 
         RowBox[{"a", ",", "b"}], "\[RightDoubleBracket]"}], "4."]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.829185777928186*^9, 3.829185821747057*^9}, {
  3.829185863522828*^9, 3.829185917666819*^9}, {3.8291859928339434`*^9, 
  3.829186027400282*^9}, {3.829186249531172*^9, 3.8291862640206614`*^9}, {
  3.829186491564148*^9, 3.8291864927688723`*^9}, {3.82922743875924*^9, 
  3.829227441399253*^9}},ExpressionUUID->"4a62c023-1d11-4f6f-a7a5-\
09e38cd2cd45"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"unfold", ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Vexation symmetrized\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8291862703062677`*^9, 3.8291862736841364`*^9}, {
  3.8291864117478933`*^9, 3.8291864329293966`*^9}, {3.8291865001138496`*^9, 
  3.8291865002965326`*^9}, {3.8292271232876625`*^9, 
  3.829227137194674*^9}},ExpressionUUID->"64a3db8b-86c3-47f9-b33a-\
651bab4a2682"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prob", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "8"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8291829366328187`*^9, 3.8291829472070403`*^9}, {
  3.829183013222578*^9, 3.8291830144779253`*^9}, {3.8291832088914638`*^9, 
  3.8291832193474936`*^9}, {3.8291836079491596`*^9, 3.8291836081886997`*^9}, {
  3.8291845830151196`*^9, 3.829184595453209*^9}, {3.829227334159665*^9, 
  3.829227334294663*^9}},ExpressionUUID->"fbf01093-dcd6-4f28-b2e0-\
6be358220843"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"prob", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "n"}], " ", 
          RowBox[{"unfold", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "]"}], 
        RowBox[{
         RowBox[{"unfoldnorm", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"Factorial", "[", "n", "]"}]}]]}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8291828319173155`*^9, 3.829182863569049*^9}, {
  3.8291828968555574`*^9, 3.8291830369503098`*^9}, {3.8291831341099973`*^9, 
  3.829183139966422*^9}, {3.829183592303367*^9, 3.8291835927184114`*^9}, {
  3.829186561464221*^9, 3.8291865620000324`*^9}, {3.8292274520982485`*^9, 
  3.8292274533582478`*^9}},ExpressionUUID->"3bd54a76-a380-444d-8991-\
9478d5e36c8b"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"prob", ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Density Symmetrized\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8291830201225195`*^9, 3.8291830235341253`*^9}, {
  3.8291833527144566`*^9, 3.8291833611852937`*^9}, {3.8292243958220615`*^9, 
  3.8292244013510437`*^9}, {3.8292245708610535`*^9, 3.829224572505041*^9}, {
  3.829227485649251*^9, 
  3.829227492413249*^9}},ExpressionUUID->"dc78d7bb-6980-451d-8eea-\
61b92909c500"]
}, Closed]],

Cell[CellGroupData[{

Cell["Frustration", "Section",
 CellChangeTimes->{{3.8291871278063636`*^9, 
  3.829187129326099*^9}},ExpressionUUID->"dc4536a2-498b-4d29-a2ab-\
9099b15407c0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Needs", " ", "large", " ", "number", " ", "of", " ", "ants"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8291871328771114`*^9, 
  3.8291871386548758`*^9}},ExpressionUUID->"bf3fb03a-9afa-43b5-bf4b-\
55530f307a44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"probf", "=", 
     RowBox[{"HistogramList", "[", 
      RowBox[{"timesquish", ",", 
       RowBox[{"{", "0.001", "}"}], ",", "\"\<PDF\>\""}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"probf", "=", 
     RowBox[{"HistogramList", "[", 
      RowBox[{
       RowBox[{"normfactor", " ", 
        RowBox[{"Flatten", "@", "imstack"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "13", ",", "1"}], "}"}], ",", "\"\<PDF\>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"probf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "=", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{
       "probf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8291873393429813`*^9, 3.8291874399627247`*^9}, {
  3.829187481241928*^9, 3.8291875056188774`*^9}, {3.829187943685794*^9, 
  3.8291879725392323`*^9}, {3.8292133001144714`*^9, 3.8292133496537848`*^9}, {
  3.8292133913837852`*^9, 3.829213393573786*^9}, {3.8292134317347817`*^9, 
  3.829213490324789*^9}, {3.8292136152767887`*^9, 3.8292137015927863`*^9}, {
  3.8292162640046377`*^9, 3.829216300681633*^9}, {3.829752919336214*^9, 
  3.8297529364772143`*^9}, {3.8297530623370333`*^9, 3.829753065186035*^9}, {
  3.8360562707220955`*^9, 3.8360562718412933`*^9}, {3.8360581700244093`*^9, 
  3.836058173288864*^9}},ExpressionUUID->"33b46885-3b62-4983-a852-\
f6cb49556f82"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"frustration", "[", 
    RowBox[{"n_", ",", "pn_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "vexation"}], " ", "n"}], " ", "-", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"norm", " ", 
      RowBox[{"Factorial", "[", "n", "]"}], " ", "pn"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8291872078935785`*^9, 3.829187294379782*^9}, {
  3.82918798748175*^9, 3.829188012522279*^9}, {3.8291880458180337`*^9, 
  3.8291880625698676`*^9}, {3.8292139209337997`*^9, 
  3.8292139464218025`*^9}},ExpressionUUID->"e993c4f1-19dd-42a8-b320-\
c628f655b278"],

Cell[BoxData[
 RowBox[{"ListPlot", "@", 
  RowBox[{"(", 
   RowBox[{"probf", "\[Transpose]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8292133550057845`*^9, 
  3.829213369918787*^9}},ExpressionUUID->"98eabace-7342-4dba-ad98-\
02cdf2934139"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"frustrray", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"probf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
     "frustrray", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"probf", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "n"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"Mean", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"frustration", "[", 
          RowBox[{
           RowBox[{"probf", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "n"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"probf", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "n"}], "\[RightDoubleBracket]"}]}], "]"}]}]}]}],
       "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", 
     RowBox[{"Length", "[", "frustrray", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8292140547237997`*^9, 3.8292141617463093`*^9}, {
  3.829215840829644*^9, 
  3.829215871361628*^9}},ExpressionUUID->"ecba87d9-3846-40b9-bb9d-\
93511ce26567"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"frustrray", ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Frustration\>\""}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<N\>\"", ",", "\"\<Frustration\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8292141657463136`*^9, 3.8292141726103244`*^9}, {
  3.829228706078289*^9, 
  3.829228736386279*^9}},ExpressionUUID->"f1187a7b-2d95-401b-93b1-\
702b9a6fb4e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Set", " ", "local", " ", "parameters", " ", "for", " ", "plotting"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"normfactor", " ", 
        RowBox[{"Flatten", "@", "imstack"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"samplesize", "=", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"flatten", "=", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"axesLabel", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Number of ants\>\"", ",", "\"\<PDF\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"angularticks", "=", "True"}], ",", "\[IndentingNewLine]", 
      "range", ",", " ", "ticks", ",", " ", "err", ",", " ", "dist", ",", " ",
       "hist", ",", " ", "len", ",", " ", "errors", ",", 
      "\[IndentingNewLine]", "bincounts", ",", " ", "binwidth", ",", " ", 
      "copy", ",", " ", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bincounts", "=", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"Max", "@", "data"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Modify", " ", "structure", " ", "of", " ", "data", " ", "and", " ", 
       "set", " ", "up", " ", "plotting", " ", "parameters"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"samplesize", "+=", 
        RowBox[{"Length", "[", 
         RowBox[{
         "data", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"samplesize", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"samplesize", "=", 
        RowBox[{"Length", "[", "data", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"flatten", ",", 
       RowBox[{"data", "=", 
        RowBox[{"Flatten", "[", "data", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"range", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "data", "]"}], ",", 
        RowBox[{"Max", "[", "data", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"angularticks", ",", "\[IndentingNewLine]", 
       RowBox[{"ticks", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Max", "[", "data", "]"}], ",", "1"}], "]"}], ",", 
          "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ticks", "=", "Automatic"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"err", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"err", ",", 
          RowBox[{"ErrorBar", "[", 
           RowBox[{
            FractionBox["1.", 
             RowBox[{
              RowBox[{
              "range", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
               "-", 
              RowBox[{
              "range", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]], ",", 
            FractionBox["1", 
             RowBox[{"Sqrt", "[", "samplesize", "]"}]]}], "]"}]}], "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "10"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Generate", " ", "basic", " ", "plots", " ", "using", " ", "the", " ", 
       "configs"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dist", "=", 
      RowBox[{"SmoothKernelDistribution", "[", "data", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Generate", " ", "histogrambins", " ", "for", " ", "further", " ", 
       "analysis"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hist", "=", 
      RowBox[{"HistogramList", "[", 
       RowBox[{"data", ",", 
        RowBox[{"{", 
         FractionBox[
          RowBox[{"Max", "[", "data", "]"}], "bincounts"], "}"}], ",", 
        "\"\<PDF\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"hist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"errors", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"temp", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"hist", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], "+", 
             RowBox[{"hist", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", 
               RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ")"}], 
           "/", "2."}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"binwidth", "=", 
         FractionBox[
          RowBox[{"Max", "[", "data", "]"}], "bincounts"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"errors", ",", 
          RowBox[{"ErrorBar", "[", 
           RowBox[{
            FractionBox["binwidth", "2."], ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"hist", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], 
              FractionBox[
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"hist", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], 
                  "binwidth"}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", "data", "]"}], "binwidth"}], ")"}]]}],
              "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "hist", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"hist", "=", 
      RowBox[{"{", 
       RowBox[{"temp", ",", 
        RowBox[{
        "hist", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"copy", "=", 
      RowBox[{"hist", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coopy", "=", "hist"}], ";", "\[IndentingNewLine]", 
     RowBox[{"hist", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"hist", "\[Transpose]"}], ",", "errors"}], "]"}], ",", 
        "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Generate", " ", "Error", " ", "analysis", " ", "and", " ", "symmetry", 
       " ", "analysis", " ", "plots"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"antcountErrorPlot", "=", 
      RowBox[{"ErrorListPlot", "[", 
       RowBox[{"hist", ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"1.05", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Max", "[", "data", "]"}], "+", "1"}], ")"}]}]}], 
            "}"}], ",", "Full"}], "}"}]}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", "axesLabel"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<Histogram of Ant count (With error bars)\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "0", "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.829222929070041*^9, 3.82922297323304*^9}, {
   3.829223029937046*^9, 3.8292231743230457`*^9}, {3.82922327447904*^9, 
   3.8292233141330423`*^9}, {3.829223379586058*^9, 3.8292234092490544`*^9}, {
   3.829223465059047*^9, 3.829223522553043*^9}, {3.829223606010042*^9, 
   3.8292236438150434`*^9}, {3.82922367964005*^9, 3.82922370886106*^9}, {
   3.829223765883045*^9, 3.8292237872920475`*^9}, {3.829223902050044*^9, 
   3.82922392031704*^9}, {3.8292278184607873`*^9, 3.8292278257827754`*^9}, {
   3.829227878641781*^9, 3.8292278927017784`*^9}, 3.8292279278057775`*^9, {
   3.829227959454776*^9, 3.8292279598477798`*^9}, {3.8292280057421417`*^9, 
   3.8292280423380737`*^9}, {3.8292281269117994`*^9, 
   3.8292281668790293`*^9}, {3.829753082786031*^9, 3.82975308454403*^9}, {
   3.8364699399100733`*^9, 3.836469951653946*^9}, {3.8364737467091017`*^9, 
   3.836473760894101*^9}, {3.836477722839466*^9, 
   3.8364777402221575`*^9}},ExpressionUUID->"dba6a5f3-ddca-4081-b8d9-\
886d24418fe2"],

Cell[BoxData["antcountErrorPlot"], "Input",
 CellChangeTimes->{{3.8292234160860415`*^9, 3.829223417097042*^9}, {
  3.8292234928220577`*^9, 
  3.829223495050045*^9}},ExpressionUUID->"388589fb-0247-4ff3-a60e-\
b77ae2888403"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frustprob", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"m", "!"}]], 
    FractionBox["1", "norm"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Exp", "[", 
        RowBox[{"-", "vexation"}], "]"}], "m"], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"frustrray", "\[LeftDoubleBracket]", 
         RowBox[{"m", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8292290102410717`*^9, 3.829229098036065*^9}, {
  3.8292291326150713`*^9, 3.829229152980974*^9}, {3.8292292106939793`*^9, 
  3.8292292346769743`*^9}},ExpressionUUID->"b76e8021-bdf6-4d3e-a110-\
aa9cd8ace617"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"frustprob", ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.82922915669199*^9, 3.82922916955997*^9}, {
  3.8292292167409735`*^9, 
  3.829229229323979*^9}},ExpressionUUID->"33d6460c-4554-43ae-9aaf-\
677306bc5112"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hypothesis testing", "Section",
 CellChangeTimes->{{3.836055679193564*^9, 
  3.8360556874998255`*^9}},ExpressionUUID->"9a4c4e5f-947c-4660-8317-\
3d8015312ce4"],

Cell[CellGroupData[{

Cell["pseudo-free energy", "Subsection",
 CellChangeTimes->{{3.83605569103644*^9, 
  3.836055695196907*^9}},ExpressionUUID->"2d3804c0-2d68-4a41-a864-\
7f70484a3a53"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pfe", "[", 
    RowBox[{"b1_", ",", "b2_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"n", "!"}], 
      RowBox[{
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"normfactor", " ", 
          RowBox[{"imstack", "\[LeftDoubleBracket]", 
           RowBox[{";;", ",", "b1", ",", "b2"}], "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.5"}], ",", "12.5", ",", "1"}], "}"}], ",", 
         "\"\<PDF\>\""}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", 
        RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8360557232255177`*^9, 3.836055785795323*^9}, {
  3.8360558174122543`*^9, 3.836055832991214*^9}, {3.8360560516771717`*^9, 
  3.8360560905011597`*^9}, {3.8360562999446154`*^9, 3.8360563151318398`*^9}, {
  3.8360569032288475`*^9, 3.8360569180779085`*^9}, {3.836056991687669*^9, 
  3.8360569937933893`*^9}, {3.836057034515998*^9, 3.8360570388909388`*^9}, {
  3.8360570722052417`*^9, 3.8360570724192686`*^9}, {3.8360571256746798`*^9, 
  3.836057159160544*^9}, {3.8360572045407686`*^9, 3.836057206644144*^9}, {
  3.836058273956545*^9, 
  3.8360582756442413`*^9}},ExpressionUUID->"547fe574-481f-46a3-8426-\
649c4df5c963"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "12", ",", "1"}], "]"}], ",", 
          RowBox[{"pfe", "[", 
           RowBox[{"i", ",", "j", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "12", ",", "1"}], "]"}]}], "]"}]}], "}"}], 
        "\[Transpose]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim1"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Pseudo-free energy vs N\>\""}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(N\), \(b\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(b\)]\)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.836056323970257*^9, 3.8360563538690314`*^9}, {
   3.8360569220320406`*^9, 3.836056955238921*^9}, {3.836057014974862*^9, 
   3.8360570704770184`*^9}, {3.8360571647384768`*^9, 
   3.8360571653872375`*^9}, {3.83605721591277*^9, 3.8360572199272223`*^9}, {
   3.836057285823138*^9, 3.8360573899608135`*^9}, 3.8360574483438797`*^9, {
   3.8360574868009405`*^9, 3.8360574931926003`*^9}, {3.836057785128315*^9, 
   3.83605782913706*^9}, {3.836058422168773*^9, 3.836058460024795*^9}, {
   3.836058610694541*^9, 3.836058647677209*^9}, {3.836058677726735*^9, 
   3.8360586778943396`*^9}, {3.8360587488242164`*^9, 
   3.8360587492091627`*^9}, {3.8360623513711185`*^9, 
   3.8360623766576014`*^9}, {3.8369980399664335`*^9, 3.836998042921011*^9}, {
   3.8370000128644595`*^9, 
   3.837000024871333*^9}},ExpressionUUID->"a57da058-d469-4ed5-8393-\
08d947945fd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Set", " ", "local", " ", "parameters", " ", "for", " ", "plotting"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"datastack", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "12", ",", "1"}], "]"}], ",", 
             RowBox[{"pfe", "[", 
              RowBox[{"i", ",", "j", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "12", ",", "1"}], "]"}]}], "]"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "dim2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "dim1"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"samplesize", "=", "500"}], ",", "\[IndentingNewLine]", 
      RowBox[{"axesLabel", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<Number of ants\>\"", ",", "\"\<PDF\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"angularticks", "=", "True"}], ",", "\[IndentingNewLine]", 
      "data", ",", "range", ",", "ticks", ",", "dist", ",", "len", ",", 
      "errors", ",", "\[IndentingNewLine]", "bincounts", ",", " ", "binwidth",
       ",", 
      RowBox[{"plottable", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bincounts", "=", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"Max", "@", "data"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"datastack", "\[LeftDoubleBracket]", 
          RowBox[{"n", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Generate", " ", "Horizontal", " ", "error", " ", "bars"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"range", "=", 
         RowBox[{"datastack", "\[LeftDoubleBracket]", 
          RowBox[{"n", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Generate", " ", "vertical", " ", "error", " ", "bars"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"errors", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"binwidth", "=", 
            RowBox[{
             RowBox[{
             "range", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "-", 
             RowBox[{
             "range", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nnnn", "=", "binwidth"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errors", ",", 
             RowBox[{"ErrorBar", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"Abs", "@", 
                  RowBox[{
                  "data", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], 
                 FractionBox[
                  RowBox[{"(", 
                   RowBox[{"antcount", "-", 
                    RowBox[{
                    RowBox[{"Abs", "@", 
                    RowBox[{
                    "data", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "binwidth"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"samplesize", " ", "binwidth"}], ")"}]]}], "]"}]}],
               "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "data"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"plottable", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"range", ",", "data"}], "}"}], "\[Transpose]"}], ",", 
             "errors"}], "}"}], "\[Transpose]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "datastack", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"copy", "=", "plottable"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Generate", " ", "Error", " ", "analysis", " ", "and", " ", "symmetry", 
       " ", "analysis", " ", "plots"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pfeErrorPlot", "=", 
      RowBox[{"ErrorListPlot", "[", 
       RowBox[{
        RowBox[{"plottable", "\[LeftDoubleBracket]", 
         RowBox[{"12", ";;", "28"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", "axesLabel"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<Histogram of Ant count (With error bars)\>\""}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "0", "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mirror", "=", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"copy", "\[Transpose]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"Reverse", "[", 
         RowBox[{
          RowBox[{"copy", "\[Transpose]"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], "]"}], ";"}]}]}]}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"pfefrustrationErrorPlot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               RowBox[{"copy", "\[Transpose]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{"copy", "\[Transpose]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "}"}], "\[Transpose]"}], ",", 
          "copy"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "Automatic"}], "}"}], ",", "Full"}], "}"}]}], 
        ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<Left-Right comparison for angular velocity distribution\>\""}], 
        ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Left\>\"", ",", "\"\<Right\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "700"}], ",", 
        RowBox[{"Ticks", "\[Rule]", "ticks"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Angular velocity (rad/s)\>\"", ",", " ", "\"\<PDF\>\""}], 
          "}"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", "pfeErrorPlot"}], "Input",
 CellChangeTimes->{{3.829222929070041*^9, 3.82922297323304*^9}, {
   3.829223029937046*^9, 3.8292231743230457`*^9}, {3.82922327447904*^9, 
   3.8292233141330423`*^9}, {3.829223379586058*^9, 3.8292234092490544`*^9}, {
   3.829223465059047*^9, 3.829223522553043*^9}, {3.829223606010042*^9, 
   3.8292236438150434`*^9}, {3.82922367964005*^9, 3.82922370886106*^9}, {
   3.829223765883045*^9, 3.8292237872920475`*^9}, {3.829223902050044*^9, 
   3.82922392031704*^9}, {3.8292278184607873`*^9, 3.8292278257827754`*^9}, {
   3.829227878641781*^9, 3.8292278927017784`*^9}, 3.8292279278057775`*^9, {
   3.829227959454776*^9, 3.8292279598477798`*^9}, {3.8292280057421417`*^9, 
   3.8292280423380737`*^9}, {3.8292281269117994`*^9, 
   3.8292281668790293`*^9}, {3.829753082786031*^9, 3.82975308454403*^9}, {
   3.8364699399100733`*^9, 3.836469951653946*^9}, 3.8364700235081973`*^9, {
   3.836470119363357*^9, 3.836470194549461*^9}, {3.836470225699463*^9, 
   3.8364702833493023`*^9}, {3.8364703835896*^9, 3.836470470531412*^9}, 
   3.8364705157565365`*^9, {3.83647069234083*^9, 3.836470692431855*^9}, {
   3.8364707314029226`*^9, 3.836470741516466*^9}, {3.8364708707511377`*^9, 
   3.8364708912397976`*^9}, {3.8364737685751*^9, 3.836473794557424*^9}, {
   3.836474956684506*^9, 3.836474965423506*^9}, {3.8364750774508066`*^9, 
   3.836475101647374*^9}, {3.8364753520906715`*^9, 3.836475361376487*^9}, {
   3.836475514058866*^9, 3.8364755969186387`*^9}, {3.8364756538868837`*^9, 
   3.8364757110824594`*^9}, {3.836475763179705*^9, 3.836475806025432*^9}, {
   3.836475921671743*^9, 3.83647601358134*^9}, 3.836476115550871*^9, {
   3.8364761524942007`*^9, 3.8364761623888507`*^9}, {3.836476342553376*^9, 
   3.8364763934313526`*^9}, {3.8364764518955765`*^9, 3.836476480550199*^9}, {
   3.8364765595160656`*^9, 3.8364765817722607`*^9}, {3.836477140365054*^9, 
   3.836477156035475*^9}, {3.836477291492957*^9, 3.836477329039826*^9}, {
   3.8364773650583954`*^9, 3.836477490735112*^9}, {3.836477557901315*^9, 
   3.836477559325322*^9}, {3.8364778263950605`*^9, 3.8364778462905226`*^9}, {
   3.8364778767208056`*^9, 3.8364778863456225`*^9}, {3.8364779238214655`*^9, 
   3.836477966143796*^9}, {3.8364780154272156`*^9, 3.8364780210380116`*^9}, {
   3.836478114378083*^9, 3.8364781439252157`*^9}, 3.8364862931730433`*^9, {
   3.8364865010626264`*^9, 3.83648650563898*^9}, {3.836486668027583*^9, 
   3.836486668827837*^9}, 3.8364867075012956`*^9, {3.836486740700659*^9, 
   3.8364867479488444`*^9}, {3.8364867966645813`*^9, 
   3.8364868227834716`*^9}, {3.836998055103303*^9, 3.8369980579509363`*^9}, {
   3.837000036881589*^9, 3.837000038154009*^9}, {3.83700021248473*^9, 
   3.8370005270974317`*^9}, {3.837000579592677*^9, 3.8370010376831865`*^9}, {
   3.8370010832251625`*^9, 3.8370011607765336`*^9}, {3.837001195824603*^9, 
   3.8370012615665035`*^9}, {3.837001298455512*^9, 3.837001365797952*^9}, {
   3.8370013972451925`*^9, 3.837001667032569*^9}, {3.837158125171073*^9, 
   3.8371581298817124`*^9}, {3.837272347255079*^9, 
   3.8372723716207356`*^9}},ExpressionUUID->"898700b6-8023-495f-9747-\
af08a5aa3dbc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{
    RowBox[{"HistogramList", "[", 
     RowBox[{
      RowBox[{"normfactor", " ", 
       RowBox[{"imstack", "\[LeftDoubleBracket]", 
        RowBox[{";;", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "12.5", ",", "1"}], "}"}], ",", 
      "\"\<PDF\>\""}], "]"}], "\[LeftDoubleBracket]", "2", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"check", ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Ant count distribution\>\""}], ",", 
   RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Number of ants in a bin\>\"", ",", " ", "\"\<Probability\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.836056664078127*^9, 3.836056703369358*^9}, {
   3.8360567610714364`*^9, 3.8360568302484894`*^9}, 3.836056892806363*^9, {
   3.836056942756831*^9, 3.8360569442840176`*^9}, {3.8360569808296337`*^9, 
   3.836056982429756*^9}, {3.8360570574164004`*^9, 3.836057061624161*^9}, {
   3.8360582825888553`*^9, 3.8360582837881985`*^9}, {3.836058504483066*^9, 
   3.836058509465469*^9}, {3.836058559835446*^9, 3.836058597251619*^9}, 
   3.8363903055650167`*^9, {3.836392009119561*^9, 
   3.836392086958908*^9}},ExpressionUUID->"40c036d7-643a-4658-b0b8-\
e9c33f2736d3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   SubscriptBox["f", "b"], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ln"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"N", "!"}], "P", 
       RowBox[{"(", "N", ")"}]}], ")"}]}], " ", "-", " ", 
    RowBox[{
     SubscriptBox["v", "b"], "N"}], " ", "-", " ", 
    RowBox[{"ln", 
     RowBox[{"(", 
      SubscriptBox["z", "b"], ")"}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8371570762819996`*^9, 
  3.837157114981887*^9}},ExpressionUUID->"af749cc2-0dad-4302-a31a-\
afb3a5b353ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fN", "[", 
    RowBox[{"i_", ",", "j_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"pfe", "[", 
     RowBox[{"i", ",", "j", ",", "n"}], "]"}], "-", 
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"vexation", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "n"}], "+", 
      RowBox[{"Log", "[", " ", 
       RowBox[{"norm", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8360575508841114`*^9, 3.836057623315864*^9}, {
  3.836059040183312*^9, 3.8360590495744934`*^9}, {3.8360590975852046`*^9, 
  3.8360591083128295`*^9}, {3.8360591388744*^9, 3.836059163937969*^9}, {
  3.837001716022044*^9, 
  3.8370017174460335`*^9}},ExpressionUUID->"c4410617-7cb4-4944-9da8-\
605f6e225711"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "12", ",", "1"}], "]"}], ",", 
          RowBox[{"fN", "[", 
           RowBox[{"i", ",", "j", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "12", ",", "1"}], "]"}]}], "]"}]}], "}"}], 
        "\[Transpose]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim1"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Frustration from PFE vs N\>\""}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(N\), \(b\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(f\), SubscriptBox[\(N\), \(b\)]]\)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "6.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "22"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8360573997795544`*^9, 3.8360574317216616`*^9}, 
   3.836057514753871*^9, 3.8360575451930804`*^9, {3.836057628572084*^9, 
   3.8360576387633467`*^9}, {3.8360576779614534`*^9, 
   3.8360577141113524`*^9}, {3.836057874689924*^9, 3.8360579249880495`*^9}, {
   3.836058776428753*^9, 3.8360588084595037`*^9}, {3.8360623832123632`*^9, 
   3.836062395763726*^9}, {3.8369980849280777`*^9, 3.836998099862752*^9}, {
   3.83700005030583*^9, 3.8370000517145414`*^9}, {3.8371568540157824`*^9, 
   3.8371568968606963`*^9}, {3.8371573951339555`*^9, 3.837157401980454*^9}, {
   3.8372724024011974`*^9, 
   3.8372724170939837`*^9}},ExpressionUUID->"81b1ab8e-ca75-40dc-b8b3-\
ad5001b677e0"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8371621845078144`*^9, 
  3.837162184517828*^9}},ExpressionUUID->"5277429b-daaa-45c5-8209-\
7b407d675eca"],

Cell[BoxData[
 RowBox[{"$Aborted", "[", "]"}]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.836998074332957*^9, 
  3.836998076514945*^9}},ExpressionUUID->"295cc952-43e1-404f-8eef-\
2a74523b714a"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"3\\\", \\\",\\\", \\\"4\\\", \\\",\\\", \\\"5\\\", \
\\\",\\\", \\\"6\\\", \\\",\\\", \\\"7\\\", \\\",\\\", \\\"8\\\", \\\",\\\", \
\\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"11\\\", \\\",\\\", \
\\\"12\\\", \\\",\\\", \\\"13\\\"}], \\\"}\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\
\\\", RowBox[{RowBox[{\\\"-\\\", \\\"0.5`\\\"}], \\\",\\\", \\\"12.5`\\\", \\\
\",\\\", \\\"1\\\"}], \\\"}\\\"}]\\) does not exist.\"",2,90,10,
   27552282261005422506,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.836998074662955*^9},ExpressionUUID->"e73bba26-0402-4728-bda9-\
12870bef00c3"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,90,11,27552282261005422506,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8369980749759474`*^9},ExpressionUUID->"4082fdef-a85d-4f9e-9845-\
5100381406d2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filename", "=", "\"\<Trial_Data/vmle\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importdir", "=", "matdir"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vexcheck", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"ToString", "@", 
      RowBox[{"Row", "@", 
       RowBox[{"{", 
        RowBox[{"importdir", ",", "filename", ",", "\"\<.mat\>\""}], 
        "}"}]}]}], ",", "\"\<Data\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.837002372671324*^9, 3.8370023955226483`*^9}, {
  3.837002514737768*^9, 
  3.837002516017602*^9}},ExpressionUUID->"a9b88362-133a-4139-ba3e-\
d2812291116d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vexcheck", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "vexcheck"}], ",", "24"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.837002412371376*^9, 3.8370024299689436`*^9}, {
  3.8370025116888523`*^9, 
  3.83700253910161*^9}},ExpressionUUID->"cfd2d15f-9cfd-4f1c-b421-\
39ba8efcbbe1"],

Cell[BoxData[
 RowBox[{"GraphicsColumn", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MatrixPlot", "[", 
     RowBox[{"vexcheck", ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", " ", "False"}]}], "]"}], ",", 
    RowBox[{"MatrixPlot", "[", 
     RowBox[{"vexation", ",", 
      RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", " ", "False"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8370024417592597`*^9, 3.8370024780901823`*^9}, {
  3.83700253042943*^9, 3.837002532183346*^9}, {3.8372704167679386`*^9, 
  3.837270464837457*^9}, {3.8372704997649946`*^9, 3.8372706470794964`*^9}, {
  3.837270682124503*^9, 3.8372708824577904`*^9}, {3.837270919641692*^9, 
  3.8372709476264124`*^9}},ExpressionUUID->"4bdabbe9-a0be-4e14-875c-\
116689ee0f9d"],

Cell[BoxData[
 RowBox[{"Total", "@", 
  RowBox[{"Total", "@", "vexcheck"}]}]], "Input",
 CellChangeTimes->{{3.8370024707490635`*^9, 3.837002471559925*^9}, {
  3.837271261149737*^9, 
  3.8372712664220157`*^9}},ExpressionUUID->"4e3c977d-5198-4e61-a341-\
85477a09c418"],

Cell[BoxData[
 RowBox[{"Total", "@", "vexation"}]], "Input",
 CellChangeTimes->{{3.837271267872139*^9, 3.837271271984689*^9}, {
  3.838374483437127*^9, 
  3.838374488870246*^9}},ExpressionUUID->"798e1c2f-e1f0-46c9-b786-\
841737095535"],

Cell[BoxData[
 RowBox[{"Log", "@", "norm"}]], "Input",
 CellChangeTimes->{{3.837157009012007*^9, 
  3.837157035111458*^9}},ExpressionUUID->"f28379b9-dc23-401a-a980-\
de6184f8b3bb"],

Cell[BoxData["vexation"], "Input",
 CellChangeTimes->{{3.8371572931528273`*^9, 
  3.837157348115*^9}},ExpressionUUID->"529630d3-282e-43ef-8203-a05d86b5dccc"],

Cell[BoxData["vexcheck"], "Input",
 CellChangeTimes->{{3.8371573005925922`*^9, 
  3.837157302742489*^9}},ExpressionUUID->"004e3d7f-d104-4cc5-bf3e-\
77655896bdfd"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Maximum Likelihood Estimation method (MLE)", "Subchapter",
 CellChangeTimes->{{3.837176715204564*^9, 
  3.8371767345070324`*^9}},ExpressionUUID->"6d03133b-bf81-42b2-890e-\
2d5e8bf91c47"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Outline", ".", "\[IndentingNewLine]", "Find"}], " ", "the", " ",
      "minimum", " ", "of", " ", "g", 
     RowBox[{"(", 
      RowBox[{"Vex", ",", "Frus"}], ")"}]}], "=", 
    RowBox[{
     RowBox[{"-", "log"}], 
     RowBox[{"(", 
      RowBox[{"P", 
       RowBox[{"(", 
        RowBox[{"V", ",", 
         RowBox[{"f", "|", "Data"}]}], ")"}]}], ")"}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"using", " ", "preconditioned", " ", "conjugate", " ", 
     RowBox[{"gradient", ".", " ", "The"}], " ", "arguments", " ", "of", " ", 
     "g", 
     RowBox[{"(", 
      RowBox[{"V", ",", "F"}], ")"}], " ", "at", " ", "the", " ", "minimum", 
     " ", "gives", " ", "us", " ", "the", " ", "maximum", " ", "likelihood", 
     " ", "estimates", " ", "for", " ", "the", " ", "parameters", " ", "used",
      " ", "for", " ", "the", " ", 
     RowBox[{"model", ".", " ", "The"}], " ", "values", " ", "F", 
     RowBox[{"(", "0", ")"}], " ", "and", " ", "F", 
     RowBox[{"(", "1", ")"}], " ", "are", " ", "constrained", " ", "at", " ", 
     "0", " ", "so", " ", "that", " ", "the", " ", "covariance", " ", 
     "matrix", " ", "is", " ", "non"}], "-", "singular"}], ",", " ", 
   RowBox[{
   "and", " ", "there", " ", "is", " ", "asymptotic", " ", "limit", " ", 
    "for", " ", "distribution", " ", "of", " ", 
    RowBox[{"estimators", ".", "\[IndentingNewLine]", 
     RowBox[{"Source", ":", "\[IndentingNewLine]", 
      RowBox[{"Pseudocode", " ", "published", " ", "by"}]}]}]}]}], " ", 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.8371768343830495`*^9, 
  3.837177007128275*^9}},ExpressionUUID->"6bcb3a87-a4d8-491d-81d3-\
13c28e583444"],

Cell[CellGroupData[{

Cell["Function calls", "Section",
 CellChangeTimes->{{3.8375979107470894`*^9, 
  3.8375979134193783`*^9}},ExpressionUUID->"e7ac6a9f-fc94-42c6-9619-\
22afb243d0f8"],

Cell[CellGroupData[{

Cell["log-likelihood function g(x)", "Subsection",
 CellChangeTimes->{{3.8375979178026133`*^9, 3.837597922226411*^9}, {
  3.8376000679671116`*^9, 
  3.8376000727109184`*^9}},ExpressionUUID->"4c39ef99-d04f-44e4-a491-\
a371020191ff"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Checked", " ", "against", " ", "matlab"}], "*)"}]], "Input",
 CellChangeTimes->{{3.838483197993617*^9, 
  3.8384832035827208`*^9}},ExpressionUUID->"e0a69240-5a08-45bd-bedc-\
180fb8cc131e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyLogLikelihood", "[", 
    RowBox[{"root_", ",", "hist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "z", ",", "frust", ",", "vex", ",", "frustAV", ",", "nAV", ",", 
       "loglikelihood"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frust", "=", 
       RowBox[{"root", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", 
         RowBox[{"maxcount", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "frust", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
       "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "frust", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=", 
       "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vex", "=", 
       RowBox[{"root", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"maxcount", "+", "2"}], ";;", 
         RowBox[{"maxcount", "+", 
          RowBox[{"dim1", " ", "dim2"}], "+", "1"}]}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                "vex", "\[LeftDoubleBracket]", "b", 
                 "\[RightDoubleBracket]"}]}], 
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}]}], "-", 
              RowBox[{
              "frust", "\[LeftDoubleBracket]", "n", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "!"}]], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"frustAV", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"hist", "\[LeftDoubleBracket]", 
             RowBox[{"n", ",", "b"}], "\[RightDoubleBracket]"}], 
            RowBox[{
            "frust", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
            ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nAV", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"hist", "\[LeftDoubleBracket]", 
             RowBox[{"n", ",", "b"}], "\[RightDoubleBracket]"}], 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"loglikelihood", "=", 
       RowBox[{
        FractionBox["timesteps", "tau"], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "frustAV", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}], 
           "+", 
           RowBox[{
            RowBox[{
            "nAV", " ", "\[LeftDoubleBracket]", "b", 
             "\[RightDoubleBracket]"}], 
            RowBox[{
            "vex", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}], 
           "+", 
           RowBox[{"Log", "[", 
            RowBox[{
            "z", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", 
            RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"asdf", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
         "frustAV", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "loglikelihood", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.837597924633791*^9, 3.837598089585694*^9}, {
   3.837598122456932*^9, 3.8375984240696793`*^9}, {3.837783050840002*^9, 
   3.837783053070998*^9}, {3.837783104975576*^9, 3.837783121344708*^9}, 
   3.8382981917610273`*^9, {3.8383755792713213`*^9, 3.8383755817932405`*^9}, {
   3.838482408743417*^9, 3.838482412375579*^9}, {3.838482487439348*^9, 
   3.838482602982918*^9}, {3.8384826595263166`*^9, 3.838482680388893*^9}, {
   3.838482710589219*^9, 3.8384827125573516`*^9}, {3.8384827494688826`*^9, 
   3.8384827585083284`*^9}, {3.8384828041896534`*^9, 3.838482805611754*^9}, {
   3.838482849683654*^9, 3.8384828655383677`*^9}, {3.838483016178034*^9, 
   3.8384830448903723`*^9}, {3.8384830806225805`*^9, 3.838483099112007*^9}, 
   3.8384831445434213`*^9, 
   3.8384831958239784`*^9},ExpressionUUID->"b262ca85-2462-40cc-bf88-\
bd81c1418578"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Log-Likelihood gradient function ",
 Cell[BoxData[
 "\[Del]"],ExpressionUUID->"44e0c730-f218-43b8-8663-301fc08d14d2"],
 "g(x)"
}], "Subsection",
 CellChangeTimes->{{3.837600034104082*^9, 
  3.8376000807516108`*^9}},ExpressionUUID->"344933ac-3cb5-44c9-b2c4-\
66ba4b0776d2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Checked", " ", "against", " ", "matlab"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8384812390339546`*^9, 
  3.838481245724247*^9}},ExpressionUUID->"e8f471a9-9aab-4657-b213-\
6ba03086dd7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LogLikelihoodGradient", "[", 
    RowBox[{"root_", ",", "hist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "frust", ",", "vex", ",", "zmat", ",", "nmat", ",", "nAV", ",", 
       "gradient", ",", "pmat"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frust", "=", 
       RowBox[{"root", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", 
         RowBox[{"maxcount", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vex", "=", 
       RowBox[{"root", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"maxcount", "+", "2"}], ";;", 
         RowBox[{"maxcount", "+", "1", "+", 
          RowBox[{"dim1", " ", "dim2"}]}]}], "\[RightDoubleBracket]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"zmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                "vex", "\[LeftDoubleBracket]", "b", 
                 "\[RightDoubleBracket]"}]}], 
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}]}], "-", 
              RowBox[{
              "frust", "\[LeftDoubleBracket]", "n", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "!"}]], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nmat", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{
            "zmat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]], 
           RowBox[{"Sum", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"n", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                   "vex", "\[LeftDoubleBracket]", "b", 
                    "\[RightDoubleBracket]"}]}], 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}]}], "-", 
                 RowBox[{
                 "frust", "\[LeftDoubleBracket]", "n", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "!"}]], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", 
            RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}], "-", "1"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nAV", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"hist", "\[LeftDoubleBracket]", 
             RowBox[{"n", ",", "b"}], "\[RightDoubleBracket]"}], 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gradient", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"maxcount", "+", "1", "+", 
          RowBox[{"dim1", " ", "dim2"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradient", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"maxcount", "+", "2"}], ";;", 
         RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{
        FractionBox["timesteps", "tau"], 
        RowBox[{"(", 
         RowBox[{"nAV", "-", "nmat"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{
              "vex", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}], 
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}]}], "-", 
            RowBox[{
            "frust", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
            "]"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "!"}], 
           RowBox[{
           "zmat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}]], 
         ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradient", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", 
         RowBox[{"maxcount", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["timesteps", "tau"], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"hist", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "b"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"pmat", "\[LeftDoubleBracket]", 
              RowBox[{"b", ",", "n"}], "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", 
              RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"asdf", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["timesteps", "tau"], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"hist", "\[LeftDoubleBracket]", 
              RowBox[{"n", ",", "b"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"pmat", "\[LeftDoubleBracket]", 
              RowBox[{"b", ",", "n"}], "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", 
              RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "gradient", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "gradient", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "gradient", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8375985441832466`*^9, 3.8375986820831614`*^9}, {
   3.8375987481929455`*^9, 3.8375987909702473`*^9}, {3.837598837057271*^9, 
   3.8375989174175158`*^9}, {3.83759907780807*^9, 3.8375995545385575`*^9}, {
   3.8375996694698763`*^9, 3.8375996726064568`*^9}, {3.8377838374461718`*^9, 
   3.8377838384221754`*^9}, {3.837783882683751*^9, 3.8377838854509416`*^9}, {
   3.8377839268070846`*^9, 3.8377839269230924`*^9}, {3.838290327538743*^9, 
   3.8382903306276627`*^9}, {3.838290436920617*^9, 3.838290440296172*^9}, {
   3.8382904952468805`*^9, 3.838290498759098*^9}, {3.8382905299104066`*^9, 
   3.83829055928478*^9}, 3.838290866531198*^9, {3.838298416408902*^9, 
   3.8382984245837493`*^9}, {3.8384789510268173`*^9, 3.838478977632819*^9}, {
   3.838479011092004*^9, 3.8384790210018764`*^9}, {3.8384790711038623`*^9, 
   3.8384790950959883`*^9}, {3.8384791942158227`*^9, 
   3.8384792077665195`*^9}, {3.83847947332429*^9, 3.838479479794821*^9}, {
   3.838480746196702*^9, 3.8384807491477356`*^9}, {3.8384808426575966`*^9, 
   3.8384808449327617`*^9}, {3.8384808934268837`*^9, 
   3.8384808987799397`*^9}, {3.838480969853716*^9, 3.8384810689936004`*^9}, {
   3.8384811059750156`*^9, 3.838481122426114*^9}, 
   3.838481638119646*^9},ExpressionUUID->"db56b1d7-0ba3-450b-ae48-\
d71a5f870885"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step size determination function", "Subsection",
 CellChangeTimes->{{3.837606019020746*^9, 
  3.8376060258950324`*^9}},ExpressionUUID->"83f0d082-7828-45ac-b877-\
272c70d14b4f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Performs", " ", "a", " ", "backtracking", " ", "search", " ", "to", " ", 
   "determine", " ", 
   RowBox[{"a", " ", "'"}], "sufficiently", " ", 
   RowBox[{"good", "'"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"according", " ", "to", " ", "the", " ", "Armijo"}], "-", 
     RowBox[{"Goldstein", " ", "condition"}]}], ")"}], " ", "step", " ", 
   "size", " ", "to", " ", "guarantee", " ", "the", " ", "function", " ", 
   "is", " ", "eing", " ", 
   RowBox[{"minimized", "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.837606031508872*^9, 
  3.837606067519004*^9}},ExpressionUUID->"36a3ec86-f7b0-4573-bd72-\
69ce6d9fc779"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LineMin", "[", 
    RowBox[{"root_", ",", "hist_", ",", "vecs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "con1", ",", "con2", ",", "m", ",", "t", ",", "alpha", ",", "delta"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"con1", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"con2", "=", "0.7"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LogLikelihoodGradient", "[", 
           RowBox[{"root", ",", "hist"}], "]"}], ".", " ", "vecs"}], ")"}], 
        RowBox[{"Norm", "[", "vecs", "]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", 
       RowBox[{
        RowBox[{"-", "con1"}], " ", "m"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alpha", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"delta", "=", 
       RowBox[{
        RowBox[{"MyLogLikelihood", "[", 
         RowBox[{"root", ",", "hist"}], "]"}], "-", 
        RowBox[{"MyLogLikelihood", "[", 
         RowBox[{
          RowBox[{"root", "-", 
           RowBox[{"alpha", " ", 
            FractionBox["vecs", 
             RowBox[{"Norm", "@", "vecs"}]]}]}], ",", "hist"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ct", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"CHECKED", " ", "UP", " ", "TO", " ", "THIS", " ", "POINT"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"diff", "<", 
         RowBox[{"alpha", " ", "t"}]}], " ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alpha", "=", 
          RowBox[{"alpha", " ", "con2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"delta", "=", 
          RowBox[{
           RowBox[{"MyLogLikelihood", "[", 
            RowBox[{"root", ",", "hist"}], "]"}], "-", 
           RowBox[{"MyLogLikelihood", "[", 
            RowBox[{
             RowBox[{"root", "-", 
              RowBox[{"alpha", " ", 
               FractionBox["vecs", 
                RowBox[{"Norm", "@", "vecs"}]]}]}], ",", "hist"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"ct", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"diff", "=", "delta"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "alpha", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8376059756854153`*^9, 3.837606007286414*^9}, {
   3.8376060785750628`*^9, 3.837606080750976*^9}, {3.8376061216030025`*^9, 
   3.837606233127845*^9}, {3.83760627582817*^9, 3.8376064554612803`*^9}, 
   3.8376067020550404`*^9, 3.8377850164900684`*^9, 3.838236553585156*^9, {
   3.8382857175282917`*^9, 3.838285743717856*^9}, 3.8382858074172096`*^9, {
   3.8382862384793262`*^9, 3.8382862515947924`*^9}, {3.8382862899200134`*^9, 
   3.838286401496213*^9}, {3.8382864798537326`*^9, 3.8382865010660286`*^9}, {
   3.838286538595224*^9, 3.838286572652684*^9}, {3.838288065898932*^9, 
   3.8382880676340466`*^9}, {3.838288185462344*^9, 3.8382881876770816`*^9}, {
   3.838288238492468*^9, 3.8382882655221605`*^9}, {3.8382883300660806`*^9, 
   3.8382883447762146`*^9}, {3.8382884116380477`*^9, 
   3.8382884279955783`*^9}, {3.8382885019224005`*^9, 
   3.8382885492388544`*^9}, {3.838288593263003*^9, 3.8382885967899847`*^9}, {
   3.838288677148144*^9, 3.838288702337319*^9}, {3.8382887502565093`*^9, 
   3.8382887997992496`*^9}, {3.8382888736107707`*^9, 3.838288937584019*^9}, {
   3.838289019463132*^9, 3.8382891177697687`*^9}, {3.8382891814158716`*^9, 
   3.838289181958508*^9}, {3.8382892432216988`*^9, 3.83828924345304*^9}, {
   3.8382894452238445`*^9, 3.838289445421151*^9}, {3.8382912192529416`*^9, 
   3.838291220634737*^9}, {3.8382983932423754`*^9, 3.8382984038243666`*^9}, {
   3.838481649914901*^9, 3.8384816823284435`*^9}, {3.83848209670997*^9, 
   3.838482127603464*^9}, {3.838482169316231*^9, 3.838482209994402*^9}, {
   3.8384823034015207`*^9, 3.8384823054258375`*^9}, {3.8384832655679045`*^9, 
   3.838483273198694*^9}, {3.8384834128936462`*^9, 3.838483419188718*^9}, {
   3.838483449269017*^9, 3.838483474556638*^9}, {3.8384835136359777`*^9, 
   3.838483515276019*^9}, {3.838483579794614*^9, 3.8384835799790397`*^9}, {
   3.838483644794903*^9, 3.8384836492265415`*^9}, {3.8384837277689233`*^9, 
   3.8384837285449886`*^9}, {3.838483840327927*^9, 3.838483840439666*^9}, {
   3.83848388062426*^9, 
   3.8384838887587605`*^9}},ExpressionUUID->"78483983-9ec0-4e2a-b0d6-\
639799b07a1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LineMin", "[", 
  RowBox[{"root", ",", "histo", ",", "vecs"}], "]"}]], "Input",
 CellChangeTimes->{{3.838481685021432*^9, 
  3.8384817149262853`*^9}},ExpressionUUID->"f07f2242-acf3-4baf-a0c6-\
e724d9b0d745"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.8384817154495974`*^9, 3.838481983853657*^9, {3.83848210568666*^9, 
   3.8384821618462706`*^9}, 3.8384822172697268`*^9, 3.8384823094305162`*^9, 
   3.83848321881857*^9, 3.838483291002668*^9, {3.8384834394584613`*^9, 
   3.8384834768672895`*^9}, 
   3.8384838937328043`*^9},ExpressionUUID->"423fd1ca-2f5d-4be5-a332-\
043601845b35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["ct"], "Input",
 CellChangeTimes->{{3.8384834405410175`*^9, 
  3.838483440698906*^9}},ExpressionUUID->"cf6821f5-caec-4520-9f49-\
a08583581083"],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{{3.8384834410561185`*^9, 
  3.8384834539060946`*^9}},ExpressionUUID->"0271b3ee-6be6-4115-90a4-\
4886d92b487f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["diff"], "Input",
 CellChangeTimes->{{3.8384823102203064`*^9, 
  3.83848231051923*^9}},ExpressionUUID->"b7e32766-1a5b-497d-a5bf-\
2bbd36cc3369"],

Cell[BoxData[
 RowBox[{"-", "0.19359237876415136`"}]], "Output",
 CellChangeTimes->{
  3.838482310790021*^9, 3.8384832214408655`*^9, {3.838483268651393*^9, 
   3.8384832934111996`*^9}},ExpressionUUID->"2d14cbef-71c9-40a8-bb86-\
e3d2741740ef"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariance matrix calculation", "Subsection",
 CellChangeTimes->{{3.83760665108759*^9, 3.8376066669598265`*^9}, {
  3.8382883483723216`*^9, 
  3.838288348908056*^9}},ExpressionUUID->"c76dc307-2885-4be0-9f97-\
718d728c9029"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetCovMat", "[", 
    RowBox[{"frust_", ",", "vex_", ",", "gauge_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"hessian", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"maxcount", "+", "1", "+", 
             RowBox[{"dim1", " ", "dim2"}]}], ",", 
            RowBox[{"maxcount", "+", "1", "+", 
             RowBox[{"dim1", " ", "dim2"}]}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"gaugemat", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"maxcount", "+", "1", "+", 
             RowBox[{"dim1", " ", "dim2"}]}], ",", 
            RowBox[{"maxcount", "+", "1", "+", 
             RowBox[{"dim1", " ", "dim2"}]}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"gtmat", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"maxcount", "+", "1", "+", 
             RowBox[{"dim1", " ", "dim2"}]}], ",", 
            RowBox[{"maxcount", "+", "1", "+", 
             RowBox[{"dim1", " ", "dim2"}]}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "eigenvalue", ",", "dims", ",", 
       "covf1primevbprime", ",", "covf1primefnprime", ",", "redvectcorr", ",",
        "\[IndentingNewLine]", "zmat", ",", "pmat", ",", "nmat", ",", "n2mat",
        ",", "hessianFF", ",", "hessianVV", ",", "hessianVF", ",", "covmatp", 
       ",", "covmatg", ",", "covmat", ",", "stderrors"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}]}], 
               RowBox[{
               "vex", "\[LeftDoubleBracket]", "b", 
                "\[RightDoubleBracket]"}]}], "-", 
              RowBox[{
              "frust", "\[LeftDoubleBracket]", "n", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "!"}]], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}], 
             RowBox[{
             "vex", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{
            "frust", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
            "]"}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "!"}], 
           RowBox[{
           "zmat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}]], 
         ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nmat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{
           "zmat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}]}], 
                 RowBox[{
                 "vex", "\[LeftDoubleBracket]", "b", 
                  "\[RightDoubleBracket]"}]}], "-", 
                RowBox[{
                "frust", "\[LeftDoubleBracket]", "n", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], "!"}]], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n2mat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{
           "zmat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}]}], 
                 RowBox[{
                 "vex", "\[LeftDoubleBracket]", "b", 
                  "\[RightDoubleBracket]"}]}], "-", 
                RowBox[{
                "frust", "\[LeftDoubleBracket]", "n", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], "!"}]], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hessianFF", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["timesteps", "tau"], 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"n", ",", "m"}], "]"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"pmat", "\[LeftDoubleBracket]", 
              RowBox[{"b", ",", "n"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "1", ",", 
               RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], "-", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pmat", "\[LeftDoubleBracket]", 
              RowBox[{"b", ",", "n"}], "\[RightDoubleBracket]"}], 
             RowBox[{"pmat", "\[LeftDoubleBracket]", 
              RowBox[{"b", ",", "m"}], "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", 
              RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"maxcount", "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", 
           RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hessianVV", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["timesteps", "tau"], 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{"b", ",", "d"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "n2mat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}], 
            "-", 
            SuperscriptBox[
             RowBox[{
             "nmat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}], 
             "2"]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hessianVF", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["timesteps", "tau"], 
          RowBox[{"pmat", "\[LeftDoubleBracket]", 
           RowBox[{"b", ",", "n"}], "\[RightDoubleBracket]"}], 
          RowBox[{"(", 
           RowBox[{"n", "-", 
            RowBox[{
            "nmat", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}], 
           ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", 
           RowBox[{"dim1", " ", "dim2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hessian", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"1", ";;", 
          RowBox[{"maxcount", "+", "1"}]}], ",", 
         RowBox[{"1", ";;", 
          RowBox[{"maxcount", "+", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
       "hessianFF"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hessian", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{
          RowBox[{"maxcount", "+", "2"}], ";;", 
          RowBox[{"maxcount", "+", "1", "+", 
           RowBox[{"dim1", " ", "dim2"}]}]}], ",", 
         RowBox[{
          RowBox[{"maxcount", "+", "2"}], ";;", 
          RowBox[{"maxcount", "+", "1", "+", 
           RowBox[{"dim1", " ", "dim2"}]}]}]}], "\[RightDoubleBracket]"}], 
       "=", "hessianVV"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hessian", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"1", ";;", 
          RowBox[{"maxcount", "+", "1"}]}], ",", 
         RowBox[{
          RowBox[{"maxcount", "+", "2"}], ";;", 
          RowBox[{"maxcount", "+", "1", "+", 
           RowBox[{"dim1", " ", "dim2"}]}]}]}], "\[RightDoubleBracket]"}], 
       "=", 
       RowBox[{"hessianVF", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hessian", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{
          RowBox[{"maxcount", "+", "2"}], ";;", 
          RowBox[{"maxcount", "+", "1", "+", 
           RowBox[{"dim1", " ", "dim2"}]}]}], ",", 
         RowBox[{"1", ";;", 
          RowBox[{"maxcount", "+", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
       "hessianVF"}], ";", "\[IndentingNewLine]", 
      RowBox[{"eigenvalue", "=", 
       RowBox[{"Eigenvalues", "[", "hessian", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dims", "=", 
       RowBox[{
        RowBox[{"Length", "[", "eigenvalue", "]"}], "-", 
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"1.", 
           RowBox[{"Flatten", "[", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"DiagonalMatrix", "[", "eigenvalue", "]"}], "5"], ",", 
              "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"Except", "[", "0.", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"gauge", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"True", ",", " ", 
          RowBox[{
           RowBox[{"zero", " ", "gauge"}], ";"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dims", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"dims", " ", "is", " ", "zero"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"covmat", "=", 
           RowBox[{"Inverse", "[", "hessian", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"dims", " ", "is", " ", "not", " ", "zero"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covmat", "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"maxcount", "+", 
                 RowBox[{"dim1", " ", "dim2"}], "+", "1"}], ",", 
                RowBox[{"maxcount", "+", 
                 RowBox[{"dim1", " ", "dim2"}], "+", "1"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"covmat", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
               RowBox[{"dims", "+", "1"}], ";;", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{
               RowBox[{"dims", "+", "1"}], ";;", 
               RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"Inverse", "[", "hessian", "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"False", " ", "\[Rule]", " ", 
           RowBox[{"Nonzero", " ", "gauge"}]}], ";", " ", 
          RowBox[{
          "build", " ", "gauge", " ", "transformation", " ", "matrix"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gtmat", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "[", "hessian", "]"}], ",", 
              RowBox[{"Length", "[", "hessian", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gtmat", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"1", ";;", 
             RowBox[{"maxcount", "+", "1"}]}], ",", 
            RowBox[{"1", ";;", 
             RowBox[{"maxcount", "+", "1"}]}]}], "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"Identity", "[", 
           RowBox[{"maxcount", "+", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gtmat", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"1", ";;", 
             RowBox[{"maxcount", "+", "1"}]}], ",", 
            RowBox[{
             RowBox[{"maxcount", "+", "2"}], ";;", 
             RowBox[{"maxcount", "+", "1", "+", 
              RowBox[{"dim1", " ", "dim2"}]}]}]}], "\[RightDoubleBracket]"}], 
          "=", 
          FractionBox[
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", "+", "dims", "+", "maxcount", "+", "1"}], "]"}], 
             ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"1", ",", 
               RowBox[{"dim1", " ", "dim2"}]}], "]"}]}], "]"}], 
           RowBox[{"dim1", " ", "dim2"}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gtmat", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"maxcount", "+", "2"}], ";;", 
             RowBox[{"maxcount", "+", "1", "+", 
              RowBox[{"dim1", " ", "dim2"}]}]}], ",", 
            RowBox[{
             RowBox[{"maxcount", "+", "2"}], ";;", 
             RowBox[{"maxcount", "+", "1", "+", 
              RowBox[{"dim1", " ", "dim2"}]}]}]}], "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"dim1", " ", "dim2"}], ",", " ", 
              RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"gtmat", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"maxcount", "+", "2"}], ";;", 
             RowBox[{"maxcount", "+", "1", "+", 
              RowBox[{"dim1", " ", "dim2"}]}]}], ",", 
            RowBox[{"1", ";;", 
             RowBox[{"maxcount", "+", "1"}]}]}], "\[RightDoubleBracket]"}], 
          "=", 
          FractionBox[
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"dim1", " ", "dim2"}], ",", " ", 
               RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}], 
           RowBox[{"dim1", " ", "dim2"}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{"covmatp", "=", 
          RowBox[{"Inverse", "[", "Hessian", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"covmatg", "=", 
          RowBox[{"gaugemat", ".", "covmat", ".", 
           RowBox[{"gaugemat", "\[Transpose]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"covf1primevbprime", "=", 
          RowBox[{
           FractionBox[
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"covmatp", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxcount", "+", "1"}], ";;", 
                 RowBox[{"-", "1"}]}], ",", "n"}], "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"maxcount", "+", "1"}], ",", 
                RowBox[{"Length", "[", "covmatp", "]"}]}], "}"}]}], "]"}], 
            RowBox[{"dim1", " ", "dim2"}]], "+", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"dim1", " ", "dim2"}], ")"}], "2"]], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"covmatp", "\[LeftDoubleBracket]", 
                 RowBox[{"m", ",", "n"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{"maxcount", "+", "1"}], ",", 
                  RowBox[{"Length", "[", "covmatp", "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"maxcount", "+", "1"}], ",", 
                RowBox[{"Length", "[", "covmatp", "]"}]}], "}"}]}], 
             "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"covf1primefnprime", "=", 
          RowBox[{
           FractionBox[
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"covmatp", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxcount", "+", "1"}], ";;", 
                 RowBox[{"-", "1"}]}], ",", "n"}], "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1", ",", "maxcount"}], "}"}]}], "]"}], 
            RowBox[{"dim1", " ", "dim2"}]], "+", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"{", 
              RowBox[{"3", ",", "maxcount"}], "}"}], "]"}], 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"dim1", " ", "dim2"}], ")"}], "2"]], 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"covmatp", "\[LeftDoubleBracket]", 
                  RowBox[{"m", ",", "n"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", 
                   RowBox[{"maxcount", "+", "1"}], ",", 
                   RowBox[{"Length", "[", "covmatp", "]"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"maxcount", "+", "1"}], ",", 
                 RowBox[{"Length", "[", "covmatp", "]"}]}], "}"}]}], 
              "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"redvectcorr", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"covf1primefnprime", ",", "covf1primevbprime", ",", "1"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dims", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"dims", " ", "is", " ", "zero"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"covmat", "=", 
            RowBox[{"ArrayFlatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"covmatp", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"maxcount", "+", "1"}], ";;", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"maxcount", ";;", 
                    RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], ",", 
                    "2"}], "]"}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"dim1", " ", "dim2"}], ")"}], "2"]], ",", 
                 RowBox[{"{", "redvectcorr", "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", "redvectcorr", "}"}], "\[Transpose]"}], ",", 
                 "covmatg"}], "}"}]}], "}"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"dims", " ", "is", " ", "not", " ", "zero"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"covmat", "=", 
             RowBox[{"ArrayFlatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"covmatp", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"maxcount", "+", "1"}], ";;", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"maxcount", ";;", 
                    RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], ",", 
                    "2"}], "]"}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"dim1", " ", "dim2"}], ")"}], "2"]], ",", 
                  RowBox[{"{", "redvectcorr", "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", "redvectcorr", "}"}], "\[Transpose]"}], ",", 
                  "covmatg"}], "}"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"covmat", "=", 
             RowBox[{"ArrayFlatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dims", "-", "1"}], ",", 
                    RowBox[{"dims", "-", "1"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dims", "-", "1"}], ",", 
                    RowBox[{"Length", "[", "covmat", "]"}]}], "}"}]}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "covmat", "]"}], ",", 
                    RowBox[{"dims", "-", "1"}]}], "}"}]}], "]"}], ",", 
                  "covmat"}], "}"}]}], "}"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"stderrors", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Diagonal", "[", "covmat", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"covmat", ",", "stderrors"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8376066702904005`*^9, 3.8376067664003086`*^9}, {
   3.837606811842764*^9, 3.8376069497750015`*^9}, {3.8376070112994127`*^9, 
   3.8376070914667416`*^9}, {3.837607159464286*^9, 3.8376071897900558`*^9}, {
   3.837607295770952*^9, 3.8376074459156837`*^9}, {3.837607508163306*^9, 
   3.8376081387567015`*^9}, {3.8376081941238003`*^9, 3.837608224465277*^9}, {
   3.8376083225561204`*^9, 3.837608324580827*^9}, {3.8376083615420465`*^9, 
   3.837608373335809*^9}, {3.837608528171343*^9, 3.8376085829754553`*^9}, 
   3.837782013119882*^9, {3.8377859169560523`*^9, 3.837785921890053*^9}, {
   3.8377862771312494`*^9, 3.8377862975106826`*^9}, {3.8377865466566925`*^9, 
   3.837786547120693*^9}, {3.838124691205476*^9, 3.8381246923015847`*^9}, {
   3.838124974108661*^9, 3.8381249761942587`*^9}, {3.8381251857294455`*^9, 
   3.838125216293274*^9}, {3.83812649298335*^9, 3.8381265436946836`*^9}, {
   3.838126798222207*^9, 3.838126804022163*^9}, 3.838213702104007*^9, {
   3.8382143121558695`*^9, 3.8382143396762724`*^9}, {3.8382150235683346`*^9, 
   3.838215025050516*^9}, {3.8382152863726406`*^9, 3.838215448163743*^9}, {
   3.838215796355893*^9, 3.838215801992675*^9}, {3.8382158322183924`*^9, 
   3.838215833650011*^9}, {3.8382158769478273`*^9, 3.838215905299528*^9}, {
   3.8382159550598702`*^9, 3.8382159936515512`*^9}, {3.8382160978606105`*^9, 
   3.8382161351514826`*^9}, {3.8382161668323555`*^9, 3.838216196925095*^9}, {
   3.8382164142761154`*^9, 3.8382164311677732`*^9}, {3.8382164622289023`*^9, 
   3.8382164928082294`*^9}, {3.838218035622101*^9, 3.8382181155579805`*^9}, {
   3.8382181546569834`*^9, 3.838218167885749*^9}, {3.838218207981868*^9, 
   3.8382182331865816`*^9}, {3.838218345701997*^9, 3.838218368267689*^9}, {
   3.8382184001953206`*^9, 3.838218458104515*^9}, {3.8382185008402557`*^9, 
   3.8382187051972156`*^9}, {3.838218735941749*^9, 3.838218736642814*^9}, {
   3.8382189015322194`*^9, 3.838218903427026*^9}, {3.838218974438414*^9, 
   3.838218976568883*^9}, {3.838219116709982*^9, 3.838219295945166*^9}, {
   3.8382193654898443`*^9, 3.838219414933402*^9}, {3.838219470435919*^9, 
   3.8382194706262655`*^9}, {3.8382195590102415`*^9, 
   3.8382197359041777`*^9}, {3.838219822596467*^9, 3.838219847912115*^9}, {
   3.8382198924859996`*^9, 3.8382199977058506`*^9}, {3.838220035824008*^9, 
   3.8382202232504454`*^9}, 3.838230125383252*^9, {3.838230185205721*^9, 
   3.838230262297633*^9}, {3.8382304595614586`*^9, 3.8382305175357385`*^9}, {
   3.8382305861714554`*^9, 3.8382306150483956`*^9}, {3.8382312878453393`*^9, 
   3.8382313449078245`*^9}, {3.838236342212307*^9, 3.8382365416791587`*^9}, {
   3.838284677830099*^9, 3.8382846802032385`*^9}, {3.8382851150038834`*^9, 
   3.838285116211183*^9}, {3.838285219770522*^9, 3.838285278910962*^9}, {
   3.8382854150730667`*^9, 3.8382854227135777`*^9}, {3.8382854582872295`*^9, 
   3.8382854596131225`*^9}, {3.838291371672392*^9, 3.8382913796862993`*^9}, {
   3.838296219069869*^9, 3.838296278588006*^9}, {3.8382964762270565`*^9, 
   3.8382964900624123`*^9}, {3.8382965245756454`*^9, 3.83829652771222*^9}, {
   3.8382966019578285`*^9, 3.83829660212551*^9}, {3.8382970094069967`*^9, 
   3.838297241371053*^9}, {3.8382973858984623`*^9, 3.8382974783570538`*^9}, {
   3.838297513354201*^9, 3.838297597899373*^9}, {3.838297694359049*^9, 
   3.8382977908117247`*^9}, {3.838297926072628*^9, 3.8382979319491415`*^9}, 
   3.838298145748798*^9, {3.838298382661781*^9, 
   3.8382983864251165`*^9}},ExpressionUUID->"fd9d9166-761a-435a-b603-\
9e61f24a1d4a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main routine", "Section",
 CellChangeTimes->{{3.8375979032027054`*^9, 
  3.8375979059149456`*^9}},ExpressionUUID->"bac05df7-f4cf-4f8b-923c-\
62e0d3dd60e3"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"flatstack", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "imstack"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "roots", " ", "for", " ", "guessing", " ", "are", " ", 
       "initialized", " ", "by", " ", "random", " ", "numbers"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"root", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"maxcount", "+", "1", "+", 
          RowBox[{"dim2", " ", "dim1"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"hist", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"maxcount", "+", "1"}], ",", 
          RowBox[{"dim2", " ", "dim1"}]}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}], ",", " ", 
     RowBox[{"(*", 
      RowBox[{"Error", " ", "tolerance", " ", "for", " ", "gradient"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vecn", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "maxcount"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "sigfrust", ",", "sigvex", ",", 
     RowBox[{"gauge", "=", "0"}], ",", "alpha", ",", "beta", ",", "delta", 
     ",", "sigma", ",", "deltaold", ",", "m", ",", "conjugdir", ",", 
     "rootold", ",", "stderror"}], "\[IndentingNewLine]", "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"flatstack", "\[LeftDoubleBracket]", 
               RowBox[{"t", ",", "b"}], "\[RightDoubleBracket]"}], "\[Equal]", 
              RowBox[{"1.", 
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"hist", "\[LeftDoubleBracket]", 
               RowBox[{"n", ",", "b"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{
               RowBox[{"hist", "\[LeftDoubleBracket]", 
                RowBox[{"n", ",", "b"}], "\[RightDoubleBracket]"}], "+", 
               "1"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "timesteps"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "1", ",", 
          RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", 
        RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"hist", "=", 
     FractionBox[
      RowBox[{"1.", "hist"}], "timesteps"]}], ";", "\[IndentingNewLine]", 
    RowBox[{"histo", "=", "hist"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Fixed", " ", "root", " ", "from", " ", "matlab", " ", "version"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"root", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<rootparams.mat\>\"", ",", "\"\<Data\>\""}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"delta", "=", 
     RowBox[{"-", 
      RowBox[{"LogLikelihoodGradient", "[", 
       RowBox[{"root", ",", "hist"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"CHECKED", " ", "UP", " ", "TO", " ", "THIS", " ", "POINT"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"conjugdir", "=", "delta"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vecs", "=", "conjugdir"}], ";", "\[IndentingNewLine]", 
    RowBox[{"alpha", "=", " ", 
     RowBox[{"LineMin", "[", 
      RowBox[{"root", ",", "hist", ",", "conjugdir"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"rootold", "=", "root"}], ";", "\[IndentingNewLine]", 
    RowBox[{"root", "=", 
     RowBox[{"root", "+", 
      RowBox[{"alpha", " ", "delta"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"root", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"root", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Norm", "[", 
        FractionBox[
         RowBox[{"root", "-", "rootold"}], 
         RowBox[{"maxcount", "+", "1", "+", 
          RowBox[{"dim1", " ", "dim2"}]}]], "]"}], "\[GreaterEqual]", 
       "\[Epsilon]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"m", "+", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"deltaold", "=", "delta"}], ";", "\[IndentingNewLine]", 
       RowBox[{"delta", "=", 
        RowBox[{"-", 
         RowBox[{"LogLikelihoodGradient", "[", 
          RowBox[{"root", ",", "hist"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"beta", "=", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"Norm", "[", "delta", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"Norm", "[", "deltaold", "]"}], "2"]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"conjugdir", "=", 
        RowBox[{"delta", "+", 
         RowBox[{"beta", " ", "conjugdir"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"alpha", "=", " ", 
        RowBox[{"LineMin", "[", 
         RowBox[{"root", ",", "hist", ",", "conjugdir"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"root", "=", 
        RowBox[{"root", "+", 
         RowBox[{"alpha", " ", "conjugdir"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rootold", "=", "root"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "root", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
        "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "root", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=", 
        "0"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", "Condition", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gauge", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", "True", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"frustration", "=", 
        RowBox[{"root", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", 
          RowBox[{"maxcount", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vexation", "=", 
        RowBox[{"root", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"maxcount", "+", "2"}], ";;", 
          RowBox[{"maxcount", "+", "1", "+", 
           RowBox[{"dim1", " ", "dim2"}]}]}], "\[RightDoubleBracket]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sigma", ",", "stderror"}], "}"}], "=", 
        RowBox[{"GetCovMat", "[", 
         RowBox[{"frustration", ",", "vexation", ",", "gauge"}], "]"}]}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", "False", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"frustration", "=", 
        RowBox[{
         RowBox[{"root", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", 
           RowBox[{"maxcount", "+", "1"}]}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{
          FractionBox["vecn", 
           RowBox[{"dim1", " ", "dim2"}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
            "root", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"maxcount", "+", "2"}], ",", 
              RowBox[{"maxcount", "+", 
               RowBox[{"dim1", " ", "dim2"}]}]}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vexation", "=", 
        RowBox[{
         RowBox[{"root", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"maxcount", "+", "2"}], ";;", 
           RowBox[{"maxcount", "+", "1", "+", 
            RowBox[{"dim1", " ", "dim2"}]}]}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dim1", " ", "dim2"}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
            "root", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"maxcount", "+", "2"}], ",", 
              RowBox[{"maxcount", "+", "1", "+", 
               RowBox[{"dim1", " ", "dim2"}]}]}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sigma", ",", "stderror"}], "}"}], "=", 
        RowBox[{"GetCovMat", "[", 
         RowBox[{"frustration", ",", "vexation", ",", "gauge"}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"asigfrust", "=", 
     RowBox[{
      RowBox[{"Diagonal", "[", "sigma", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "maxcount"}], "\[RightDoubleBracket]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"asigvex", "=", 
     RowBox[{
      RowBox[{"Diagonal", "[", "sigma", "]"}], "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"maxcount", "+", "2"}], ";;", 
       RowBox[{"maxcount", "+", 
        RowBox[{"dim1", " ", "dim2"}]}]}], "\[RightDoubleBracket]"}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8375226370643854`*^9, 3.8375227564263983`*^9}, {
   3.8375228142277613`*^9, 3.837522818306176*^9}, {3.8375228651301117`*^9, 
   3.837522952425252*^9}, {3.837523013728404*^9, 3.837523015047863*^9}, {
   3.8375231940044127`*^9, 3.837523201084402*^9}, {3.83752324941327*^9, 
   3.837523274450118*^9}, {3.837523459580987*^9, 3.8375235477044296`*^9}, {
   3.8375235878466644`*^9, 3.837523595735449*^9}, {3.8375236437270594`*^9, 
   3.83752366210042*^9}, {3.8375238763150263`*^9, 3.8375239077939005`*^9}, {
   3.837523954137839*^9, 3.8375239738315597`*^9}, {3.837524026409511*^9, 
   3.8375240264728737`*^9}, {3.837524097831289*^9, 3.8375241306400867`*^9}, {
   3.837524169238369*^9, 3.837524187325431*^9}, {3.837524351306939*^9, 
   3.8375244129550643`*^9}, {3.8375247555587635`*^9, 3.837524759516486*^9}, 
   3.8375248101333857`*^9, {3.8375248572439575`*^9, 3.837524885882843*^9}, {
   3.837524965906969*^9, 3.8375249740898566`*^9}, {3.8375250182033577`*^9, 
   3.837525027866399*^9}, {3.837525389404046*^9, 3.8375256777767973`*^9}, {
   3.8375257467674217`*^9, 3.837525864917738*^9}, {3.8375261107231617`*^9, 
   3.8375262379286766`*^9}, {3.837526339240481*^9, 3.837526363838005*^9}, {
   3.83759621965444*^9, 3.8375965140186777`*^9}, {3.8375966980009356`*^9, 
   3.837596889765028*^9}, {3.837596932364877*^9, 3.8375971478678665`*^9}, {
   3.8375971972715893`*^9, 3.8375972022045116`*^9}, {3.837597473616128*^9, 
   3.8375974956004734`*^9}, {3.837598476667061*^9, 3.837598508297529*^9}, 
   3.8375996783886623`*^9, {3.837599757115691*^9, 3.837599815673058*^9}, {
   3.8375998682410707`*^9, 3.8375998926642094`*^9}, {3.8376000119548235`*^9, 
   3.8376000128553634`*^9}, {3.837782059363928*^9, 3.8377821973804874`*^9}, {
   3.8377822296424875`*^9, 3.8377822302644835`*^9}, {3.8377826556754656`*^9, 
   3.8377826602974577`*^9}, {3.837782725296406*^9, 3.837782888623316*^9}, {
   3.8377829519261866`*^9, 3.8377829538211823`*^9}, {3.8377829891798687`*^9, 
   3.8377829906770344`*^9}, {3.8377834487120275`*^9, 
   3.8377836661938505`*^9}, {3.8377839860433693`*^9, 
   3.8377839896853623`*^9}, {3.8377840436839085`*^9, 3.837784071628629*^9}, {
   3.8377841072826195`*^9, 3.8377841573411894`*^9}, {3.837784192677204*^9, 
   3.837784201635202*^9}, {3.8377842532055836`*^9, 3.837784272421736*^9}, {
   3.8377843027207446`*^9, 3.8377843047427454`*^9}, {3.8377844489109735`*^9, 
   3.837784471100603*^9}, {3.83778453161208*^9, 3.83778453182908*^9}, {
   3.8377846396021423`*^9, 3.837784703334832*^9}, {3.837784934989875*^9, 
   3.8377849673037252`*^9}, {3.837785168481063*^9, 3.837785183247069*^9}, {
   3.838126572526845*^9, 3.838126583492227*^9}, {3.838126631604391*^9, 
   3.8381266406513205`*^9}, {3.8382151917597733`*^9, 
   3.8382152209086294`*^9}, {3.838285130523602*^9, 3.8382851344505343`*^9}, {
   3.838285560713233*^9, 3.8382855752763643`*^9}, {3.8382856237164392`*^9, 
   3.838285692611197*^9}, {3.83828584741038*^9, 3.8382858539760456`*^9}, {
   3.8382859392424726`*^9, 3.8382859539896345`*^9}, {3.8382860075504026`*^9, 
   3.838286009787856*^9}, {3.8382861272974596`*^9, 3.838286200569543*^9}, {
   3.8382881582857804`*^9, 3.8382881595369463`*^9}, {3.838289495600019*^9, 
   3.8382895886084805`*^9}, {3.8382897018374243`*^9, 
   3.8382897057797155`*^9}, {3.8382897591627903`*^9, 3.838289797731532*^9}, {
   3.8382898448775363`*^9, 3.8382898696802435`*^9}, {3.8382899205303183`*^9, 
   3.8382899358378525`*^9}, {3.83829022120177*^9, 3.8382902533112297`*^9}, {
   3.83829037416778*^9, 3.8382903755811224`*^9}, {3.8382909027024765`*^9, 
   3.838290902861866*^9}, {3.8382910060314665`*^9, 3.8382910306253552`*^9}, {
   3.8382910754421577`*^9, 3.8382910756742992`*^9}, {3.838291112779889*^9, 
   3.8382911582654047`*^9}, {3.838291192947038*^9, 3.8382912065105658`*^9}, {
   3.8382912435406046`*^9, 3.838291244996705*^9}, {3.8382979786481233`*^9, 
   3.8382980456700926`*^9}, {3.8382981036470385`*^9, 3.838298125030489*^9}, {
   3.838298453328392*^9, 3.8382984749777975`*^9}, {3.838298602441334*^9, 
   3.838298623198279*^9}, {3.838375120017037*^9, 3.8383751377410517`*^9}, {
   3.8383753185582705`*^9, 3.8383753226559258`*^9}, {3.838476931386199*^9, 
   3.8384769656813374`*^9}, {3.83847708675323*^9, 3.8384771245996265`*^9}, 
   3.8384776523064623`*^9, {3.838477696958269*^9, 3.838477697335677*^9}, {
   3.838477961880289*^9, 3.8384779662438393`*^9}, 3.838478005724128*^9, {
   3.8384780398077183`*^9, 3.8384780471252804`*^9}, {3.838478077203703*^9, 
   3.838478079316225*^9}, {3.8384781862041607`*^9, 3.838478215594654*^9}, {
   3.8384783108527966`*^9, 3.8384784485202475`*^9}, {3.838478684981045*^9, 
   3.838478734083985*^9}, {3.8384787757013865`*^9, 3.8384787839239807`*^9}, 
   3.8384790339464006`*^9, {3.838480714630516*^9, 3.8384807335636206`*^9}, {
   3.8384812643094225`*^9, 3.8384812659203167`*^9}, {3.838481524012018*^9, 
   3.838481583300561*^9}, {3.8384817053955145`*^9, 3.838481708385661*^9}, {
   3.8384818008337717`*^9, 3.838481803025482*^9}, 3.8384818881849985`*^9, {
   3.8384819194529843`*^9, 3.8384819203366165`*^9}, {3.838481961345031*^9, 
   3.8384819688480015`*^9}, 
   3.838482154725185*^9},ExpressionUUID->"0c1379b2-c4a2-42ef-8c52-\
ee42654a3a0c"],

Cell[CellGroupData[{

Cell[BoxData["dd"], "Input",
 CellChangeTimes->{{3.8384818984646235`*^9, 
  3.838481898652477*^9}},ExpressionUUID->"32123421-1876-460f-b4be-\
2f0c045ec8ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "713.3936061615279`", ",", "808.3712430494057`", ",", 
   "346.8920202467204`", ",", "50.55442557052714`", ",", 
   "4.0625506506723195`", ",", "0.10864908289125927`", ",", 
   "0.23531746060802672`", ",", "130.09143139433604`", ",", 
   "163.81873738065042`", ",", "116.09298233741933`", ",", 
   "288.8874585674708`", ",", "362.19568451813484`", ",", 
   "327.35629630410835`", ",", "46.46740733482248`", ",", 
   "10.327127679089775`", ",", 
   RowBox[{"-", "27.80108312427823`"}], ",", 
   RowBox[{"-", "42.45175227862847`"}], ",", 
   RowBox[{"-", "58.417470617092434`"}], ",", 
   RowBox[{"-", "68.25912193497078`"}], ",", "138.90789246531423`", ",", 
   "154.24336445530204`", ",", "223.88781074622133`", ",", 
   "201.87422214535732`", ",", "305.3746541221335`", ",", 
   "310.19092326472435`", ",", "59.066324795072525`", ",", 
   RowBox[{"-", "44.611410372300654`"}], ",", 
   RowBox[{"-", "76.10304011101155`"}], ",", 
   RowBox[{"-", "90.55900163202207`"}], ",", 
   RowBox[{"-", "77.92445011984312`"}], ",", 
   RowBox[{"-", "155.72146062441618`"}], ",", "167.11475618405348`", ",", 
   "130.35825986222287`", ",", "211.29351511103232`", ",", 
   "223.03650031105892`", ",", "249.14988606092163`", ",", 
   "278.26169646026165`", ",", "160.93797412559087`", ",", 
   "63.12617756334016`", ",", 
   RowBox[{"-", "79.61337701835645`"}], ",", 
   RowBox[{"-", "42.68589910587388`"}], ",", 
   RowBox[{"-", "134.61994520962435`"}], ",", 
   RowBox[{"-", "48.9706837678232`"}], ",", "223.70949005295947`", ",", 
   "214.13283615587432`", ",", "251.80947938420712`", ",", 
   "255.0384734804294`", ",", "316.60443459213764`", ",", 
   "305.26279769615655`", ",", "198.38639036062148`", ",", 
   "63.17748163044495`", ",", 
   RowBox[{"-", "102.22033759139354`"}], ",", 
   RowBox[{"-", "108.97090227404519`"}], ",", 
   RowBox[{"-", "102.99505801636971`"}], ",", 
   RowBox[{"-", "136.4475650960735`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8384818992031975`*^9, 
  3.838481925613512*^9}},ExpressionUUID->"6e9c243f-2530-471e-a26a-\
4d901e82871d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prediction", "Section",
 CellChangeTimes->{{3.837693525978629*^9, 
  3.8376935273583155`*^9}},ExpressionUUID->"0779f07c-fff2-4c82-b461-\
860f98d52391"],

Cell[BoxData[
 RowBox[{"Module", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Epsilon]", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "7."}]]}], ",", "\[IndentingNewLine]", 
     RowBox[{"count", "=", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"maxsteps", "=", "130"}], ",", "\[IndentingNewLine]", "delta", 
     ",", "mu", ",", "mustar", ",", "a", ",", "b", ",", "nwiggle"}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mu", "=", 
     RowBox[{"Max", "[", "vexation", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"nwiggle", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"delta", "=", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"Max", "@", "vexation"}], " ", "-", " ", 
       RowBox[{"Min", "@", "vexation"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{"mu", "+", 
      RowBox[{"2", "delta"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"b", "=", 
     RowBox[{"mu", "-", 
      RowBox[{"2", "delta"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mustar", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"count", "\[LessEqual]", "maxsteps"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mu", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b"}], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}]}], 
                RowBox[{
                "vexation", "\[LeftDoubleBracket]", "n", 
                 "\[RightDoubleBracket]"}]}], "-", 
               RowBox[{
               "frustration", "\[LeftDoubleBracket]", "n", 
                "\[RightDoubleBracket]"}]}], "]"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], "!"}]], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", 
            RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nexp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}]}], 
                 RowBox[{
                 "vexation", "\[LeftDoubleBracket]", "n", 
                  "\[RightDoubleBracket]"}]}], "-", 
                RowBox[{
                "frustration", "\[LeftDoubleBracket]", "n", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}], "!"}], 
              RowBox[{
              "zmat", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}]], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"maxcount", "+", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", 
            RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nwiggle", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
          "nexp", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", 
            RowBox[{"dim1", " ", "dim2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"nwiggle", "-", "nhat"}], "]"}], "\[LessEqual]", 
          "\[Epsilon]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mustar", "=", "mu"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "+=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nwiggle", "<", "nhat"}], ",", "\[IndentingNewLine]", 
         RowBox[{"b", "=", "mu"}], ",", "\[IndentingNewLine]", 
         RowBox[{"a", "=", "mu"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", 
     RowBox[{"mu", ",", "nexp"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.837693530690215*^9, 3.8376935324728885`*^9}, {
   3.8376936103364334`*^9, 3.837693676697896*^9}, {3.8376937364790196`*^9, 
   3.8376938154464617`*^9}, {3.837693849960761*^9, 3.8376938800467415`*^9}, {
   3.8376939303606515`*^9, 3.8376941811516004`*^9}, {3.837694218577258*^9, 
   3.8376943588849525`*^9}, {3.8377851086889167`*^9, 3.8377851214559183`*^9}, 
   3.837785165369973*^9, {3.838290192736267*^9, 
   3.838290202262475*^9}},ExpressionUUID->"a4534700-5e42-496e-8a28-\
b9202be502d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"root", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<rootparams.mat\>\"", ",", "\"\<Data\>\""}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.838481859740721*^9},ExpressionUUID->"8bfb3bca-0ab1-4d7e-9433-\
ec0c92f8f717"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{958, 978},
WindowMargins->{{Automatic, 46}, {Automatic, 44}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 173, 3, 107, "Title",ExpressionUUID->"0b501704-bc82-43fb-b47b-6e1154367685"],
Cell[CellGroupData[{
Cell[778, 29, 313, 5, 74, "Chapter",ExpressionUUID->"c998a13c-5904-496e-bae0-883713f176c8"],
Cell[CellGroupData[{
Cell[1116, 38, 154, 3, 70, "Subchapter",ExpressionUUID->"5097a9c0-dd25-483f-a589-41caf672929b"],
Cell[CellGroupData[{
Cell[1295, 45, 164, 3, 73, "Section",ExpressionUUID->"a27551c3-da23-42eb-b19a-9dd9288c8c9e"],
Cell[1462, 50, 1425, 28, 143, "Input",ExpressionUUID->"ae5fceec-7453-4a36-860b-b7f050e73d91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2924, 83, 158, 3, 73, "Section",ExpressionUUID->"f980ed48-3752-4e40-a237-f88ead2916b1"],
Cell[CellGroupData[{
Cell[3107, 90, 167, 3, 59, "Subsection",ExpressionUUID->"64c11c14-d401-463f-9793-f84ac0042148"],
Cell[3277, 95, 3056, 50, 58, "Input",ExpressionUUID->"d992478e-1c3f-48e4-bc2a-1f285f42d693"],
Cell[6336, 147, 653, 14, 40, "Input",ExpressionUUID->"e0713fa5-aa51-402a-b538-9b5d9b5ca3a6"],
Cell[6992, 163, 657, 14, 36, "Input",ExpressionUUID->"e07de534-dd0f-44ec-b0ab-019d9c1912cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[7686, 182, 165, 3, 41, "Subsection",ExpressionUUID->"3081652f-efb1-4eb3-9f44-c77a82303748"],
Cell[7854, 187, 655, 17, 58, "Input",ExpressionUUID->"50635cf1-5eed-4db2-a6e9-dcd43bcd5403"],
Cell[8512, 206, 1383, 24, 58, "Input",ExpressionUUID->"524d4316-b055-4ea1-9bfb-3e446c1cf16d"]
}, Closed]],
Cell[CellGroupData[{
Cell[9932, 235, 161, 3, 41, "Subsection",ExpressionUUID->"ac2a5e42-29f3-4fda-a6dc-0d845d643d59"],
Cell[10096, 240, 224, 4, 32, "Input",ExpressionUUID->"e177e86e-cffb-4e0a-8a46-aa9696cfb496"],
Cell[10323, 246, 1168, 27, 77, "Input",ExpressionUUID->"6e9c2c40-c3ea-43e9-9d43-a51067dfeb27"],
Cell[11494, 275, 1149, 27, 99, "Input",ExpressionUUID->"64a1a5e9-752f-49f2-be56-36f50a4404c2"],
Cell[12646, 304, 294, 7, 32, "Input",ExpressionUUID->"466d3477-5b10-4269-9bf8-dbe8d772aed4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12989, 317, 213, 4, 73, "Section",ExpressionUUID->"b61ff97e-a339-49e3-a1bf-8f4a9f59064c"],
Cell[13205, 323, 2864, 54, 99, "Input",ExpressionUUID->"66d54f96-ac88-4159-843e-4f556d07d83e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16106, 382, 165, 3, 73, "Section",ExpressionUUID->"800166f9-05e9-40c8-b297-70a7b0f05a21"],
Cell[16274, 387, 4169, 105, 567, "Input",ExpressionUUID->"dc10e58b-e363-4cb7-bfd6-da6eb1e741a8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20492, 498, 171, 3, 70, "Subchapter",ExpressionUUID->"9188639b-24dd-49cc-9d83-b6a6070e5c7e"],
Cell[CellGroupData[{
Cell[20688, 505, 216, 4, 73, "Section",ExpressionUUID->"a68ad916-9391-410d-89fb-e823d54a28af"],
Cell[CellGroupData[{
Cell[20929, 513, 203, 4, 59, "Subsection",ExpressionUUID->"981e618d-ff48-488c-af54-3a0c1f240aea"],
Cell[21135, 519, 1563, 39, 160, "Input",ExpressionUUID->"307675f2-b028-4929-8194-274494a6fd59"],
Cell[22701, 560, 652, 13, 60, "Input",ExpressionUUID->"e5559b00-3578-4181-a88c-4d447bdcca24"],
Cell[23356, 575, 796, 17, 52, "Input",ExpressionUUID->"26bbf6eb-4f1a-4a23-8f35-6e2c3ca1fc43"]
}, Closed]],
Cell[CellGroupData[{
Cell[24189, 597, 163, 3, 41, "Subsection",ExpressionUUID->"ff50c7a6-03eb-4585-a309-e5b21ae11fa9"],
Cell[24355, 602, 521, 13, 20, "Input",ExpressionUUID->"0a93fde2-cb3e-44a8-b95c-b840af4ead51"],
Cell[24879, 617, 421, 12, 33, "Input",ExpressionUUID->"b3ac04cd-2e39-450f-8756-92730083c65d"],
Cell[25303, 631, 187, 4, 20, "Input",ExpressionUUID->"9784e289-bb2e-4e84-b2fb-502f2ec92d96"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25539, 641, 157, 3, 73, "Section",ExpressionUUID->"e32d35da-2a60-4a57-8745-09bf1c28a55e"],
Cell[25699, 646, 216, 5, 32, "Input",ExpressionUUID->"430a5860-49db-44ff-8d6c-5a04a6aebbca"],
Cell[25918, 653, 522, 12, 32, "Input",ExpressionUUID->"d5868928-748c-402a-891a-81935bc26740"],
Cell[26443, 667, 1316, 29, 129, "Input",ExpressionUUID->"540e7faf-403a-424b-b24c-d992375f8876"],
Cell[27762, 698, 156, 3, 32, "Input",ExpressionUUID->"a4662d84-82e4-43fd-ab40-b1fc7329c1bc"],
Cell[27921, 703, 523, 11, 32, "Input",ExpressionUUID->"cb108089-54c0-4211-b629-1bfbd14338b1"],
Cell[28447, 716, 964, 20, 55, "Input",ExpressionUUID->"d7141dc0-1684-48bf-8496-649835580620"],
Cell[29414, 738, 1357, 31, 200, "Input",ExpressionUUID->"7076475d-2577-427b-b680-6bbc1325b7ec"],
Cell[30774, 771, 759, 15, 55, "Input",ExpressionUUID->"db9ba457-1d77-4302-8910-c1b61abad8e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31570, 791, 159, 3, 73, "Section",ExpressionUUID->"5c33b0da-c168-41ef-9b9f-6fadbd222df2"],
Cell[31732, 796, 302, 7, 20, "Input",ExpressionUUID->"94bba4a2-78a6-48db-be29-2ed1c6dbaa78"],
Cell[32037, 805, 302, 7, 20, "Input",ExpressionUUID->"0e50b9f5-ebf0-41eb-bb49-2f52756b9fbb"],
Cell[32342, 814, 222, 5, 20, "Input",ExpressionUUID->"fe4d8ebc-200a-4a36-ac3f-d371686d4569"],
Cell[32567, 821, 269, 7, 20, "Input",ExpressionUUID->"93ae262f-9380-431b-a641-21e26e2de961"],
Cell[32839, 830, 536, 14, 40, "Input",ExpressionUUID->"76ef5e78-3b0c-4f99-b762-594251ca1cac"],
Cell[33378, 846, 304, 8, 20, "Input",ExpressionUUID->"3b146a70-6f55-4fc9-a431-bfd9c847de35"],
Cell[33685, 856, 317, 9, 20, "Input",ExpressionUUID->"9c765b69-c9be-4c64-a812-a68f73fcbd36"],
Cell[34005, 867, 1829, 49, 162, "Input",ExpressionUUID->"ca0a9703-89ca-47bd-9a0c-e0676a4f01d2"],
Cell[35837, 918, 352, 8, 20, "Input",ExpressionUUID->"f03672bf-518f-4350-88f6-949a9297df72"],
Cell[36192, 928, 350, 8, 20, "Input",ExpressionUUID->"9f4dc3fe-95e7-424f-b885-2cd38a100c3b"],
Cell[36545, 938, 272, 6, 20, "Input",ExpressionUUID->"51a5b656-849d-4cf1-9ea2-8eb9dc361642"],
Cell[36820, 946, 323, 8, 20, "Input",ExpressionUUID->"d0315421-3054-4266-a90f-f8e1aff82d15"],
Cell[37146, 956, 593, 15, 40, "Input",ExpressionUUID->"4a0d0a79-a25a-4f48-bf04-52fa7f5da334"],
Cell[37742, 973, 360, 9, 20, "Input",ExpressionUUID->"d175312b-7058-4313-abc0-bb4bee2dbfa6"],
Cell[38105, 984, 370, 10, 20, "Input",ExpressionUUID->"0b264721-bb42-458a-806e-a5d3ba6f99af"],
Cell[38478, 996, 1879, 49, 162, "Input",ExpressionUUID->"4a62c023-1d11-4f6f-a7a5-09e38cd2cd45"],
Cell[40360, 1047, 501, 10, 20, "Input",ExpressionUUID->"64a3db8b-86c3-47f9-b33a-651bab4a2682"],
Cell[40864, 1059, 640, 14, 40, "Input",ExpressionUUID->"fbf01093-dcd6-4f28-b2e0-6be358220843"],
Cell[41507, 1075, 1306, 30, 155, "Input",ExpressionUUID->"3bd54a76-a380-444d-8991-9478d5e36c8b"],
Cell[42816, 1107, 547, 11, 20, "Input",ExpressionUUID->"dc78d7bb-6980-451d-8eea-61b92909c500"]
}, Closed]],
Cell[CellGroupData[{
Cell[43400, 1123, 158, 3, 57, "Section",ExpressionUUID->"dc4536a2-498b-4d29-a2ab-9099b15407c0"],
Cell[43561, 1128, 254, 6, 29, "Input",ExpressionUUID->"bf3fb03a-9afa-43b5-bf4b-55530f307a44"],
Cell[43818, 1136, 1584, 37, 73, "Input",ExpressionUUID->"33b46885-3b62-4983-a852-f6cb49556f82"],
Cell[45405, 1175, 616, 16, 29, "Input",ExpressionUUID->"e993c4f1-19dd-42a8-b320-c628f655b278"],
Cell[46024, 1193, 241, 6, 29, "Input",ExpressionUUID->"98eabace-7342-4dba-ad98-02cdf2934139"],
Cell[46268, 1201, 1329, 33, 94, "Input",ExpressionUUID->"ecba87d9-3846-40b9-bb9d-93511ce26567"],
Cell[47600, 1236, 460, 11, 29, "Input",ExpressionUUID->"f1187a7b-2d95-401b-93b1-702b9a6fb4e7"],
Cell[48063, 1249, 9385, 220, 1240, "Input",ExpressionUUID->"dba6a5f3-ddca-4081-b8d9-886d24418fe2"],
Cell[57451, 1471, 222, 4, 29, "Input",ExpressionUUID->"388589fb-0247-4ff3-a60e-b77ae2888403"],
Cell[57676, 1477, 782, 22, 82, "Input",ExpressionUUID->"b76e8021-bdf6-4d3e-a110-aa9cd8ace617"],
Cell[58461, 1501, 317, 7, 29, "Input",ExpressionUUID->"33d6460c-4554-43ae-9aaf-677306bc5112"]
}, Closed]],
Cell[CellGroupData[{
Cell[58815, 1513, 165, 3, 57, "Section",ExpressionUUID->"9a4c4e5f-947c-4660-8317-3d8015312ce4"],
Cell[CellGroupData[{
Cell[59005, 1520, 165, 3, 59, "Subsection",ExpressionUUID->"2d3804c0-2d68-4a41-a864-7f70484a3a53"],
Cell[59173, 1525, 1383, 32, 55, "Input",ExpressionUUID->"547fe574-481f-46a3-8426-649c4df5c963"],
Cell[60559, 1559, 1950, 44, 55, "Input",ExpressionUUID->"a57da058-d469-4ed5-8393-08d947945fd0"],
Cell[62512, 1605, 10886, 237, 885, "Input",ExpressionUUID->"898700b6-8023-495f-9747-af08a5aa3dbc"],
Cell[73401, 1844, 1497, 32, 77, "Input",ExpressionUUID->"40c036d7-643a-4658-b0b8-e9c33f2736d3"],
Cell[74901, 1878, 563, 18, 32, "Input",ExpressionUUID->"af749cc2-0dad-4302-a31a-afb3a5b353ee"],
Cell[75467, 1898, 890, 22, 32, "Input",ExpressionUUID->"c4410617-7cb4-4944-9da8-605f6e225711"],
Cell[76360, 1922, 1958, 47, 79, "Input",ExpressionUUID->"81b1ab8e-ca75-40dc-b8b3-ad5001b677e0"],
Cell[CellGroupData[{
Cell[78343, 1973, 154, 3, 32, "Input",ExpressionUUID->"5277429b-daaa-45c5-8209-7b407d675eca"],
Cell[78500, 1978, 241, 6, 23, "Message",ExpressionUUID->"295cc952-43e1-404f-8eef-2a74523b714a"],
Cell[78744, 1986, 745, 14, 23, "Message",ExpressionUUID->"e73bba26-0402-4728-bda9-12870bef00c3"],
Cell[79492, 2002, 400, 9, 23, "Message",ExpressionUUID->"4082fdef-a85d-4f9e-9845-5100381406d2"]
}, Open  ]],
Cell[79907, 2014, 668, 18, 77, "Input",ExpressionUUID->"a9b88362-133a-4139-ba3e-d2812291116d"],
Cell[80578, 2034, 357, 10, 32, "Input",ExpressionUUID->"cfd2d15f-9cfd-4f1c-b421-39ba8efcbbe1"],
Cell[80938, 2046, 969, 20, 55, "Input",ExpressionUUID->"4bdabbe9-a0be-4e14-875c-116689ee0f9d"],
Cell[81910, 2068, 266, 6, 32, "Input",ExpressionUUID->"4e3c977d-5198-4e61-a341-85477a09c418"],
Cell[82179, 2076, 235, 5, 32, "Input",ExpressionUUID->"798e1c2f-e1f0-46c9-b786-841737095535"],
Cell[82417, 2083, 180, 4, 32, "Input",ExpressionUUID->"f28379b9-dc23-401a-a980-de6184f8b3bb"],
Cell[82600, 2089, 157, 2, 32, "Input",ExpressionUUID->"529630d3-282e-43ef-8203-a05d86b5dccc"],
Cell[82760, 2093, 162, 3, 32, "Input",ExpressionUUID->"004e3d7f-d104-4cc5-bf3e-77655896bdfd"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[82983, 2103, 192, 3, 52, "Subchapter",ExpressionUUID->"6d03133b-bf81-42b2-890e-2d5e8bf91c47"],
Cell[83178, 2108, 1760, 39, 254, "Input",ExpressionUUID->"6bcb3a87-a4d8-491d-81d3-13c28e583444"],
Cell[CellGroupData[{
Cell[84963, 2151, 163, 3, 73, "Section",ExpressionUUID->"e7ac6a9f-fc94-42c6-9619-22afb243d0f8"],
Cell[CellGroupData[{
Cell[85151, 2158, 231, 4, 59, "Subsection",ExpressionUUID->"4c39ef99-d04f-44e4-a491-a371020191ff"],
Cell[85385, 2164, 229, 5, 32, "Input",ExpressionUUID->"e0a69240-5a08-45bd-bedc-180fb8cc131e"],
Cell[85617, 2171, 5648, 143, 379, "Input",ExpressionUUID->"b262ca85-2462-40cc-bf88-bd81c1418578"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91302, 2319, 290, 8, 59, "Subsection",ExpressionUUID->"344933ac-3cb5-44c9-b2c4-66ba4b0776d2"],
Cell[91595, 2329, 229, 5, 32, "Input",ExpressionUUID->"e8f471a9-9aab-4657-b213-6ba03086dd7e"],
Cell[91827, 2336, 8779, 216, 621, "Input",ExpressionUUID->"db56b1d7-0ba3-450b-ae48-d71a5f870885"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100643, 2557, 182, 3, 59, "Subsection",ExpressionUUID->"83f0d082-7828-45ac-b877-272c70d14b4f"],
Cell[100828, 2562, 677, 16, 77, "Input",ExpressionUUID->"36a3ec86-f7b0-4573-bd72-69ce6d9fc779"],
Cell[101508, 2580, 4671, 92, 536, "Input",ExpressionUUID->"78483983-9ec0-4e2a-b0d6-639799b07a1c"],
Cell[CellGroupData[{
Cell[106204, 2676, 231, 5, 32, "Input",ExpressionUUID->"f07f2242-acf3-4baf-a0c6-e724d9b0d745"],
Cell[106438, 2683, 389, 7, 36, "Output",ExpressionUUID->"423fd1ca-2f5d-4be5-a332-043601845b35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106864, 2695, 156, 3, 32, "Input",ExpressionUUID->"cf6821f5-caec-4520-9f49-a08583581083"],
Cell[107023, 2700, 159, 3, 36, "Output",ExpressionUUID->"0271b3ee-6be6-4115-90a4-4886d92b487f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107219, 2708, 157, 3, 32, "Input",ExpressionUUID->"b7e32766-1a5b-497d-a5bf-2bbd36cc3369"],
Cell[107379, 2713, 242, 5, 36, "Output",ExpressionUUID->"2d14cbef-71c9-40a8-bb86-e3d2741740ef"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[107670, 2724, 229, 4, 59, "Subsection",ExpressionUUID->"c76dc307-2885-4be0-9f97-718d728c9029"],
Cell[107902, 2730, 28067, 665, 2115, "Input",ExpressionUUID->"fd9d9166-761a-435a-b603-9e61f24a1d4a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[136018, 3401, 161, 3, 73, "Section",ExpressionUUID->"bac05df7-f4cf-4f8b-923c-62e0d3dd60e3"],
Cell[136182, 3406, 15353, 320, 1543, "Input",ExpressionUUID->"0c1379b2-c4a2-42ef-8c52-ee42654a3a0c"],
Cell[CellGroupData[{
Cell[151560, 3730, 156, 3, 32, "Input",ExpressionUUID->"32123421-1876-460f-b4be-2f0c045ec8ce"],
Cell[151719, 3735, 2120, 41, 147, "Output",ExpressionUUID->"6e9c243f-2530-471e-a26a-4d901e82871d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153888, 3782, 157, 3, 73, "Section",ExpressionUUID->"0779f07c-fff2-4c82-b461-860f98d52391"],
Cell[154048, 3787, 5497, 136, 808, "Input",ExpressionUUID->"a4534700-5e42-496e-8a28-b9202be502d7"],
Cell[159548, 3925, 298, 9, 32, "Input",ExpressionUUID->"8bfb3bca-0ab1-4d7e-9433-ec0c92f8f717"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

